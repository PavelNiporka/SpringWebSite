!function(a,b,c,d){function e(b,c){this.settings=null,this.options=a.extend({},e.Defaults,c),this.$element=a(b),this.drag=a.extend({},m),this.state=a.extend({},n),this.e=a.extend({},o),this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._invalidated={},this._pipe=[],a.each(e.Plugins,a.proxy(function(a,b){this._plugins[a[0].toLowerCase()+a.slice(1)]=new b(this)},this)),a.each(e.Pipe,a.proxy(function(b,c){this._pipe.push({filter:c.filter,run:a.proxy(c.run,this)})},this)),this.setup(),this.initialize()}function f(a){if(a.touches!==d)return{x:a.touches[0].pageX,y:a.touches[0].pageY};if(a.touches===d){if(a.pageX!==d)return{x:a.pageX,y:a.pageY};if(a.pageX===d)return{x:a.clientX,y:a.clientY}}}function g(a){var b,d,e=c.createElement("div"),f=a;for(b in f)if(d=f[b],"undefined"!=typeof e.style[d])return e=null,[d,b];return[!1]}function h(){return g(["transition","WebkitTransition","MozTransition","OTransition"])[1]}function i(){return g(["transform","WebkitTransform","MozTransform","OTransform","msTransform"])[0]}function j(){return g(["perspective","webkitPerspective","MozPerspective","OPerspective","MsPerspective"])[0]}function k(){return"ontouchstart"in b||!!navigator.msMaxTouchPoints}function l(){return b.navigator.msPointerEnabled}var m,n,o;m={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,offsetX:0,offsetY:0,distance:null,startTime:0,endTime:0,updatedX:0,targetEl:null},n={isTouch:!1,isScrolling:!1,isSwiping:!1,direction:!1,inMotion:!1},o={_onDragStart:null,_onDragMove:null,_onDragEnd:null,_transitionEnd:null,_resizer:null,_responsiveCall:null,_goToLoop:null,_checkVisibile:null},e.Defaults={items:3,loop:!1,center:!1,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:b,responsiveClass:!1,fallbackEasing:"swing",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",themeClass:"owl-theme",baseClass:"owl-carousel",itemClass:"owl-item",centerClass:"center",activeClass:"active"},e.Width={Default:"default",Inner:"inner",Outer:"outer"},e.Plugins={},e.Pipe=[{filter:["width","items","settings"],run:function(a){a.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){var a=this._clones,b=this.$stage.children(".cloned");(b.length!==a.length||!this.settings.loop&&a.length>0)&&(this.$stage.children(".cloned").remove(),this._clones=[])}},{filter:["items","settings"],run:function(){var a,b,c=this._clones,d=this._items,e=this.settings.loop?c.length-Math.max(2*this.settings.items,4):0;for(a=0,b=Math.abs(e/2);b>a;a++)e>0?(this.$stage.children().eq(d.length+c.length-1).remove(),c.pop(),this.$stage.children().eq(0).remove(),c.pop()):(c.push(c.length/2),this.$stage.append(d[c[c.length-1]].clone().addClass("cloned")),c.push(d.length-1-(c.length-1)/2),this.$stage.prepend(d[c[c.length-1]].clone().addClass("cloned")))}},{filter:["width","items","settings"],run:function(){var a,b,c,d=this.settings.rtl?1:-1,e=(this.width()/this.settings.items).toFixed(3),f=0;for(this._coordinates=[],b=0,c=this._clones.length+this._items.length;c>b;b++)a=this._mergers[this.relative(b)],a=this.settings.mergeFit&&Math.min(a,this.settings.items)||a,f+=(this.settings.autoWidth?this._items[this.relative(b)].width()+this.settings.margin:e*a)*d,this._coordinates.push(f)}},{filter:["width","items","settings"],run:function(){var b,c,d=(this.width()/this.settings.items).toFixed(3),e={width:Math.abs(this._coordinates[this._coordinates.length-1])+2*this.settings.stagePadding,"padding-left":this.settings.stagePadding||"","padding-right":this.settings.stagePadding||""};if(this.$stage.css(e),e={width:this.settings.autoWidth?"auto":d-this.settings.margin},e[this.settings.rtl?"margin-left":"margin-right"]=this.settings.margin,!this.settings.autoWidth&&a.grep(this._mergers,function(a){return a>1}).length>0)for(b=0,c=this._coordinates.length;c>b;b++)e.width=Math.abs(this._coordinates[b])-Math.abs(this._coordinates[b-1]||0)-this.settings.margin,this.$stage.children().eq(b).css(e);else this.$stage.children().css(e)}},{filter:["width","items","settings"],run:function(a){a.current&&this.reset(this.$stage.children().index(a.current))}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var a,b,c,d,e=this.settings.rtl?1:-1,f=2*this.settings.stagePadding,g=this.coordinates(this.current())+f,h=g+this.width()*e,i=[];for(c=0,d=this._coordinates.length;d>c;c++)a=this._coordinates[c-1]||0,b=Math.abs(this._coordinates[c])+f*e,(this.op(a,"<=",g)&&this.op(a,">",h)||this.op(b,"<",g)&&this.op(b,">",h))&&i.push(c);this.$stage.children("."+this.settings.activeClass).removeClass(this.settings.activeClass),this.$stage.children(":eq("+i.join("), :eq(")+")").addClass(this.settings.activeClass),this.settings.center&&(this.$stage.children("."+this.settings.centerClass).removeClass(this.settings.centerClass),this.$stage.children().eq(this.current()).addClass(this.settings.centerClass))}}],e.prototype.initialize=function(){if(this.trigger("initialize"),this.$element.addClass(this.settings.baseClass).addClass(this.settings.themeClass).toggleClass("owl-rtl",this.settings.rtl),this.browserSupport(),this.settings.autoWidth&&this.state.imagesLoaded!==!0){var b,c,e;if(b=this.$element.find("img"),c=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:d,e=this.$element.children(c).width(),b.length&&0>=e)return this.preloadAutoWidthImages(b),!1}this.$element.addClass("owl-loading"),this.$stage=a("<"+this.settings.stageElement+' class="owl-stage"/>').wrap('<div class="owl-stage-outer">'),this.$element.append(this.$stage.parent()),this.replace(this.$element.children().not(this.$stage.parent())),this._width=this.$element.width(),this.refresh(),this.$element.removeClass("owl-loading").addClass("owl-loaded"),this.eventsCall(),this.internalEvents(),this.addTriggerableEvents(),this.trigger("initialized")},e.prototype.setup=function(){var b=this.viewport(),c=this.options.responsive,d=-1,e=null;c?(a.each(c,function(a){b>=a&&a>d&&(d=Number(a))}),e=a.extend({},this.options,c[d]),delete e.responsive,e.responsiveClass&&this.$element.attr("class",function(a,b){return b.replace(/\b owl-responsive-\S+/g,"")}).addClass("owl-responsive-"+d)):e=a.extend({},this.options),(null===this.settings||this._breakpoint!==d)&&(this.trigger("change",{property:{name:"settings",value:e}}),this._breakpoint=d,this.settings=e,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}}))},e.prototype.optionsLogic=function(){this.$element.toggleClass("owl-center",this.settings.center),this.settings.loop&&this._items.length<this.settings.items&&(this.settings.loop=!1),this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},e.prototype.prepare=function(b){var c=this.trigger("prepare",{content:b});return c.data||(c.data=a("<"+this.settings.itemElement+"/>").addClass(this.settings.itemClass).append(b)),this.trigger("prepared",{content:c.data}),c.data},e.prototype.update=function(){for(var b=0,c=this._pipe.length,d=a.proxy(function(a){return this[a]},this._invalidated),e={};c>b;)(this._invalidated.all||a.grep(this._pipe[b].filter,d).length>0)&&this._pipe[b].run(e),b++;this._invalidated={}},e.prototype.width=function(a){switch(a=a||e.Width.Default){case e.Width.Inner:case e.Width.Outer:return this._width;default:return this._width-2*this.settings.stagePadding+this.settings.margin}},e.prototype.refresh=function(){if(0===this._items.length)return!1;(new Date).getTime();this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$stage.addClass("owl-refresh"),this.update(),this.$stage.removeClass("owl-refresh"),this.state.orientation=b.orientation,this.watchVisibility(),this.trigger("refreshed")},e.prototype.eventsCall=function(){this.e._onDragStart=a.proxy(function(a){this.onDragStart(a)},this),this.e._onDragMove=a.proxy(function(a){this.onDragMove(a)},this),this.e._onDragEnd=a.proxy(function(a){this.onDragEnd(a)},this),this.e._onResize=a.proxy(function(a){this.onResize(a)},this),this.e._transitionEnd=a.proxy(function(a){this.transitionEnd(a)},this),this.e._preventClick=a.proxy(function(a){this.preventClick(a)},this)},e.prototype.onThrottledResize=function(){/*b.clearTimeout(this.resizeTimer),this.resizeTimer=b.setTimeout(this.e._onResize,this.settings.responsiveRefreshRate)*/},e.prototype.onResize=function(){return this._items.length?this._width===this.$element.width()?!1:this.trigger("resize").isDefaultPrevented()?!1:(this._width=this.$element.width(),this.invalidate("width"),this.refresh(),void this.trigger("resized")):!1},e.prototype.eventsRouter=function(a){var b=a.type;"mousedown"===b||"touchstart"===b?this.onDragStart(a):"mousemove"===b||"touchmove"===b?this.onDragMove(a):"mouseup"===b||"touchend"===b?this.onDragEnd(a):"touchcancel"===b&&this.onDragEnd(a)},e.prototype.internalEvents=function(){var c=(k(),l());this.settings.mouseDrag?(this.$stage.on("mousedown",a.proxy(function(a){this.eventsRouter(a)},this)),this.$stage.on("dragstart",function(){return!1}),this.$stage.get(0).onselectstart=function(){return!1}):this.$element.addClass("owl-text-select-on"),this.settings.touchDrag&&!c&&this.$stage.on("touchstart touchcancel",a.proxy(function(a){this.eventsRouter(a)},this)),this.transitionEndVendor&&this.on(this.$stage.get(0),this.transitionEndVendor,this.e._transitionEnd,!1),this.settings.responsive!==!1&&this.on(b,"resize",a.proxy(this.onThrottledResize,this))},e.prototype.onDragStart=function(d){var e,g,h,i;if(e=d.originalEvent||d||b.event,3===e.which||this.state.isTouch)return!1;if("mousedown"===e.type&&this.$stage.addClass("owl-grab"),this.trigger("drag"),this.drag.startTime=(new Date).getTime(),this.speed(0),this.state.isTouch=!0,this.state.isScrolling=!1,this.state.isSwiping=!1,this.drag.distance=0,g=f(e).x,h=f(e).y,this.drag.offsetX=this.$stage.position().left,this.drag.offsetY=this.$stage.position().top,this.settings.rtl&&(this.drag.offsetX=this.$stage.position().left+this.$stage.width()-this.width()+this.settings.margin),this.state.inMotion&&this.support3d)i=this.getTransformProperty(),this.drag.offsetX=i,this.animate(i),this.state.inMotion=!0;else if(this.state.inMotion&&!this.support3d)return this.state.inMotion=!1,!1;this.drag.startX=g-this.drag.offsetX,this.drag.startY=h-this.drag.offsetY,this.drag.start=g-this.drag.startX,this.drag.targetEl=e.target||e.srcElement,this.drag.updatedX=this.drag.start,("IMG"===this.drag.targetEl.tagName||"A"===this.drag.targetEl.tagName)&&(this.drag.targetEl.draggable=!1),a(c).on("mousemove.owl.dragEvents mouseup.owl.dragEvents touchmove.owl.dragEvents touchend.owl.dragEvents",a.proxy(function(a){this.eventsRouter(a)},this))},e.prototype.onDragMove=function(a){var c,e,g,h,i,j;this.state.isTouch&&(this.state.isScrolling||(c=a.originalEvent||a||b.event,e=f(c).x,g=f(c).y,this.drag.currentX=e-this.drag.startX,this.drag.currentY=g-this.drag.startY,this.drag.distance=this.drag.currentX-this.drag.offsetX,this.drag.distance<0?this.state.direction=this.settings.rtl?"right":"left":this.drag.distance>0&&(this.state.direction=this.settings.rtl?"left":"right"),this.settings.loop?this.op(this.drag.currentX,">",this.coordinates(this.minimum()))&&"right"===this.state.direction?this.drag.currentX-=(this.settings.center&&this.coordinates(0))-this.coordinates(this._items.length):this.op(this.drag.currentX,"<",this.coordinates(this.maximum()))&&"left"===this.state.direction&&(this.drag.currentX+=(this.settings.center&&this.coordinates(0))-this.coordinates(this._items.length)):(h=this.coordinates(this.settings.rtl?this.maximum():this.minimum()),i=this.coordinates(this.settings.rtl?this.minimum():this.maximum()),j=this.settings.pullDrag?this.drag.distance/5:0,this.drag.currentX=Math.max(Math.min(this.drag.currentX,h+j),i+j)),(this.drag.distance>8||this.drag.distance<-8)&&(c.preventDefault!==d?c.preventDefault():c.returnValue=!1,this.state.isSwiping=!0),this.drag.updatedX=this.drag.currentX,(this.drag.currentY>16||this.drag.currentY<-16)&&this.state.isSwiping===!1&&(this.state.isScrolling=!0,this.drag.updatedX=this.drag.start),this.animate(this.drag.updatedX)))},e.prototype.onDragEnd=function(b){var d,e,f;if(this.state.isTouch){if("mouseup"===b.type&&this.$stage.removeClass("owl-grab"),this.trigger("dragged"),this.drag.targetEl.removeAttribute("draggable"),this.state.isTouch=!1,this.state.isScrolling=!1,this.state.isSwiping=!1,0===this.drag.distance&&this.state.inMotion!==!0)return this.state.inMotion=!1,!1;this.drag.endTime=(new Date).getTime(),d=this.drag.endTime-this.drag.startTime,e=Math.abs(this.drag.distance),(e>3||d>300)&&this.removeClick(this.drag.targetEl),f=this.closest(this.drag.updatedX),this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(f),this.invalidate("position"),this.update(),this.settings.pullDrag||this.drag.updatedX!==this.coordinates(f)||this.transitionEnd(),this.drag.distance=0,a(c).off(".owl.dragEvents")}},e.prototype.removeClick=function(c){this.drag.targetEl=c,a(c).on("click.preventClick",this.e._preventClick),b.setTimeout(function(){a(c).off("click.preventClick")},300)},e.prototype.preventClick=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation&&b.stopPropagation(),a(b.target).off("click.preventClick")},e.prototype.getTransformProperty=function(){var a,c;return a=b.getComputedStyle(this.$stage.get(0),null).getPropertyValue(this.vendorName+"transform"),a=a.replace(/matrix(3d)?\(|\)/g,"").split(","),c=16===a.length,c!==!0?a[4]:a[12]},e.prototype.closest=function(b){var c=-1,d=30,e=this.width(),f=this.coordinates();return this.settings.freeDrag||a.each(f,a.proxy(function(a,g){return b>g-d&&g+d>b?c=a:this.op(b,"<",g)&&this.op(b,">",f[a+1]||g-e)&&(c="left"===this.state.direction?a+1:a),-1===c},this)),this.settings.loop||(this.op(b,">",f[this.minimum()])?c=b=this.minimum():this.op(b,"<",f[this.maximum()])&&(c=b=this.maximum())),c},e.prototype.animate=function(b){this.trigger("translate"),this.state.inMotion=this.speed()>0,this.support3d?this.$stage.css({transform:"translate3d("+b+"px,0px, 0px)",transition:this.speed()/1e3+"s"}):this.state.isTouch?this.$stage.css({left:b+"px"}):this.$stage.animate({left:b},this.speed()/1e3,this.settings.fallbackEasing,a.proxy(function(){this.state.inMotion&&this.transitionEnd()},this))},e.prototype.current=function(a){if(a===d)return this._current;if(0===this._items.length)return d;if(a=this.normalize(a),this._current!==a){var b=this.trigger("change",{property:{name:"position",value:a}});b.data!==d&&(a=this.normalize(b.data)),this._current=a,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current},e.prototype.invalidate=function(a){this._invalidated[a]=!0},e.prototype.reset=function(a){a=this.normalize(a),a!==d&&(this._speed=0,this._current=a,this.suppress(["translate","translated"]),this.animate(this.coordinates(a)),this.release(["translate","translated"]))},e.prototype.normalize=function(b,c){var e=c?this._items.length:this._items.length+this._clones.length;return!a.isNumeric(b)||1>e?d:b=this._clones.length?(b%e+e)%e:Math.max(this.minimum(c),Math.min(this.maximum(c),b))},e.prototype.relative=function(a){return a=this.normalize(a),a-=this._clones.length/2,this.normalize(a,!0)},e.prototype.maximum=function(a){var b,c,d,e=0,f=this.settings;if(a)return this._items.length-1;if(!f.loop&&f.center)b=this._items.length-1;else if(f.loop||f.center)if(f.loop||f.center)b=this._items.length+f.items;else{if(!f.autoWidth&&!f.merge)throw"Can not detect maximum absolute position.";for(revert=f.rtl?1:-1,c=this.$stage.width()-this.$element.width();(d=this.coordinates(e))&&!(d*revert>=c);)b=++e}else b=this._items.length-f.items;return b},e.prototype.minimum=function(a){return a?0:this._clones.length/2},e.prototype.items=function(a){return a===d?this._items.slice():(a=this.normalize(a,!0),this._items[a])},e.prototype.mergers=function(a){return a===d?this._mergers.slice():(a=this.normalize(a,!0),this._mergers[a])},e.prototype.clones=function(b){var c=this._clones.length/2,e=c+this._items.length,f=function(a){return a%2===0?e+a/2:c-(a+1)/2};return b===d?a.map(this._clones,function(a,b){return f(b)}):a.map(this._clones,function(a,c){return a===b?f(c):null})},e.prototype.speed=function(a){return a!==d&&(this._speed=a),this._speed},e.prototype.coordinates=function(b){var c=null;return b===d?a.map(this._coordinates,a.proxy(function(a,b){return this.coordinates(b)},this)):(this.settings.center?(c=this._coordinates[b],c+=(this.width()-c+(this._coordinates[b-1]||0))/2*(this.settings.rtl?-1:1)):c=this._coordinates[b-1]||0,c)},e.prototype.duration=function(a,b,c){return Math.min(Math.max(Math.abs(b-a),1),6)*Math.abs(c||this.settings.smartSpeed)},e.prototype.to=function(c,d){if(this.settings.loop){var e=c-this.relative(this.current()),f=this.current(),g=this.current(),h=this.current()+e,i=0>g-h?!0:!1,j=this._clones.length+this._items.length;h<this.settings.items&&i===!1?(f=g+this._items.length,this.reset(f)):h>=j-this.settings.items&&i===!0&&(f=g-this._items.length,this.reset(f)),b.clearTimeout(this.e._goToLoop),this.e._goToLoop=b.setTimeout(a.proxy(function(){this.speed(this.duration(this.current(),f+e,d)),this.current(f+e),this.update()},this),30)}else this.speed(this.duration(this.current(),c,d)),this.current(c),this.update()},e.prototype.next=function(a){a=a||!1,this.to(this.relative(this.current())+1,a)},e.prototype.prev=function(a){a=a||!1,this.to(this.relative(this.current())-1,a)},e.prototype.transitionEnd=function(a){return a!==d&&(a.stopPropagation(),(a.target||a.srcElement||a.originalTarget)!==this.$stage.get(0))?!1:(this.state.inMotion=!1,void this.trigger("translated"))},e.prototype.viewport=function(){var d;if(this.options.responsiveBaseElement!==b)d=a(this.options.responsiveBaseElement).width();else if(b.innerWidth)d=b.innerWidth;else{if(!c.documentElement||!c.documentElement.clientWidth)throw"Can not detect viewport width.";d=c.documentElement.clientWidth}return d},e.prototype.replace=function(b){this.$stage.empty(),this._items=[],b&&(b=b instanceof jQuery?b:a(b)),this.settings.nestedItemSelector&&(b=b.find("."+this.settings.nestedItemSelector)),b.filter(function(){return 1===this.nodeType}).each(a.proxy(function(a,b){b=this.prepare(b),this.$stage.append(b),this._items.push(b),this._mergers.push(1*b.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)},this)),this.reset(a.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},e.prototype.add=function(a,b){b=b===d?this._items.length:this.normalize(b,!0),this.trigger("add",{content:a,position:b}),0===this._items.length||b===this._items.length?(this.$stage.append(a),this._items.push(a),this._mergers.push(1*a.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)):(this._items[b].before(a),this._items.splice(b,0,a),this._mergers.splice(b,0,1*a.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)),this.invalidate("items"),this.trigger("added",{content:a,position:b})},e.prototype.remove=function(a){a=this.normalize(a,!0),a!==d&&(this.trigger("remove",{content:this._items[a],position:a}),this._items[a].remove(),this._items.splice(a,1),this._mergers.splice(a,1),this.invalidate("items"),this.trigger("removed",{content:null,position:a}))},e.prototype.addTriggerableEvents=function(){var b=a.proxy(function(b,c){return a.proxy(function(a){a.relatedTarget!==this&&(this.suppress([c]),b.apply(this,[].slice.call(arguments,1)),this.release([c]))},this)},this);a.each({next:this.next,prev:this.prev,to:this.to,destroy:this.destroy,refresh:this.refresh,replace:this.replace,add:this.add,remove:this.remove},a.proxy(function(a,c){this.$element.on(a+".owl.carousel",b(c,a+".owl.carousel"))},this))},e.prototype.watchVisibility=function(){function c(a){return a.offsetWidth>0&&a.offsetHeight>0}function d(){c(this.$element.get(0))&&(this.$element.removeClass("owl-hidden"),this.refresh(),b.clearInterval(/*this.e._checkVisibile*/))}c(this.$element.get(0))||(this.$element.addClass("owl-hidden"),b.clearInterval(this.e._checkVisibile),this.e._checkVisibile=b.setInterval(a.proxy(d,this),500))},e.prototype.preloadAutoWidthImages=function(b){var c,d,e,f;c=0,d=this,b.each(function(g,h){e=a(h),f=new Image,f.onload=function(){c++,e.attr("src",f.src),e.css("opacity",1),c>=b.length&&(d.state.imagesLoaded=!0,d.initialize())},f.src=e.attr("src")||e.attr("data-src")||e.attr("data-src-retina")})},e.prototype.destroy=function(){this.$element.hasClass(this.settings.themeClass)&&this.$element.removeClass(this.settings.themeClass),this.settings.responsive!==!1&&a(b).off("resize.owl.carousel"),this.transitionEndVendor&&this.off(this.$stage.get(0),this.transitionEndVendor,this.e._transitionEnd);for(var d in this._plugins)this._plugins[d].destroy();(this.settings.mouseDrag||this.settings.touchDrag)&&(this.$stage.off("mousedown touchstart touchcancel"),a(c).off(".owl.dragEvents"),this.$stage.get(0).onselectstart=function(){},this.$stage.off("dragstart",function(){return!1})),this.$element.off(".owl"),this.$stage.children(".cloned").remove(),this.e=null,this.$element.removeData("owlCarousel"),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$stage.unwrap()},e.prototype.op=function(a,b,c){var d=this.settings.rtl;switch(b){case"<":return d?a>c:c>a;case">":return d?c>a:a>c;case">=":return d?c>=a:a>=c;case"<=":return d?a>=c:c>=a}},e.prototype.on=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},e.prototype.off=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)},e.prototype.trigger=function(b,c,d){var e={item:{count:this._items.length,index:this.current()}},f=a.camelCase(a.grep(["on",b,d],function(a){return a}).join("-").toLowerCase()),g=a.Event([b,"owl",d||"carousel"].join(".").toLowerCase(),a.extend({relatedTarget:this},e,c));return this._supress[b]||(a.each(this._plugins,function(a,b){b.onTrigger&&b.onTrigger(g)}),this.$element.trigger(g),this.settings&&"function"==typeof this.settings[f]&&this.settings[f].apply(this,g)),g},e.prototype.suppress=function(b){a.each(b,a.proxy(function(a,b){this._supress[b]=!0},this))},e.prototype.release=function(b){a.each(b,a.proxy(function(a,b){delete this._supress[b]},this))},e.prototype.browserSupport=function(){if(this.support3d=j(),this.support3d){this.transformVendor=i();var a=["transitionend","webkitTransitionEnd","transitionend","oTransitionEnd"];this.transitionEndVendor=a[h()],this.vendorName=this.transformVendor.replace(/Transform/i,""),this.vendorName=""!==this.vendorName?"-"+this.vendorName.toLowerCase()+"-":""}this.state.orientation=b.orientation},a.fn.owlCarousel=function(b){return this.each(function(){a(this).data("owlCarousel")||a(this).data("owlCarousel",new e(this,b))})},a.fn.owlCarousel.Constructor=e}(window.Zepto||window.jQuery,window,document),function(a,b){var c=function(b){this._core=b,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel":a.proxy(function(b){if(b.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(b.property&&"position"==b.property.name||"initialized"==b.type))for(var c=this._core.settings,d=c.center&&Math.ceil(c.items/2)||c.items,e=c.center&&-1*d||0,f=(b.property&&b.property.value||this._core.current())+e,g=this._core.clones().length,h=a.proxy(function(a,b){this.load(b)},this);e++<d;)this.load(g/2+this._core.relative(f)),g&&a.each(this._core.clones(this._core.relative(f++)),h)},this)},this._core.options=a.extend({},c.Defaults,this._core.options),this._core.$element.on(this._handlers)};c.Defaults={lazyLoad:!1},c.prototype.load=function(c){var d=this._core.$stage.children().eq(c),e=d&&d.find(".owl-lazy");!e||a.inArray(d.get(0),this._loaded)>-1||(e.each(a.proxy(function(c,d){var e,f=a(d),g=b.devicePixelRatio>1&&f.attr("data-src-retina")||f.attr("data-src");this._core.trigger("load",{element:f,url:g},"lazy"),f.is("img")?f.one("load.owl.lazy",a.proxy(function(){f.css("opacity",1),this._core.trigger("loaded",{element:f,url:g},"lazy")},this)).attr("src",g):(e=new Image,e.onload=a.proxy(function(){f.css({"background-image":"url("+g+")",opacity:"1"}),this._core.trigger("loaded",{element:f,url:g},"lazy")},this),e.src=g)},this)),this._loaded.push(d.get(0)))},c.prototype.destroy=function(){var a,b;for(a in this.handlers)this._core.$element.off(a,this.handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.Lazy=c}(window.Zepto||window.jQuery,window,document),function(a){var b=function(c){this._core=c,this._handlers={"initialized.owl.carousel":a.proxy(function(){this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":a.proxy(function(a){this._core.settings.autoHeight&&"position"==a.property.name&&this.update()},this),"loaded.owl.lazy":a.proxy(function(a){this._core.settings.autoHeight&&a.element.closest("."+this._core.settings.itemClass)===this._core.$stage.children().eq(this._core.current())&&this.update()},this)},this._core.options=a.extend({},b.Defaults,this._core.options),this._core.$element.on(this._handlers)};b.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},b.prototype.update=function(){this._core.$stage.parent().height(this._core.$stage.children().eq(this._core.current()).height()).addClass(this._core.settings.autoHeightClass)},b.prototype.destroy=function(){var a,b;for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.AutoHeight=b}(window.Zepto||window.jQuery,window,document),function(a,b,c){var d=function(b){this._core=b,this._videos={},this._playing=null,this._fullscreen=!1,this._handlers={"resize.owl.carousel":a.proxy(function(a){this._core.settings.video&&!this.isInFullScreen()&&a.preventDefault()},this),"refresh.owl.carousel changed.owl.carousel":a.proxy(function(){this._playing&&this.stop()},this),"prepared.owl.carousel":a.proxy(function(b){var c=a(b.content).find(".owl-video");c.length&&(c.css("display","none"),this.fetch(c,a(b.content)))},this)},this._core.options=a.extend({},d.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",a.proxy(function(a){this.play(a)},this))};d.Defaults={video:!1,videoHeight:!1,videoWidth:!1},d.prototype.fetch=function(a,b){var c=a.attr("data-vimeo-id")?"vimeo":"youtube",d=a.attr("data-vimeo-id")||a.attr("data-youtube-id"),e=a.attr("data-width")||this._core.settings.videoWidth,f=a.attr("data-height")||this._core.settings.videoHeight,g=a.attr("href");if(!g)throw new Error("Missing video URL.");if(d=g.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),d[3].indexOf("youtu")>-1)c="youtube";else{if(!(d[3].indexOf("vimeo")>-1))throw new Error("Video URL not supported.");c="vimeo"}d=d[6],this._videos[g]={type:c,id:d,width:e,height:f},b.attr("data-video",g),this.thumbnail(a,this._videos[g])},d.prototype.thumbnail=function(b,c){var d,e,f,g=c.width&&c.height?'style="width:'+c.width+"px;height:"+c.height+'px;"':"",h=b.find("img"),i="src",j="",k=this._core.settings,l=function(a){e='<div class="owl-video-play-icon"></div>',d=k.lazyLoad?'<div class="owl-video-tn '+j+'" '+i+'="'+a+'"></div>':'<div class="owl-video-tn" style="opacity:1;background-image:url('+a+')"></div>',b.after(d),b.after(e)};return b.wrap('<div class="owl-video-wrapper"'+g+"></div>"),this._core.settings.lazyLoad&&(i="data-src",j="owl-lazy"),h.length?(l(h.attr(i)),h.remove(),!1):void("youtube"===c.type?(f="http://img.youtube.com/vi/"+c.id+"/hqdefault.jpg",l(f)):"vimeo"===c.type&&a.ajax({type:"GET",url:"http://vimeo.com/api/v2/video/"+c.id+".json",jsonp:"callback",dataType:"jsonp",success:function(a){f=a[0].thumbnail_large,l(f)}}))},d.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null},d.prototype.play=function(b){this._core.trigger("play",null,"video"),this._playing&&this.stop();var c,d,e=a(b.target||b.srcElement),f=e.closest("."+this._core.settings.itemClass),g=this._videos[f.attr("data-video")],h=g.width||"100%",i=g.height||this._core.$stage.height();"youtube"===g.type?c='<iframe width="'+h+'" height="'+i+'" src="http://www.youtube.com/embed/'+g.id+"?autoplay=1&v="+g.id+'" frameborder="0" allowfullscreen></iframe>':"vimeo"===g.type&&(c='<iframe src="http://player.vimeo.com/video/'+g.id+'?autoplay=1" width="'+h+'" height="'+i+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),f.addClass("owl-video-playing"),this._playing=f,d=a('<div style="height:'+i+"px; width:"+h+'px" class="owl-video-frame">'+c+"</div>"),e.after(d)},d.prototype.isInFullScreen=function(){var d=c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement;return d&&a(d).parent().hasClass("owl-video-frame")&&(this._core.speed(0),this._fullscreen=!0),d&&this._fullscreen&&this._playing?!1:this._fullscreen?(this._fullscreen=!1,!1):this._playing&&this._core.state.orientation!==b.orientation?(this._core.state.orientation=b.orientation,!1):!0},d.prototype.destroy=function(){var a,b;this._core.$element.off("click.owl.video");for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.Video=d}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this.core=b,this.core.options=a.extend({},e.Defaults,this.core.options),this.swapping=!0,this.previous=d,this.next=d,this.handlers={"change.owl.carousel":a.proxy(function(a){"position"==a.property.name&&(this.previous=this.core.current(),this.next=a.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":a.proxy(function(a){this.swapping="translated"==a.type},this),"translate.owl.carousel":a.proxy(function(){this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};e.Defaults={animateOut:!1,animateIn:!1},e.prototype.swap=function(){if(1===this.core.settings.items&&this.core.support3d){this.core.speed(0);var b,c=a.proxy(this.clear,this),d=this.core.$stage.children().eq(this.previous),e=this.core.$stage.children().eq(this.next),f=this.core.settings.animateIn,g=this.core.settings.animateOut;this.core.current()!==this.previous&&(g&&(b=this.core.coordinates(this.previous)-this.core.coordinates(this.next),d.css({left:b+"px"}).addClass("animated owl-animated-out").addClass(g).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",c)),f&&e.addClass("animated owl-animated-in").addClass(f).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",c))}},e.prototype.clear=function(b){a(b.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.transitionEnd()},e.prototype.destroy=function(){var a,b;for(a in this.handlers)this.core.$element.off(a,this.handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.Animate=e}(window.Zepto||window.jQuery,window,document),function(a,b,c){var d=function(b){this.core=b,this.core.options=a.extend({},d.Defaults,this.core.options),this.handlers={"translated.owl.carousel refreshed.owl.carousel":a.proxy(function(){this.autoplay()
    },this),"play.owl.autoplay":a.proxy(function(a,b,c){this.play(b,c)},this),"stop.owl.autoplay":a.proxy(function(){this.stop()},this),"mouseover.owl.autoplay":a.proxy(function(){this.core.settings.autoplayHoverPause&&this.pause()},this),"mouseleave.owl.autoplay":a.proxy(function(){this.core.settings.autoplayHoverPause&&this.autoplay()},this)},this.core.$element.on(this.handlers)};d.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},d.prototype.autoplay=function(){this.core.settings.autoplay&&!this.core.state.videoPlay?(b.clearInterval(this.interval),this.interval=b.setInterval(a.proxy(function(){this.play()},this),this.core.settings.autoplayTimeout)):b.clearInterval(this.interval)},d.prototype.play=function(){return c.hidden===!0||this.core.state.isTouch||this.core.state.isScrolling||this.core.state.isSwiping||this.core.state.inMotion?void 0:this.core.settings.autoplay===!1?void b.clearInterval(this.interval):void this.core.next(this.core.settings.autoplaySpeed)},d.prototype.stop=function(){b.clearInterval(this.interval)},d.prototype.pause=function(){b.clearInterval(this.interval)},d.prototype.destroy=function(){var a,c;b.clearInterval(this.interval);for(a in this.handlers)this.core.$element.off(a,this.handlers[a]);for(c in Object.getOwnPropertyNames(this))"function"!=typeof this[c]&&(this[c]=null)},a.fn.owlCarousel.Constructor.Plugins.autoplay=d}(window.Zepto||window.jQuery,window,document),function(a){"use strict";var b=function(c){this._core=c,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":a.proxy(function(b){this._core.settings.dotsData&&this._templates.push(a(b.content).find("[data-dot]").andSelf("[data-dot]").attr("data-dot"))},this),"add.owl.carousel":a.proxy(function(b){this._core.settings.dotsData&&this._templates.splice(b.position,0,a(b.content).find("[data-dot]").andSelf("[data-dot]").attr("data-dot"))},this),"remove.owl.carousel prepared.owl.carousel":a.proxy(function(a){this._core.settings.dotsData&&this._templates.splice(a.position,1)},this),"change.owl.carousel":a.proxy(function(a){if("position"==a.property.name&&!this._core.state.revert&&!this._core.settings.loop&&this._core.settings.navRewind){var b=this._core.current(),c=this._core.maximum(),d=this._core.minimum();a.data=a.property.value>c?b>=c?d:c:a.property.value<d?c:a.property.value}},this),"changed.owl.carousel":a.proxy(function(a){"position"==a.property.name&&this.draw()},this),"refreshed.owl.carousel":a.proxy(function(){this._initialized||(this.initialize(),this._initialized=!0),this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation")},this)},this._core.options=a.extend({},b.Defaults,this._core.options),this.$element.on(this._handlers)};b.Defaults={nav:!1,navRewind:!0,navText:["prev","next"],navSpeed:!1,navElement:"div",navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotData:!1,dotsSpeed:!1,dotsContainer:!1,controlsClass:"owl-controls"},b.prototype.initialize=function(){var b,c,d=this._core.settings;d.dotsData||(this._templates=[a("<div>").addClass(d.dotClass).append(a("<span>")).prop("outerHTML")]),d.navContainer&&d.dotsContainer||(this._controls.$container=a("<div>").addClass(d.controlsClass).appendTo(this.$element)),this._controls.$indicators=d.dotsContainer?a(d.dotsContainer):a("<div>").hide().addClass(d.dotsClass).appendTo(this._controls.$container),this._controls.$indicators.on("click","div",a.proxy(function(b){var c=a(b.target).parent().is(this._controls.$indicators)?a(b.target).index():a(b.target).parent().index();b.preventDefault(),this.to(c,d.dotsSpeed)},this)),b=d.navContainer?a(d.navContainer):a("<div>").addClass(d.navContainerClass).prependTo(this._controls.$container),this._controls.$next=a("<"+d.navElement+">"),this._controls.$previous=this._controls.$next.clone(),this._controls.$previous.addClass(d.navClass[0]).html(d.navText[0]).hide().prependTo(b).on("click",a.proxy(function(){this.prev(d.navSpeed)},this)),this._controls.$next.addClass(d.navClass[1]).html(d.navText[1]).hide().appendTo(b).on("click",a.proxy(function(){this.next(d.navSpeed)},this));for(c in this._overrides)this._core[c]=a.proxy(this[c],this)},b.prototype.destroy=function(){var a,b,c,d;for(a in this._handlers)this.$element.off(a,this._handlers[a]);for(b in this._controls)this._controls[b].remove();for(d in this.overides)this._core[d]=this._overrides[d];for(c in Object.getOwnPropertyNames(this))"function"!=typeof this[c]&&(this[c]=null)},b.prototype.update=function(){var a,b,c,d=this._core.settings,e=this._core.clones().length/2,f=e+this._core.items().length,g=d.center||d.autoWidth||d.dotData?1:d.dotsEach||d.items;if("page"!==d.slideBy&&(d.slideBy=Math.min(d.slideBy,d.items)),d.dots||"page"==d.slideBy)for(this._pages=[],a=e,b=0,c=0;f>a;a++)(b>=g||0===b)&&(this._pages.push({start:a-e,end:a-e+g-1}),b=0,++c),b+=this._core.mergers(this._core.relative(a))},b.prototype.draw=function(){var b,c,d="",e=this._core.settings,f=(this._core.$stage.children(),this._core.relative(this._core.current()));if(!e.nav||e.loop||e.navRewind||(this._controls.$previous.toggleClass("disabled",0>=f),this._controls.$next.toggleClass("disabled",f>=this._core.maximum())),this._controls.$previous.toggle(e.nav),this._controls.$next.toggle(e.nav),e.dots){if(b=this._pages.length-this._controls.$indicators.children().length,e.dotData&&0!==b){for(c=0;c<this._controls.$indicators.children().length;c++)d+=this._templates[this._core.relative(c)];this._controls.$indicators.html(d)}else b>0?(d=new Array(b+1).join(this._templates[0]),this._controls.$indicators.append(d)):0>b&&this._controls.$indicators.children().slice(b).remove();this._controls.$indicators.find(".active").removeClass("active"),this._controls.$indicators.children().eq(a.inArray(this.current(),this._pages)).addClass("active")}this._controls.$indicators.toggle(e.dots)},b.prototype.onTrigger=function(b){var c=this._core.settings;b.page={index:a.inArray(this.current(),this._pages),count:this._pages.length,size:c&&(c.center||c.autoWidth||c.dotData?1:c.dotsEach||c.items)}},b.prototype.current=function(){var b=this._core.relative(this._core.current());return a.grep(this._pages,function(a){return a.start<=b&&a.end>=b}).pop()},b.prototype.getPosition=function(b){var c,d,e=this._core.settings;return"page"==e.slideBy?(c=a.inArray(this.current(),this._pages),d=this._pages.length,b?++c:--c,c=this._pages[(c%d+d)%d].start):(c=this._core.relative(this._core.current()),d=this._core.items().length,b?c+=e.slideBy:c-=e.slideBy),c},b.prototype.next=function(b){a.proxy(this._overrides.to,this._core)(this.getPosition(!0),b)},b.prototype.prev=function(b){a.proxy(this._overrides.to,this._core)(this.getPosition(!1),b)},b.prototype.to=function(b,c,d){var e;d?a.proxy(this._overrides.to,this._core)(b,c):(e=this._pages.length,a.proxy(this._overrides.to,this._core)(this._pages[(b%e+e)%e].start,c))},a.fn.owlCarousel.Constructor.Plugins.Navigation=b}(window.Zepto||window.jQuery,window,document),function(a,b){"use strict";var c=function(d){this._core=d,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":a.proxy(function(){"URLHash"==this._core.settings.startPosition&&a(b).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":a.proxy(function(b){var c=a(b.content).find("[data-hash]").andSelf("[data-hash]").attr("data-hash");this._hashes[c]=b.content},this)},this._core.options=a.extend({},c.Defaults,this._core.options),this.$element.on(this._handlers),a(b).on("hashchange.owl.navigation",a.proxy(function(){var a=b.location.hash.substring(1),c=this._core.$stage.children(),d=this._hashes[a]&&c.index(this._hashes[a])||0;return a?void this._core.to(d,!1,!0):!1},this))};c.Defaults={URLhashListener:!1},c.prototype.destroy=function(){var c,d;a(b).off("hashchange.owl.navigation");for(c in this._handlers)this._core.$element.off(c,this._handlers[c]);for(d in Object.getOwnPropertyNames(this))"function"!=typeof this[d]&&(this[d]=null)},a.fn.owlCarousel.Constructor.Plugins.Hash=c}(window.Zepto||window.jQuery,window,document);
;
/*! iCheck v1.0.1 by Damir Sultanov, http://git.io/arlzeA, MIT Licensed */
(function(f){function A(a,b,d){var c=a[0],g=/er/.test(d)?_indeterminate:/bl/.test(d)?n:k,e=d==_update?{checked:c[k],disabled:c[n],indeterminate:"true"==a.attr(_indeterminate)||"false"==a.attr(_determinate)}:c[g];if(/^(ch|di|in)/.test(d)&&!e)x(a,g);else if(/^(un|en|de)/.test(d)&&e)q(a,g);else if(d==_update)for(var f in e)e[f]?x(a,f,!0):q(a,f,!0);else if(!b||"toggle"==d){if(!b)a[_callback]("ifClicked");e?c[_type]!==r&&q(a,g):x(a,g)}}function x(a,b,d){var c=a[0],g=a.parent(),e=b==k,u=b==_indeterminate,
    v=b==n,s=u?_determinate:e?y:"enabled",F=l(a,s+t(c[_type])),B=l(a,b+t(c[_type]));if(!0!==c[b]){if(!d&&b==k&&c[_type]==r&&c.name){var w=a.closest("form"),p='input[name="'+c.name+'"]',p=w.length?w.find(p):f(p);p.each(function(){this!==c&&f(this).data(m)&&q(f(this),b)})}u?(c[b]=!0,c[k]&&q(a,k,"force")):(d||(c[b]=!0),e&&c[_indeterminate]&&q(a,_indeterminate,!1));D(a,e,b,d)}c[n]&&l(a,_cursor,!0)&&g.find("."+C).css(_cursor,"default");g[_add](B||l(a,b)||"");g.attr("role")&&!u&&g.attr("aria-"+(v?n:k),"true");
    g[_remove](F||l(a,s)||"")}function q(a,b,d){var c=a[0],g=a.parent(),e=b==k,f=b==_indeterminate,m=b==n,s=f?_determinate:e?y:"enabled",q=l(a,s+t(c[_type])),r=l(a,b+t(c[_type]));if(!1!==c[b]){if(f||!d||"force"==d)c[b]=!1;D(a,e,s,d)}!c[n]&&l(a,_cursor,!0)&&g.find("."+C).css(_cursor,"pointer");g[_remove](r||l(a,b)||"");g.attr("role")&&!f&&g.attr("aria-"+(m?n:k),"false");g[_add](q||l(a,s)||"")}function E(a,b){if(a.data(m)){a.parent().html(a.attr("style",a.data(m).s||""));if(b)a[_callback](b);a.off(".i").unwrap();
    f(_label+'[for="'+a[0].id+'"]').add(a.closest(_label)).off(".i")}}function l(a,b,f){if(a.data(m))return a.data(m).o[b+(f?"":"Class")]}function t(a){return a.charAt(0).toUpperCase()+a.slice(1)}function D(a,b,f,c){if(!c){if(b)a[_callback]("ifToggled");a[_callback]("ifChanged")[_callback]("if"+t(f))}}var m="iCheck",C=m+"-helper",r="radio",k="checked",y="un"+k,n="disabled";_determinate="determinate";_indeterminate="in"+_determinate;_update="update";_type="type";_click="click";_touch="touchbegin.i touchend.i";
    _add="addClass";_remove="removeClass";_callback="trigger";_label="label";_cursor="cursor";_mobile=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini|silk/i.test(navigator.userAgent);f.fn[m]=function(a,b){var d='input[type="checkbox"], input[type="'+r+'"]',c=f(),g=function(a){a.each(function(){var a=f(this);c=a.is(d)?c.add(a):c.add(a.find(d))})};if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(a))return a=a.toLowerCase(),g(this),c.each(function(){var c=
        f(this);"destroy"==a?E(c,"ifDestroyed"):A(c,!0,a);f.isFunction(b)&&b()});if("object"!=typeof a&&a)return this;var e=f.extend({checkedClass:k,disabledClass:n,indeterminateClass:_indeterminate,labelHover:!0},a),l=e.handle,v=e.hoverClass||"hover",s=e.focusClass||"focus",t=e.activeClass||"active",B=!!e.labelHover,w=e.labelHoverClass||"hover",p=(""+e.increaseArea).replace("%","")|0;if("checkbox"==l||l==r)d='input[type="'+l+'"]';-50>p&&(p=-50);g(this);return c.each(function(){var a=f(this);E(a);var c=this,
        b=c.id,g=-p+"%",d=100+2*p+"%",d={position:"absolute",top:g,left:g,display:"block",width:d,height:d,margin:0,padding:0,background:"#fff",border:0,opacity:0},g=_mobile?{position:"absolute",visibility:"hidden"}:p?d:{position:"absolute",opacity:0},l="checkbox"==c[_type]?e.checkboxClass||"icheckbox":e.radioClass||"i"+r,z=f(_label+'[for="'+b+'"]').add(a.closest(_label)),u=!!e.aria,y=m+"-"+Math.random().toString(36).substr(2,6),h='<div class="'+l+'" '+(u?'role="'+c[_type]+'" ':"");u&&z.each(function(){h+=
        'aria-labelledby="';this.id?h+=this.id:(this.id=y,h+=y);h+='"'});h=a.wrap(h+"/>")[_callback]("ifCreated").parent().append(e.insert);d=f('<ins class="'+C+'"/>').css(d).appendTo(h);a.data(m,{o:e,s:a.attr("style")}).css(g);e.inheritClass&&h[_add](c.className||"");e.inheritID&&b&&h.attr("id",m+"-"+b);"static"==h.css("position")&&h.css("position","relative");A(a,!0,_update);if(z.length)z.on(_click+".i mouseover.i mouseout.i "+_touch,function(b){var d=b[_type],e=f(this);if(!c[n]){if(d==_click){if(f(b.target).is("a"))return;
        A(a,!1,!0)}else B&&(/ut|nd/.test(d)?(h[_remove](v),e[_remove](w)):(h[_add](v),e[_add](w)));if(_mobile)b.stopPropagation();else return!1}});a.on(_click+".i focus.i blur.i keyup.i keydown.i keypress.i",function(b){var d=b[_type];b=b.keyCode;if(d==_click)return!1;if("keydown"==d&&32==b)return c[_type]==r&&c[k]||(c[k]?q(a,k):x(a,k)),!1;if("keyup"==d&&c[_type]==r)!c[k]&&x(a,k);else if(/us|ur/.test(d))h["blur"==d?_remove:_add](s)});d.on(_click+" mousedown mouseup mouseover mouseout "+_touch,function(b){var d=
        b[_type],e=/wn|up/.test(d)?t:v;if(!c[n]){if(d==_click)A(a,!1,!0);else{if(/wn|er|in/.test(d))h[_add](e);else h[_remove](e+" "+t);if(z.length&&B&&e==v)z[/ut|nd/.test(d)?_remove:_add](w)}if(_mobile)b.stopPropagation();else return!1}})})}})(window.jQuery||window.Zepto);

;
var ProfileGuest=function(){var initHandlers=function(){$('#create-account').on('click',function(event){$('#login').addClass('hide');$('#register').removeClass('hide')});$('#recover-password').on('click',function(event){event.preventDefault();$('#login').addClass('hide');$('#recover').removeClass('hide')});$('.rec_back_link').on('click',function(event){event.preventDefault();$('#recover').addClass('hide');$('#login').removeClass('hide')})},initLoginForm=function(){var loginForm=$('#login-form');loginForm.submit(function(event){event.preventDefault();var $this=$(this),emailInput=$this.find('input[name="email"]'),passwordInput=$this.find('input[name="password"]'),email=emailInput.val(),password=passwordInput.val();if(!email.length||!password.length){new Notification({id:'login-empty-error',message:'Заполните необходимые для входа поля',header:'Вход'}).show();return};if(password.length<6){new Notification({id:'login-pass-error',message:'Пароль должен содержать как минимум 6 символов',header:'Вход'}).show();return};var postData={email:email,password:md5(password)};$.post($this.attr('action'),postData,function(data){if(data.error){new Notification({id:'login-error',message:data.message,header:'Регистрация'}).show();passwordInput.val('')}else if(data.success)location.reload()})})},initRegistrationForm=function(){var regForm=$('#register-form'),agreement=regForm.find('input[name="agreement"]');regForm.find('button.toggle-but').on('click',function(){var $this=$(this);if(!$this.hasClass('on')){$('button.toggle-but').toggleClass('on');regForm.find('input[name="sex"]').val($(this).val())}});agreement.iCheck({checkboxClass:'icheckbox_square'});agreement.on('ifChecked',function(){$(this).val(1)});agreement.on('ifUnchecked',function(){$(this).val(0)});regForm.submit(function(event){event.preventDefault();var $this=$(this),fullname=$this.find('input[name="fullname"]').val(),email=$this.find('input[name="email"]').val(),password=$this.find('input[name="password"]').val(),sex=$this.find('input[name="sex"]').val();if(!fullname.length||!email.length||!password.length){new Notification({id:'reg-empty-error',message:'Заполните необходимые для регистрации поля',header:'Регистрация'}).show();return};if(password.length<6){new Notification({id:'reg-pass-error',message:'Пароль должен содержать как минимум 6 символов',header:'Регистрация'}).show();return};if(!parseInt(agreement.val())){new Notification({id:'reg-empty-error',message:'Мы не можем оформить регистрацию без вашего согласия с Пользовательским соглашением',header:'Регистрация'}).show();return};var name=fullname.split(' '),postData={firstname:name[0],lastname:name[1]||'',email:email,password:md5(password),sex:sex};$.post($this.attr('action'),postData,function(data){if(data.error){new Notification({id:'reg-error',message:data.message,header:'Регистрация'}).show()}else if(data.success)new Notification({id:'reg-success',type:Notification.NOTICE,message:'Аккаунт успешно зарегистрирован. Ссылка для активации отправлена на ваш e-mail',header:'Регистрация',timeout:5e3}).show()})})},initRecoveryForm=function(){var recoverForm=$('#recover-form');recoverForm.submit(function(event){event.preventDefault();var $this=$(this),email=$this.find('input[name="email"]').val();if(!email.length){new Notification({id:'recover-empty-error',message:'Введите email для восстановления пароля',header:'Забыли пароль'}).show();return};$.post($this.attr('action'),{email:email},function(data){if(data.error){new Notification({id:'recover-error',message:data.message,header:'Ошибка'}).show()}else if(data.success)new Notification({id:'recover-success',type:Notification.NOTICE,message:'Ссылка для восстановления пароля отправлена на ваш e-mail',header:'Забыли пароль',timeout:5e3}).show()})})};return{init:function(){initHandlers();initLoginForm();initRegistrationForm();initRecoveryForm()}}}()
;
var ShoppingCart=function(){var mainCart,refreshCartCount=function(){mainCart.getCount(function(data){$('.cart-count').text(data.count)})},reloadCartDiscount=function(discount){var promocode=$('#promocode-value').val(),ultracard=$('#ultracard-value').val();if(discount==="promocode"&&promocode==="")new Notification({id:'error-cart-discount',header:'Активация промокода',message:'Заполните поле промокод'}).show();$.get('/site/getCart',{promocode:promocode},function(data){var $cartMainPage=$('.cart-main-page'),getCart=data;if($cartMainPage.length){$cartMainPage.replaceWith($(data.html));if(!$('.promocode-td').hasClass('hidden')&&!$('.cart-main-table-promocode').hasClass('hide'))$('.go-to-shop').addClass('hidden')}else $.get('/cart/getInfo',function(data){if(data.promocode_discount>0){$('#table-total-promocode-container').show()}else $('#table-total-promocode-container').hide();$('#table-total-promocode').html('-'+data.promocode_discount+' грн');$('#table-total-total').html(data.total+' грн');if(!getCart.error&&promocode!='')$('.promocode-td').hide();var $checkoutPage=$('.checkout-page');if($checkoutPage.length)$checkoutPage.trigger('receiveShoppingCartInfo',data)});if(discount&&data.message)new Notification({id:'error-cart-discount',header:data.header,message:data.message}).show()},'json')},updateCart=function(){var cardTotalNoDiscountPrice=$('.js-cart_total-no-discount, .js-total-no-discount'),cardTotalPrice=$('.js-cart_total, #table-total-total'),cardDelivery=$('#table-total-delivery'),cardQuantityElems=$('.js-cart_quantity');$.get('/cart/getInfo',function(data){var len=Object.keys(data.items).length,total=data.total,delivery=data.delivery_commission,totalNoDiscount=data.total_no_discount;cardQuantityElemsText=(len>4)?len+" товаров на сумму":(len>1&&len<5)?len+" товара на сумму":len+" товар на сумму";cardTotalPrice.text(total+' грн');if(delivery)cardDelivery.text(delivery+' грн');cardTotalNoDiscountPrice.text(totalNoDiscount+' грн');cardQuantityElems.text(cardQuantityElemsText);const deliveryText=$('.table-total-delivery-commission span');deliveryText.text(data.total>data.minimumCostOfFreeShipping?'Бесплатно':'Согласно тарифов "Нова пошта"')})},initMainCart=function(){var cartPage=$('.cart-main-page');mainCart=new Cart(cartPage,{path:'/cart/'});mainCart.getElement().on('click','.remove, .restore',function(event){event.preventDefault();mainCart.togglePosition($(this).closest('.position'))});$(document).delegate('.delete_position','click',function(){USGA.actions.removeFromCart().send($(this));if(!USGA.actions.isPage().cart)App.sendEventGA('cart','menu-cart-remove-item');mainCart.removePositions($.makeArray($(this).data('position-id')));var deleteProduct;if(!$(this).hasClass('small-button')){deleteProduct=$(this).closest('tr').addClass('slide-up');setTimeout(function(){deleteProduct.remove()},500)}else{var $this=$(this).parent().parent();$this.slideUp(500)};updateCart();setTimeout(function(){reloadCartDiscount();$.ajax({url:"/site/getHeader"}).done(function(data){var $dom=$(document.createElement("html"));$dom[0].innerHTML=data;$('#shopingCart').html($dom.find('#shopingCart').html());$('.header-menu .cart-count').html($(data).find('.header-cart .cart-count').html());if(!$('.cart-main-table').length)App.showAppearCart();if($('.cart__main .positions .position').length==0){App.closeAppearCart();$('#content').nanoScroller();$('.header-cart .cart-count').remove();$('.mobile-header').removeClass('count')};var cartItems=$(data).find('.js-cart-item')})},1e3)});$(document).delegate('#activate-promocode','click',function(){reloadCartDiscount('promocode')})},removePositions=function(){var inactiveMain=mainCart.getPositionsData().map(function(){return!this.active?this.positionId:null});if(inactiveMain.length>0)mainCart.removePositions($.makeArray(inactiveMain))},hidePromocodeInput=function(){$('html').on('click','.promocode-button',function(){$('.promocode-td').removeClass('hidden');$('.go-to-shop').addClass('hidden');$('#promocode-value').focus()});$('html').on('click','.promocode-cancel',function(){$('.promocode-td').addClass('hidden');$('.go-to-shop').removeClass('hidden')})},UltracardProgram={$containerCheckoutPage:$('.js-checkout-pages'),$delegationElem:$('html'),buttonPreventDefault:function(){UltracardProgram.$delegationElem.on('click','.submit-ultracard',function(event){var input=$(this).closest('form').find('.ultracard-input'),val=input.val();input.val('').blur().val(val).focus();event.preventDefault()})},whileLoading:function(){if($(window).width()<970&&$('.verification-guest').hasClass('active')){$('.ultracard-container').addClass('show');$('.ultracard-button.cancel').removeClass('hidden')};$(window).resize(function(){if($(window).width()>970&&$('.ultracard-container').hasClass('show')){$('.ultracard-button-container').addClass('hidden')}else $('.ultracard-button-container').removeClass('hidden')});if($('.verification-guest').hasClass('active')&&$('.signin-checkout, .signin-checkout-left').length){$('.table-total').addClass('hidden');$('.ultracard-container').addClass('show')}else{$('.table-total').removeClass('hidden');$('.ultracard-container').removeClass('show')};if($('.active-card').hasClass('active'))UltracardProgram.$delegationElem.on('click','.button-debit',function(){UltracardProgram.showUltracardPointsInput()});var $checkoutPage=$('.checkout-page');if($('.cart-main-page').length||$checkoutPage.length)$.get('/cart/getInfo',function(data){var debitPoints=function(){var balance=data.available_bonuses-data.debited_bonuses;$('.ultracard-points').html(balance+' ГРН.')};debitPoints();if($checkoutPage.length)$checkoutPage.trigger('receiveShoppingCartInfo',data)})},openUltracard:function(){UltracardProgram.$delegationElem.on('click','.ultracard-button',function(){if(isMobile.any()||$(window).width()<970){$('.ultracard-button').addClass('hidden');$('.ultracard-button.cancel').removeClass('hidden');$('.ultracard-container').addClass('show')}else{$('.ultracard-container').addClass('show');$('.ultracard-button').addClass('hidden');$('.ultracard-button.cancel').removeClass('hidden')};UltracardProgram.initUltracardPhone();$('.js-ultracard-input').focus()});UltracardProgram.$delegationElem.on('click','.ultracard-button.cancel',function(){$('.ultracard-button').removeClass('hidden');$('.ultracard-button.cancel').addClass('hidden');$('.ultracard-phone-form').addClass('hidden');$('.ultracard-container').removeClass('show');$('.table-total.cart-total-widget').removeClass('hidden');$('.verification-guest').removeClass('active');if(!$('.active-card').hasClass('active'))$('.no-card-guest').addClass('active');$.post('/discountCard/validation/clearVerificationPhone',function(data){if(!data.error);})})},initUltracardPhone:function(){var $phoneInput=$("#DiscountCardPhoneForm_phone");$phoneInput.inputmask("+38(999)999 99 99",{showMaskOnHover:false});$('.ultracard-phone-form').removeClass('hidden');if($('.signin-checkout').length)$('.table-total').addClass('hidden')},phoneCodeConfirm:function(){if($('.signin-checkout').length){$('.table-total').addClass('hidden')}else $('.table-total').removeClass('hidden');$('.no-card-guest').removeClass('active');$('.verification-guest').addClass('active');$('.ultracard-phone-form').addClass('hidden')},showUltracardPoints:function(){$.get('/discountCard/bonuses/getAvailable',function(data){if(data.error){console.log(data.message)}else{$('.ultracard-points').text(data.amount+' грн.');$('.verification-guest').removeClass('active');$('.active-card').addClass('active');$('.ultracard-container').removeClass('show');if($('.signin-checkout').length)$('.table-total').removeClass('hidden');UltracardProgram.$delegationElem.on('click','.button-debit',function(){UltracardProgram.showUltracardPointsInput()})}})},showUltracardPointsInput:function(){var $pointsCancel=$('.ultracard-points-button.cancel');$('.ultracard-points-input-container').removeClass('hidden');$('.ultracard-points-form').addClass('mobile-show');$('.button-debit').addClass('hidden');$('.ultracard-points-input-container').addClass('show');setTimeout(function(){$('.ultracard-points-input').focus()},0);$('.ultracard-points-input').bind("change keyup input click",function(){if(this.value.match(/[^0-9]/g))this.value=this.value.replace(/[^0-9]/g,'')});UltracardProgram.$delegationElem.on('click','.ultracard-points-button.cancel',function(){$.post('/discountCard/bonuses/clearDebited',function(data){if(data.error)console.log(data.message)});var cartElements={$bonusContainer:$('#table-total-bonus-container'),$bonus:$('#table-total-bonus'),$total:$('#table-total')};$.get('/cart/getInfo',function(data){cartElements.$bonus.html('-'+data.debited_bonuses+' грн');cartElements.$total.html(data.total+' грн');var debitPoints=function(){var balance=data.available_bonuses-data.debited_bonuses;$('.ultracard-points').html(balance+' ГРН.')};debitPoints()});$('.ultracard-points-input-container').addClass('hidden');$('.ultracard-points-form').removeClass('mobile-show');$('.button-debit').removeClass('hidden');$('.ultracard-points-input-container').removeClass('show')});UltracardProgram.pointsConversion()},pointsConversion:function(){var $pointsConversionBtn=$('.submit.submit-points-conversion'),cartElements={$bonusContainer:$('#table-total-bonus-container'),$bonus:$('#table-total-bonus'),$total:$('#table-total-total')};UltracardProgram.$delegationElem.on('click','.submit.submit-points-conversion',function(event){event.preventDefault();var amount=+$('.ultracard-points-input').val();$.post('/discountCard/bonuses/setDebited',{amount:amount},function(data){if(data.error);else if(amount>data.amount){new Notification({id:"error",message:"Количество списываемых бонусов превышает количество доступных",header:"Ошибка"}).show();$('.ultracard-container').removeClass('setDebited')};$.get('/cart/getInfo',function(data){if(data.debited_bonuses>0){cartElements.$bonusContainer.show()}else cartElements.$bonusContainer.hide();cartElements.$bonus.html('-'+data.debited_bonuses+' грн');cartElements.$total.html(data.total+' грн');var debitPoints=function(){var balance=data.available_bonuses-data.debited_bonuses;$('.ultracard-points').html(balance+' ГРН.')};debitPoints()})});$('.ultracard-points-input-container').removeClass('show');$('.ultracard-points-input-container').addClass('hidden');if($(window).width()>970)$('.button-edit').removeClass('hidden');UltracardProgram.changePointsConversion();$('.ultracard-points-button.button-edit').removeClass('hidden');$('.ultracard-points-button.cancel').addClass('hidden');$('.ultracard-points-form').removeClass('mobile-show')})},changePointsConversion:function(){UltracardProgram.$delegationElem.on('click','.button-edit',function(event){event.preventDefault();UltracardProgram.showUltracardPointsInput();$('.button-edit').addClass('hidden');$('.ultracard-points-button.cancel').removeClass('hidden')})},validMaximumAmountBonuses:function(){var $this=$(this);$.get('/cart/getInfo',function(data){var bonusAmount=parseFloat($this.val()),debitedBonusesLimit=data.debited_bonuses_limit,allAmount=data.available_bonuses,availableForUseBonus=allAmount>debitedBonusesLimit?debitedBonusesLimit:allAmount;if(availableForUseBonus<0)availableForUseBonus=0;if(availableForUseBonus<bonusAmount){new Notification({id:"error",message:"Для этого заказа доступно к списанию "+availableForUseBonus+" бонусов.",header:"Ошибка"}).show();$this.val(availableForUseBonus)}})},basketTriggerClose:function(){basketContainer=$('.js-basket-container');if(!basketContainer.is(':visible')){$(this).html('Скрыть <span class="basket-trigger__text-cart">корзину</span>')}else $(this).html('Открыть <span class="basket-trigger__text-cart">корзину</span>');basketContainer.slideToggle()},cartProductDelete3Step:function(){if($('.cart-widget > .cartPagePart:visible').length===1)location.href='/site/shoppingcart'},init:function(){UltracardProgram.openUltracard();UltracardProgram.buttonPreventDefault();UltracardProgram.whileLoading()}};return{init:function(){UltracardProgram.init();initMainCart();hidePromocodeInput();USGA.actions.steps().send();USGA.actions.cartView().send();$(window).on('beforeunload',function(){removePositions()});UltracardProgram.$delegationElem.on('keyup','.ultracard-points-input',UltracardProgram.validMaximumAmountBonuses);$('.js-basket-trigger__close').on('click',UltracardProgram.basketTriggerClose);UltracardProgram.$delegationElem.on('click','.js-cart-product-delete-3-step',UltracardProgram.cartProductDelete3Step);$('.js-form-select_custom input').prop("disabled",true)},getMainCart:function(){return mainCart},cleanCard:function(){return removePositions()},UltracardProgram:UltracardProgram}}()
;
/*! jQuery Migrate v1.2.1 | (c) 2005, 2013 jQuery Foundation, Inc. and other contributors | jquery.org/license */
jQuery.migrateMute===void 0&&(jQuery.migrateMute=!0),function(e,t,n){function r(n){var r=t.console;i[n]||(i[n]=!0,e.migrateWarnings.push(n),r&&r.warn&&!e.migrateMute&&(r.warn("JQMIGRATE: "+n),e.migrateTrace&&r.trace&&r.trace()))}function a(t,a,i,o){if(Object.defineProperty)try{return Object.defineProperty(t,a,{configurable:!0,enumerable:!0,get:function(){return r(o),i},set:function(e){r(o),i=e}}),n}catch(s){}e._definePropertyBroken=!0,t[a]=i}var i={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){i={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&r("jQuery is not compatible with Quirks Mode");var o=e("<input/>",{size:1}).attr("size")&&e.attrFn,s=e.attr,u=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},c=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},l=/^(?:input|button)$/i,d=/^[238]$/,p=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,f=/^(?:checked|selected)$/i;a(e,"attrFn",o||{},"jQuery.attrFn is deprecated"),e.attr=function(t,a,i,u){var c=a.toLowerCase(),g=t&&t.nodeType;return u&&(4>s.length&&r("jQuery.fn.attr( props, pass ) is deprecated"),t&&!d.test(g)&&(o?a in o:e.isFunction(e.fn[a])))?e(t)[a](i):("type"===a&&i!==n&&l.test(t.nodeName)&&t.parentNode&&r("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[c]&&p.test(c)&&(e.attrHooks[c]={get:function(t,r){var a,i=e.prop(t,r);return i===!0||"boolean"!=typeof i&&(a=t.getAttributeNode(r))&&a.nodeValue!==!1?r.toLowerCase():n},set:function(t,n,r){var a;return n===!1?e.removeAttr(t,r):(a=e.propFix[r]||r,a in t&&(t[a]=!0),t.setAttribute(r,r.toLowerCase())),r}},f.test(c)&&r("jQuery.fn.attr('"+c+"') may use property instead of attribute")),s.call(e,t,a,i))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?u.apply(this,arguments):("input"!==n&&"option"!==n&&r("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var a=(e.nodeName||"").toLowerCase();return"button"===a?c.apply(this,arguments):("input"!==a&&"option"!==a&&r("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t,n)}};var g,h,v=e.fn.init,m=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,a){var i;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(i=y.exec(e.trim(t)))&&i[0]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),i[3]&&r("$(html) HTML text after last tag is ignored"),"#"===i[0].charAt(0)&&(r("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?v.call(this,e.parseHTML(i[2],n,!0),n,a):v.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?m.apply(this,arguments):(r("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(g=e.uaMatch(navigator.userAgent),h={},g.browser&&(h[g.browser]=!0,h.version=g.version),h.chrome?h.webkit=!0:h.webkit&&(h.safari=!0),e.browser=h),a(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(r,a){return a&&a instanceof e&&!(a instanceof t)&&(a=t(a)),e.fn.init.call(this,r,a,n)},t.fn.init.prototype=t.fn;var n=t(document);return r("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var a,i,o=this[0];return!o||"events"!==t||1!==arguments.length||(a=e.data(o,t),i=e._data(o,t),a!==n&&a!==i||i===n)?b.apply(this,arguments):(r("Use of jQuery.fn.data('events') is deprecated"),i)};var j=/\/(java|ecma)script/i,w=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return r("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),w.apply(this,arguments)},e.clean||(e.clean=function(t,a,i,o){a=a||document,a=!a.nodeType&&a[0]||a,a=a.ownerDocument||a,r("jQuery.clean() is deprecated");var s,u,c,l,d=[];if(e.merge(d,e.buildFragment(t,a).childNodes),i)for(c=function(e){return!e.type||j.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e):n},s=0;null!=(u=d[s]);s++)e.nodeName(u,"script")&&c(u)||(i.appendChild(u),u.getElementsByTagName!==n&&(l=e.grep(e.merge([],u.getElementsByTagName("script")),c),d.splice.apply(d,[s+1,0].concat(l)),s+=l.length));return d});var Q=e.event.add,x=e.event.remove,k=e.event.trigger,N=e.fn.toggle,T=e.fn.live,M=e.fn.die,S="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",C=RegExp("\\b(?:"+S+")\\b"),H=/(?:^|\s)hover(\.\S+|)\b/,A=function(t){return"string"!=typeof t||e.event.special.hover?t:(H.test(t)&&r("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(H,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&a(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,a,i){e!==document&&C.test(t)&&r("AJAX events should be attached to document: "+t),Q.call(this,e,A(t||""),n,a,i)},e.event.remove=function(e,t,n,r,a){x.call(this,e,A(t)||"",n,r,a)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return r("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return N.apply(this,arguments);r("jQuery.fn.toggle(handler, handler...) is deprecated");var a=arguments,i=t.guid||e.guid++,o=0,s=function(n){var r=(e._data(this,"lastToggle"+t.guid)||0)%o;return e._data(this,"lastToggle"+t.guid,r+1),n.preventDefault(),a[r].apply(this,arguments)||!1};for(s.guid=i;a.length>o;)a[o++].guid=i;return this.click(s)},e.fn.live=function(t,n,a){return r("jQuery.fn.live() is deprecated"),T?T.apply(this,arguments):(e(this.context).on(t,this.selector,n,a),this)},e.fn.die=function(t,n){return r("jQuery.fn.die() is deprecated"),M?M.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,a){return n||C.test(e)||r("Global events are undocumented and deprecated"),k.call(this,e,t,n||document,a)},e.each(S.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window);
;
(function($){$.easytabs=function(container,options){var plugin=this,$container=$(container),defaults={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:'fadeIn',transitionOut:'fadeOut',transitionInEasing:'swing',transitionOutEasing:'swing',transitionCollapse:'slideUp',transitionUncollapse:'slideDown',transitionCollapseEasing:'swing',transitionUncollapseEasing:'swing',containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true,event:'click',panelContext:$container},$defaultTab,$defaultTabLink,transitions,lastHash,skipUpdateToHash,animationSpeeds={fast:200,normal:400,slow:600},settings;plugin.init=function(){plugin.settings=settings=$.extend({},defaults,options);settings.bind_str=settings.event+".easytabs";if(settings.uiTabs){settings.tabActiveClass='ui-tabs-selected';settings.containerClass='ui-tabs ui-widget ui-widget-content ui-corner-all';settings.tabsClass='ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all';settings.tabClass='ui-state-default ui-corner-top';settings.panelClass='ui-tabs-panel ui-widget-content ui-corner-bottom'};if(settings.collapsible&&options.defaultTab!==undefined&&options.collpasedByDefault===undefined)settings.collapsedByDefault=false;if(typeof(settings.animationSpeed)==='string')settings.animationSpeed=animationSpeeds[settings.animationSpeed];$('a.anchor').remove().prependTo('body');$container.data('easytabs',{});plugin.setTransitions();plugin.getTabs();addClasses();setDefaultTab();bindToTabClicks();initHashChange();initCycle();$container.attr('data-easytabs',true)};plugin.setTransitions=function(){transitions=(settings.animate)?{show:settings.transitionIn,hide:settings.transitionOut,speed:settings.animationSpeed,collapse:settings.transitionCollapse,uncollapse:settings.transitionUncollapse,halfSpeed:settings.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};plugin.getTabs=function(){var $matchingPanel;plugin.tabs=$container.find(settings.tabs),plugin.panels=$(),plugin.tabs.each(function(){var $tab=$(this),$a=$tab.children('a'),targetId=$tab.children('a').data('target');$tab.data('easytabs',{});if(targetId!==undefined&&targetId!==null){$tab.data('easytabs').ajax=$a.attr('href')}else targetId=$a.attr('href');targetId=targetId.match(/#([^\?]+)/)[1];$matchingPanel=settings.panelContext.find("#"+targetId);if($matchingPanel.length){$matchingPanel.data('easytabs',{position:$matchingPanel.css('position'),visibility:$matchingPanel.css('visibility')});$matchingPanel.not(settings.panelActiveClass).hide();plugin.panels=plugin.panels.add($matchingPanel);$tab.data('easytabs').panel=$matchingPanel}else{plugin.tabs=plugin.tabs.not($tab);if('console'in window)console.warn('Warning: tab without matching panel for selector \'#'+targetId+'\' removed from set')}})};plugin.selectTab=function($clicked,callback){var url=window.location,hash=url.hash.match(/^[^\?]*/)[0],$targetPanel=$clicked.parent().data('easytabs').panel,ajaxUrl=$clicked.parent().data('easytabs').ajax;if(settings.collapsible&&!skipUpdateToHash&&($clicked.hasClass(settings.tabActiveClass)||$clicked.hasClass(settings.collapsedClass))){plugin.toggleTabCollapse($clicked,$targetPanel,ajaxUrl,callback)}else if(!$clicked.hasClass(settings.tabActiveClass)||!$targetPanel.hasClass(settings.panelActiveClass)){activateTab($clicked,$targetPanel,ajaxUrl,callback)}else if(!settings.cache)activateTab($clicked,$targetPanel,ajaxUrl,callback)};plugin.toggleTabCollapse=function($clicked,$targetPanel,ajaxUrl,callback){plugin.panels.stop(true,true);if(fire($container,"easytabs:before",[$clicked,$targetPanel,settings])){plugin.tabs.filter("."+settings.tabActiveClass).removeClass(settings.tabActiveClass).children().removeClass(settings.tabActiveClass);if($clicked.hasClass(settings.collapsedClass)){if(ajaxUrl&&(!settings.cache||!$clicked.parent().data('easytabs').cached)){$container.trigger('easytabs:ajax:beforeSend',[$clicked,$targetPanel]);$targetPanel.load(ajaxUrl,function(response,status,xhr){$clicked.parent().data('easytabs').cached=true;$container.trigger('easytabs:ajax:complete',[$clicked,$targetPanel,response,status,xhr])})};$clicked.parent().removeClass(settings.collapsedClass).addClass(settings.tabActiveClass).children().removeClass(settings.collapsedClass).addClass(settings.tabActiveClass);$targetPanel.addClass(settings.panelActiveClass)[transitions.uncollapse](transitions.speed,settings.transitionUncollapseEasing,function(){$container.trigger('easytabs:midTransition',[$clicked,$targetPanel,settings]);if(typeof callback=='function')callback()})}else{$clicked.addClass(settings.collapsedClass).parent().addClass(settings.collapsedClass);$targetPanel.removeClass(settings.panelActiveClass)[transitions.collapse](transitions.speed,settings.transitionCollapseEasing,function(){$container.trigger("easytabs:midTransition",[$clicked,$targetPanel,settings]);if(typeof callback=='function')callback()})}}};plugin.matchTab=function(hash){return plugin.tabs.find("[href='"+hash+"'],[data-target='"+hash+"']").first()};plugin.matchInPanel=function(hash){return(hash&&plugin.validId(hash)?plugin.panels.filter(':has('+hash+')').first():[])};plugin.validId=function(id){return id.substr(1).match(/^[A-Za-z]+[A-Za-z0-9\-_:\.].$/)};plugin.selectTabFromHashChange=function(){var hash=window.location.hash.match(/^[^\?]*/)[0],$tab=plugin.matchTab(hash),$panel;if(settings.updateHash)if($tab.length){skipUpdateToHash=true;plugin.selectTab($tab)}else{$panel=plugin.matchInPanel(hash);if($panel.length){hash='#'+$panel.attr('id');$tab=plugin.matchTab(hash);skipUpdateToHash=true;plugin.selectTab($tab)}else if(!$defaultTab.hasClass(settings.tabActiveClass)&&!settings.cycle)if(hash===''||plugin.matchTab(lastHash).length||$container.closest(hash).length){skipUpdateToHash=true;plugin.selectTab($defaultTabLink)}}};plugin.cycleTabs=function(tabNumber){if(settings.cycle){tabNumber=tabNumber%plugin.tabs.length;$tab=$(plugin.tabs[tabNumber]).children("a").first();skipUpdateToHash=true;plugin.selectTab($tab,function(){setTimeout(function(){plugin.cycleTabs(tabNumber+1)},settings.cycle)})}};plugin.publicMethods={select:function(tabSelector){var $tab;if(($tab=plugin.tabs.filter(tabSelector)).length===0){if(($tab=plugin.tabs.find("a[href='"+tabSelector+"']")).length===0)if(($tab=plugin.tabs.find("a"+tabSelector)).length===0)if(($tab=plugin.tabs.find("[data-target='"+tabSelector+"']")).length===0)if(($tab=plugin.tabs.find("a[href$='"+tabSelector+"']")).length===0)$.error('Tab \''+tabSelector+'\' does not exist in tab set')}else $tab=$tab.children("a").first();plugin.selectTab($tab)}};var fire=function(obj,name,data){var event=$.Event(name);obj.trigger(event,data);return event.result!==false},addClasses=function(){$container.addClass(settings.containerClass);plugin.tabs.parent().addClass(settings.tabsClass);plugin.tabs.addClass(settings.tabClass);plugin.panels.addClass(settings.panelClass)},setDefaultTab=function(){var hash=window.location.hash.match(/^[^\?]*/)[0],$selectedTab=plugin.matchTab(hash).parent(),$panel;if($selectedTab.length===1){$defaultTab=$selectedTab;settings.cycle=false}else{$panel=plugin.matchInPanel(hash);if($panel.length){hash='#'+$panel.attr('id');$defaultTab=plugin.matchTab(hash).parent()}else{$defaultTab=plugin.tabs.parent().find(settings.defaultTab);if($defaultTab.length===0)$.error("The specified default tab ('"+settings.defaultTab+"') could not be found in the tab set ('"+settings.tabs+"') out of "+plugin.tabs.length+" tabs.")}};$defaultTabLink=$defaultTab.children("a").first();activateDefaultTab($selectedTab)},activateDefaultTab=function($selectedTab){var defaultPanel,defaultAjaxUrl;if(settings.collapsible&&$selectedTab.length===0&&settings.collapsedByDefault){$defaultTab.addClass(settings.collapsedClass).children().addClass(settings.collapsedClass)}else{defaultPanel=$($defaultTab.data('easytabs').panel);defaultAjaxUrl=$defaultTab.data('easytabs').ajax;if(defaultAjaxUrl&&(!settings.cache||!$defaultTab.data('easytabs').cached)){$container.trigger('easytabs:ajax:beforeSend',[$defaultTabLink,defaultPanel]);defaultPanel.load(defaultAjaxUrl,function(response,status,xhr){$defaultTab.data('easytabs').cached=true;$container.trigger('easytabs:ajax:complete',[$defaultTabLink,defaultPanel,response,status,xhr])})};$defaultTab.data('easytabs').panel.show().addClass(settings.panelActiveClass);$defaultTab.addClass(settings.tabActiveClass).children().addClass(settings.tabActiveClass)};$container.trigger("easytabs:initialised",[$defaultTabLink,defaultPanel])},bindToTabClicks=function(){plugin.tabs.children("a").bind(settings.bind_str,function(e){settings.cycle=false;skipUpdateToHash=false;plugin.selectTab($(this));e.preventDefault?e.preventDefault():e.returnValue=false})},activateTab=function($clicked,$targetPanel,ajaxUrl,callback){plugin.panels.stop(true,true);if(fire($container,"easytabs:before",[$clicked,$targetPanel,settings])){var $visiblePanel=plugin.panels.filter(":visible"),$panelContainer=$targetPanel.parent(),targetHeight,visibleHeight,heightDifference,showPanel,hash=window.location.hash.match(/^[^\?]*/)[0];if(settings.animate){targetHeight=getHeightForHidden($targetPanel);visibleHeight=$visiblePanel.length?setAndReturnHeight($visiblePanel):0;heightDifference=targetHeight-visibleHeight};lastHash=hash;showPanel=function(){$container.trigger("easytabs:midTransition",[$clicked,$targetPanel,settings]);if(settings.animate&&settings.transitionIn=='fadeIn')if(heightDifference<0)$panelContainer.animate({height:$panelContainer.height()+heightDifference},transitions.halfSpeed).css({'min-height':''});if(settings.updateHash&&!skipUpdateToHash){window.location.hash='#'+$targetPanel.attr('id')}else skipUpdateToHash=false;$targetPanel[transitions.show](transitions.speed,settings.transitionInEasing,function(){$panelContainer.css({height:'','min-height':''});$container.trigger("easytabs:after",[$clicked,$targetPanel,settings]);if(typeof callback=='function')callback()})};if(ajaxUrl&&(!settings.cache||!$clicked.parent().data('easytabs').cached)){$container.trigger('easytabs:ajax:beforeSend',[$clicked,$targetPanel]);$targetPanel.load(ajaxUrl,function(response,status,xhr){$clicked.parent().data('easytabs').cached=true;$container.trigger('easytabs:ajax:complete',[$clicked,$targetPanel,response,status,xhr])})};if(settings.animate&&settings.transitionOut=='fadeOut')if(heightDifference>0){$panelContainer.animate({height:($panelContainer.height()+heightDifference)},transitions.halfSpeed)}else $panelContainer.css({'min-height':$panelContainer.height()});plugin.tabs.filter("."+settings.tabActiveClass).removeClass(settings.tabActiveClass).children().removeClass(settings.tabActiveClass);plugin.tabs.filter("."+settings.collapsedClass).removeClass(settings.collapsedClass).children().removeClass(settings.collapsedClass);$clicked.parent().addClass(settings.tabActiveClass).children().addClass(settings.tabActiveClass);plugin.panels.filter("."+settings.panelActiveClass).removeClass(settings.panelActiveClass);$targetPanel.addClass(settings.panelActiveClass);if($visiblePanel.length){$visiblePanel[transitions.hide](transitions.speed,settings.transitionOutEasing,showPanel)}else $targetPanel[transitions.uncollapse](transitions.speed,settings.transitionUncollapseEasing,showPanel)}},getHeightForHidden=function($targetPanel){if($targetPanel.data('easytabs')&&$targetPanel.data('easytabs').lastHeight)return $targetPanel.data('easytabs').lastHeight;var display=$targetPanel.css('display'),outerCloak,height;try{outerCloak=$('<div></div>',{position:'absolute',visibility:'hidden',overflow:'hidden'})}catch(e){outerCloak=$('<div></div>',{visibility:'hidden',overflow:'hidden'})};height=$targetPanel.wrap(outerCloak).css({position:'relative',visibility:'hidden',display:'block'}).outerHeight();$targetPanel.unwrap();$targetPanel.css({position:$targetPanel.data('easytabs').position,visibility:$targetPanel.data('easytabs').visibility,display:display});$targetPanel.data('easytabs').lastHeight=height;return height},setAndReturnHeight=function($visiblePanel){var height=$visiblePanel.outerHeight();if($visiblePanel.data('easytabs')){$visiblePanel.data('easytabs').lastHeight=height}else $visiblePanel.data('easytabs',{lastHeight:height});return height},initHashChange=function(){if(typeof $(window).hashchange==='function'){$(window).hashchange(function(){plugin.selectTabFromHashChange()})}else if($.address&&typeof $.address.change==='function')$.address.change(function(){plugin.selectTabFromHashChange()})},initCycle=function(){var tabNumber;if(settings.cycle){tabNumber=plugin.tabs.index($defaultTab);setTimeout(function(){plugin.cycleTabs(tabNumber+1)},settings.cycle)}};plugin.init()};$.fn.easytabs=function(options){var args=arguments;return this.each(function(){var $this=$(this),plugin=$this.data('easytabs');if(undefined===plugin){plugin=new $.easytabs(this,options);$this.data('easytabs',plugin)};if(plugin.publicMethods[options])return plugin.publicMethods[options](Array.prototype.slice.call(args,1))})}})(jQuery)
;
(function($){'use strict';var _inlineComplete={dataListSupport:!!(document.createElement('datalist')&&window.HTMLDataListElement),_defaultOptions:{list:[],matchCase:false,submitOnReturn:false,startChar:'',startCharCi:true,disableDataList:false},_searchTerm:function(userInput,terms){for(var i in terms)if(terms[i].substr(0,userInput.length)==userInput)return terms[i];return null},_getCurrentWord:function(text,cursorPosition){var start=text.substr(0,cursorPosition).lastIndexOf(' ')+1;return text.substr(start,cursorPosition)},_performComplete:function(inputElement,event,options){if(event.which==8||event.which==46||event.ctrlKey||event.which==17||!options.list||options.list.length==0){return true}else if(event.which==16)return this;var $inputElement=$(inputElement),userInput=this._getCurrentWord($inputElement.val()),returnValue=true;if(userInput!=''){if(!options.matchCase)userInput=userInput.toLowerCase();if(event.type=='keydown'){var selection=$inputElement.__getSelection(),letter=String.fromCharCode(event.which);if(letter=='')return returnValue;if(!event.shiftKey)letter=letter.toLowerCase();if(letter==selection.substr(0,1)){$inputElement.__moveSelectionStart(1);returnValue=false}}else if(event.type=='keyup'){var curPos=$inputElement.__cursorPosition(),inputValue=$inputElement.val(),foundTerm=this._searchTerm(userInput,options.list);if(foundTerm!==null&&foundTerm!=userInput){var beforeCursor=inputValue.substr(0,curPos),afterCursor=inputValue.substr(curPos,inputValue.length),curPosInWord=curPos-(inputValue.substr(0,curPos).lastIndexOf(' ')+1),poop=foundTerm.substr(curPosInWord,foundTerm.length);$inputElement.val(beforeCursor+poop+afterCursor);$inputElement.__select(curPos,poop.length+curPos)}}};return returnValue}};$.fn.__select=function(startPos,endPos){if(typeof startPos=='number'&&typeof endPos=='number')this.each(function(){var start;if(typeof this.selectionStart!=="undefined"){this.selectionStart=startPos;this.selectionEnd=endPos}else{var range=document.selection.createRange();this.select();var range2=document.selection.createRange();range2.setEndPoint("EndToStart",range);start=range2.text.length;this.select();range=document.selection.createRange();range.moveStart("character",start);range.select()}});return this};$.fn.__getSelection=function(){var el=this.get(0);if(typeof el.selectionStart!='undefined'){return this.val().substr(el.selectionStart,el.selectionEnd)}else{var range=document.selection.createRange();return range.text}};$.fn.__moveSelectionStart=function(amount){if(typeof amount=='number')this.each(function(){if(typeof this.selectionStart!=='undefined'){this.selectionStart+=amount}else{var range=document.selection.createRange();range.moveStart("character",amount);range.select()}})};$.fn.__cursorPosition=function(){if(typeof this.get(0).selectionStart!=='undefined'){return this.get(0).selectionStart}else{var range=document.selection.createRange();range.moveStart("character",amount);range.select()}};$.fn.inlineComplete=function(options){this.filter('input[type=text], textarea').each(function(e){var $this=$(this),instanceOptions=$.extend(true,{},_inlineComplete._defaultOptions,options);if(instanceOptions.list.length==0)if($this.data('list')){if($this.data('list').indexOf('list')===0)instanceOptions.list=$this.data('list').replace(/^list:/i,'').split('|')}else if(typeof $this.attr('list')!='undefined'){var $datalist=$('#'+$this.attr('list'));if($datalist.length>0){if(_inlineComplete.dataListSupport){var datalistOptions=$datalist.get(0).options;for(var i in datalistOptions)if(datalistOptions[i].value)instanceOptions.list.push(datalistOptions[i].value)}else{instanceOptions.list=[];$datalist.find('option').each(function(){instanceOptions.list.push($this.attr('value'))})};if(instanceOptions.disableDataList)$this.removeAttr('list')}};var cleanList=[];for(var i in instanceOptions.list)if(instanceOptions.list[i].replace(/\s*/,'')!='')cleanList.push(instanceOptions.list[i]);instanceOptions.list=cleanList;if(instanceOptions.list.length==0)return true;$this.on('keyup keydown',function(e){return _inlineComplete._performComplete($this,e,instanceOptions)});return true});return this}})(jQuery)
;
function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=ff(a,b,c,d,k[0],7,-680876936);d=ff(d,a,b,c,k[1],12,-389564586);c=ff(c,d,a,b,k[2],17,606105819);b=ff(b,c,d,a,k[3],22,-1044525330);a=ff(a,b,c,d,k[4],7,-176418897);d=ff(d,a,b,c,k[5],12,1200080426);c=ff(c,d,a,b,k[6],17,-1473231341);b=ff(b,c,d,a,k[7],22,-45705983);a=ff(a,b,c,d,k[8],7,1770035416);d=ff(d,a,b,c,k[9],12,-1958414417);c=ff(c,d,a,b,k[10],17,-42063);b=ff(b,c,d,a,k[11],22,-1990404162);a=ff(a,b,c,d,k[12],7,1804603682);d=ff(d,a,b,c,k[13],12,-40341101);c=ff(c,d,a,b,k[14],17,-1502002290);b=ff(b,c,d,a,k[15],22,1236535329);a=gg(a,b,c,d,k[1],5,-165796510);d=gg(d,a,b,c,k[6],9,-1069501632);c=gg(c,d,a,b,k[11],14,643717713);b=gg(b,c,d,a,k[0],20,-373897302);a=gg(a,b,c,d,k[5],5,-701558691);d=gg(d,a,b,c,k[10],9,38016083);c=gg(c,d,a,b,k[15],14,-660478335);b=gg(b,c,d,a,k[4],20,-405537848);a=gg(a,b,c,d,k[9],5,568446438);d=gg(d,a,b,c,k[14],9,-1019803690);c=gg(c,d,a,b,k[3],14,-187363961);b=gg(b,c,d,a,k[8],20,1163531501);a=gg(a,b,c,d,k[13],5,-1444681467);d=gg(d,a,b,c,k[2],9,-51403784);c=gg(c,d,a,b,k[7],14,1735328473);b=gg(b,c,d,a,k[12],20,-1926607734);a=hh(a,b,c,d,k[5],4,-378558);d=hh(d,a,b,c,k[8],11,-2022574463);c=hh(c,d,a,b,k[11],16,1839030562);b=hh(b,c,d,a,k[14],23,-35309556);a=hh(a,b,c,d,k[1],4,-1530992060);d=hh(d,a,b,c,k[4],11,1272893353);c=hh(c,d,a,b,k[7],16,-155497632);b=hh(b,c,d,a,k[10],23,-1094730640);a=hh(a,b,c,d,k[13],4,681279174);d=hh(d,a,b,c,k[0],11,-358537222);c=hh(c,d,a,b,k[3],16,-722521979);b=hh(b,c,d,a,k[6],23,76029189);a=hh(a,b,c,d,k[9],4,-640364487);d=hh(d,a,b,c,k[12],11,-421815835);c=hh(c,d,a,b,k[15],16,530742520);b=hh(b,c,d,a,k[2],23,-995338651);a=ii(a,b,c,d,k[0],6,-198630844);d=ii(d,a,b,c,k[7],10,1126891415);c=ii(c,d,a,b,k[14],15,-1416354905);b=ii(b,c,d,a,k[5],21,-57434055);a=ii(a,b,c,d,k[12],6,1700485571);d=ii(d,a,b,c,k[3],10,-1894986606);c=ii(c,d,a,b,k[10],15,-1051523);b=ii(b,c,d,a,k[1],21,-2054922799);a=ii(a,b,c,d,k[8],6,1873313359);d=ii(d,a,b,c,k[15],10,-30611744);c=ii(c,d,a,b,k[6],15,-1560198380);b=ii(b,c,d,a,k[13],21,1309151649);a=ii(a,b,c,d,k[4],6,-145523070);d=ii(d,a,b,c,k[11],10,-1120210379);c=ii(c,d,a,b,k[2],15,718787259);b=ii(b,c,d,a,k[9],21,-343485551);x[0]=add32(a,x[0]);x[1]=add32(b,x[1]);x[2]=add32(c,x[2]);x[3]=add32(d,x[3])}
function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32((a<<s)|(a>>>(32-s)),b)}
function ff(a,b,c,d,x,s,t){return cmn((b&c)|((~b)&d),a,b,x,s,t)}
function gg(a,b,c,d,x,s,t){return cmn((b&d)|(c&(~d)),a,b,x,s,t)}
function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}
function ii(a,b,c,d,x,s,t){return cmn(c^(b|(~d)),a,b,x,s,t)}
function md51(s){txt='';var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i;for(i=64;i<=s.length;i+=64)md5cycle(state,md5blk(s.substring(i-64,i)));s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)tail[i>>2]|=s.charCodeAt(i)<<((i%4)<<3);tail[i>>2]|=0x80<<((i%4)<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i++)tail[i]=0};tail[14]=n*8;md5cycle(state,tail);return state}
function md5blk(s){var md5blks=[],i;for(i=0;i<64;i+=4)md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return md5blks};var hex_chr='0123456789abcdef'.split('')
function rhex(n){var s='',j=0;for(;j<4;j++)s+=hex_chr[(n>>(j*8+4))&0x0F]+hex_chr[(n>>(j*8))&0x0F];return s}
function hex(x){for(var i=0;i<x.length;i++)x[i]=rhex(x[i]);return x.join('')}
function md5(s){return hex(md51(s))}
function add32(a,b){return(a+b)&0xFFFFFFFF};if(md5('hello')!='5d41402abc4b2a76b9719d911017c592')function add32(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}
;
(function(){var rsplit=function(string,regex){var result=regex.exec(string),retArr=new Array(),first_idx,last_idx,first_bit;while(result!=null){first_idx=result.index;last_idx=regex.lastIndex;if(first_idx!=0){first_bit=string.substring(0,first_idx);retArr.push(string.substring(0,first_idx));string=string.slice(first_idx)};retArr.push(result[0]);string=string.slice(result[0].length);result=regex.exec(string)};if(!string=="")retArr.push(string);return retArr},chop=function(string){return string.substr(0,string.length-1)},extend=function(d,s){for(var n in s)if(s.hasOwnProperty(n))d[n]=s[n]};EJS=function(options){options=typeof options=="string"?{view:options}:options;this.set_options(options);if(options.precompiled){this.template={};this.template.process=options.precompiled;EJS.update(this.name,this);return};if(options.element){if(typeof options.element=="string"){var name=options.element;options.element=document.getElementById(options.element);if(options.element==null)throw name+"does not exist!"};if(options.element.value){this.text=options.element.value}else this.text=options.element.innerHTML;this.name=options.element.id;this.type="["}else if(options.url){options.url=EJS.endExt(options.url,this.extMatch);this.name=this.name?this.name:options.url;var url=options.url,template=EJS.get(this.name,this.cache);if(template)return template;if(template==EJS.INVALID_PATH)return null;try{this.text=EJS.request(url+(this.cache?"":"?"+Math.random()))}catch(e){};if(this.text==null)throw{type:"EJS",message:"There is no template at "+url}};var template=new EJS.Compiler(this.text,this.type);template.compile(options,this.name);EJS.update(this.name,this);this.template=template};EJS.prototype={render:function(object,extra_helpers){object=object||{};this._extra_helpers=extra_helpers;var v=new EJS.Helpers(object,extra_helpers||{});return this.template.process.call(object,object,v)},update:function(element,options){if(typeof element=="string")element=document.getElementById(element);if(options==null){_template=this;return function(object){EJS.prototype.update.call(_template,element,object)}};if(typeof options=="string"){params={};params.url=options;_template=this;params.onComplete=function(request){var object=eval(request.responseText);EJS.prototype.update.call(_template,element,object)};EJS.ajax_request(params)}else element.innerHTML=this.render(options)},out:function(){return this.template.out},set_options:function(options){this.type=options.type||EJS.type;this.cache=options.cache!=null?options.cache:EJS.cache;this.text=options.text||null;this.name=options.name||null;this.ext=options.ext||EJS.ext;this.extMatch=new RegExp(this.ext.replace(/\./,"."))}};EJS.endExt=function(path,match){if(!path)return null;match.lastIndex=0;return path+(match.test(path)?"":this.ext)};EJS.Scanner=function(source,left,right){extend(this,{left_delimiter:left+"%",right_delimiter:"%"+right,double_left:left+"%%",double_right:"%%"+right,left_equal:left+"%=",left_comment:left+"%#"});this.SplitRegexp=left=="["?/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/:new RegExp("("+this.double_left+")|(%%"+this.double_right+")|("+this.left_equal+")|("+this.left_comment+")|("+this.left_delimiter+")|("+this.right_delimiter+"\n)|("+this.right_delimiter+")|(\n)");this.source=source;this.stag=null;this.lines=0};EJS.Scanner.to_text=function(input){if(input==null||input===undefined)return"";if(input instanceof Date)return input.toDateString();if(input.toString)return input.toString();return""};EJS.Scanner.prototype={scan:function(block){scanline=this.scanline;regex=this.SplitRegexp;if(!this.source==""){var source_split=rsplit(this.source,/\n/);for(var i=0;i<source_split.length;i++){var item=source_split[i];this.scanline(item,regex,block)}}},scanline:function(line,regex,block){this.lines++;var line_split=rsplit(line,regex);for(var i=0;i<line_split.length;i++){var token=line_split[i];if(token!=null)try{block(token,this)}catch(e){throw{type:"EJS.Scanner",line:this.lines}}}}};EJS.Buffer=function(pre_cmd,post_cmd){this.line=new Array();this.script="";this.pre_cmd=pre_cmd;this.post_cmd=post_cmd;for(var i=0;i<this.pre_cmd.length;i++)this.push(pre_cmd[i])};EJS.Buffer.prototype={push:function(cmd){this.line.push(cmd)},cr:function(){this.script=this.script+this.line.join("; ");this.line=new Array();this.script=this.script+"\n"},close:function(){if(this.line.length>0){for(var i=0;i<this.post_cmd.length;i++)this.push(pre_cmd[i]);this.script=this.script+this.line.join("; ");line=null}}};EJS.Compiler=function(source,left){this.pre_cmd=["var ___ViewO = [];"];this.post_cmd=new Array();this.source=" ";if(source!=null){if(typeof source=="string"){source=source.replace(/\r\n/g,"\n");source=source.replace(/\r/g,"\n");this.source=source}else if(source.innerHTML)this.source=source.innerHTML;if(typeof this.source!="string")this.source=""};left=left||"<";var right=">";switch(left){case"[":right="]";break;case"<":break;default:throw left+" is not a supported deliminator";break};this.scanner=new EJS.Scanner(this.source,left,right);this.out=""};EJS.Compiler.prototype={compile:function(options,name){options=options||{};this.out="";var put_cmd="___ViewO.push(",insert_cmd=put_cmd,buff=new EJS.Buffer(this.pre_cmd,this.post_cmd),content="",clean=function(content){content=content.replace(/\\/g,"\\\\");content=content.replace(/\n/g,"\\n");content=content.replace(/"/g,'\\"');return content};this.scanner.scan(function(token,scanner){if(scanner.stag==null){switch(token){case"\n":content=content+"\n";buff.push(put_cmd+'"'+clean(content)+'");');buff.cr();content="";break;case scanner.left_delimiter:case scanner.left_equal:case scanner.left_comment:scanner.stag=token;if(content.length>0)buff.push(put_cmd+'"'+clean(content)+'")');content="";break;case scanner.double_left:content=content+scanner.left_delimiter;break;default:content=content+token;break}}else switch(token){case scanner.right_delimiter:switch(scanner.stag){case scanner.left_delimiter:if(content[content.length-1]=="\n"){content=chop(content);buff.push(content);buff.cr()}else buff.push(content);break;case scanner.left_equal:buff.push(insert_cmd+"(EJS.Scanner.to_text("+content+")))");break};scanner.stag=null;content="";break;case scanner.double_right:content=content+scanner.right_delimiter;break;default:content=content+token;break}});if(content.length>0)buff.push(put_cmd+'"'+clean(content)+'")');buff.close();this.out=buff.script+";";var to_be_evaled="/*"+name+"*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {"+this.out+" return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};";try{eval(to_be_evaled)}catch(e){if(typeof JSLINT!="undefined"){JSLINT(this.out);for(var i=0;i<JSLINT.errors.length;i++){var error=JSLINT.errors[i];if(error.reason!="Unnecessary semicolon."){error.line++;var e=new Error();e.lineNumber=error.line;e.message=error.reason;if(options.view)e.fileName=options.view;throw e}}}else throw e}}};EJS.config=function(options){EJS.cache=options.cache!=null?options.cache:EJS.cache;EJS.type=options.type!=null?options.type:EJS.type;EJS.ext=options.ext!=null?options.ext:EJS.ext;var templates_directory=EJS.templates_directory||{};EJS.templates_directory=templates_directory;EJS.get=function(path,cache){if(cache==false)return null;if(templates_directory[path])return templates_directory[path];return null};EJS.update=function(path,template){if(path==null)return;templates_directory[path]=template};EJS.INVALID_PATH=-1};EJS.config({cache:true,type:"<",ext:".ejs"});EJS.Helpers=function(data,extras){this._data=data;this._extras=extras;extend(this,extras)};EJS.Helpers.prototype={view:function(options,data,helpers){if(!helpers)helpers=this._extras;if(!data)data=this._data;return new EJS(options).render(data,helpers)},to_text:function(input,null_text){if(input==null||input===undefined)return null_text||"";if(input instanceof Date)return input.toDateString();if(input.toString)return input.toString().replace(/\n/g,"<br />").replace(/''/g,"'");return""}};EJS.newRequest=function(){var factories=[function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var i=0;i<factories.length;i++)try{var request=factories[i]();if(request!=null)return request}catch(e){continue}};EJS.request=function(path){var request=new EJS.newRequest();request.open("GET",path,false);try{request.send(null)}catch(e){return null};if(request.status==404||request.status==2||(request.status==0&&request.responseText==""))return null;return request.responseText};EJS.ajax_request=function(params){params.method=(params.method?params.method:"GET");var request=new EJS.newRequest();request.onreadystatechange=function(){if(request.readyState==4)if(request.status==200){params.onComplete(request)}else params.onComplete(request)};request.open(params.method,params.url);request.send(null)}})();EJS.Helpers.prototype.date_tag=function(C,O,A){if(!(O instanceof Date))O=new Date();var B=["January","February","March","April","May","June","July","August","September","October","November","December"],G=[],D=[],P=[],J=O.getFullYear(),H=O.getMonth(),N=O.getDate();for(var M=J-15;M<J+15;M++)G.push({value:M,text:M});for(var E=0;E<12;E++)D.push({value:E,text:B[E]});for(var I=0;I<31;I++)P.push({value:(I+1),text:(I+1)});var L=this.select_tag(C+"[year]",J,G,{id:C+"[year]"}),F=this.select_tag(C+"[month]",H,D,{id:C+"[month]"}),K=this.select_tag(C+"[day]",N,P,{id:C+"[day]"});return L+F+K};EJS.Helpers.prototype.form_tag=function(B,A){A=A||{};A.action=B;if(A.multipart==true){A.method="post";A.enctype="multipart/form-data"};return this.start_tag_for("form",A)};EJS.Helpers.prototype.form_tag_end=function(){return this.tag_end("form")};EJS.Helpers.prototype.hidden_field_tag=function(A,C,B){return this.input_field_tag(A,C,"hidden",B)};EJS.Helpers.prototype.input_field_tag=function(A,D,C,B){B=B||{};B.id=B.id||A;B.value=D||"";B.type=C||"text";B.name=A;return this.single_tag_for("input",B)};EJS.Helpers.prototype.is_current_page=function(A){return(window.location.href==A||window.location.pathname==A?true:false)};EJS.Helpers.prototype.link_to=function(B,A,C){if(!B)var B="null";if(!C)var C={};if(C.confirm){C.onclick=' var ret_confirm = confirm("'+C.confirm+'"); if(!ret_confirm){ return false;} ';C.confirm=null};C.href=A;return this.start_tag_for("a",C)+B+this.tag_end("a")};EJS.Helpers.prototype.submit_link_to=function(B,A,C){if(!B)var B="null";if(!C)var C={};C.onclick=C.onclick||"";if(C.confirm){C.onclick=' var ret_confirm = confirm("'+C.confirm+'"); if(!ret_confirm){ return false;} ';C.confirm=null};C.value=B;C.type="submit";C.onclick=C.onclick+(A?this.url_for(A):"")+"return false;";return this.start_tag_for("input",C)};EJS.Helpers.prototype.link_to_if=function(F,B,A,D,C,E){return this.link_to_unless((F==false),B,A,D,C,E)};EJS.Helpers.prototype.link_to_unless=function(E,B,A,C,D){C=C||{};if(E){if(D&&typeof D=="function"){return D(B,A,C,D)}else return B}else return this.link_to(B,A,C)};EJS.Helpers.prototype.link_to_unless_current=function(B,A,C,D){C=C||{};return this.link_to_unless(this.is_current_page(A),B,A,C,D)};EJS.Helpers.prototype.password_field_tag=function(A,C,B){return this.input_field_tag(A,C,"password",B)};EJS.Helpers.prototype.select_tag=function(D,G,H,F){F=F||{};F.id=F.id||D;F.value=G;F.name=D;var B="";B+=this.start_tag_for("select",F);for(var E=0;E<H.length;E++){var C=H[E],A={value:C.value};if(C.value==G)A.selected="selected";B+=this.start_tag_for("option",A)+C.text+this.tag_end("option")};B+=this.tag_end("select");return B};EJS.Helpers.prototype.single_tag_for=function(A,B){return this.tag(A,B,"/>")};EJS.Helpers.prototype.start_tag_for=function(A,B){return this.tag(A,B)};EJS.Helpers.prototype.submit_tag=function(A,B){B=B||{};B.type=B.type||"submit";B.value=A||"Submit";return this.single_tag_for("input",B)};EJS.Helpers.prototype.tag=function(C,E,D){if(!D)var D=">";var B=" ";for(var A in E){if(E[A]!=null){var F=E[A].toString()}else var F="";if(A=="Class")A="class";if(F.indexOf("'")!=-1){B+=A+'="'+F+'" '}else B+=A+"='"+F+"' "};return"<"+C+B+D};EJS.Helpers.prototype.tag_end=function(A){return"</"+A+">"};EJS.Helpers.prototype.text_area_tag=function(A,C,B){B=B||{};B.id=B.id||A;B.name=B.name||A;C=C||"";if(B.size){B.cols=B.size.split("x")[0];B.rows=B.size.split("x")[1];delete B.size};B.cols=B.cols||50;B.rows=B.rows||4;return this.start_tag_for("textarea",B)+C+this.tag_end("textarea")};EJS.Helpers.prototype.text_tag=EJS.Helpers.prototype.text_area_tag;EJS.Helpers.prototype.text_field_tag=function(A,C,B){return this.input_field_tag(A,C,"text",B)};EJS.Helpers.prototype.url_for=function(A){return'window.location="'+A+'";'};EJS.Helpers.prototype.img_tag=function(B,C,A){A=A||{};A.src=B;A.alt=C;return this.single_tag_for("img",A)}
;
EJS.Helpers.prototype.date_tag=function(name,value,html_options){if(!(value instanceof Date))value=new Date();var month_names=["January","February","March","April","May","June","July","August","September","October","November","December"],years=[],months=[],days=[],year=value.getFullYear(),month=value.getMonth(),day=value.getDate();for(var y=year-15;y<year+15;y++)years.push({value:y,text:y});for(var m=0;m<12;m++)months.push({value:m,text:month_names[m]});for(var d=0;d<31;d++)days.push({value:(d+1),text:(d+1)});var year_select=this.select_tag(name+'[year]',year,years,{id:name+'[year]'}),month_select=this.select_tag(name+'[month]',month,months,{id:name+'[month]'}),day_select=this.select_tag(name+'[day]',day,days,{id:name+'[day]'});return year_select+month_select+day_select};EJS.Helpers.prototype.form_tag=function(action,html_options){html_options=html_options||{};html_options.action=action;if(html_options.multipart==true){html_options.method='post';html_options.enctype='multipart/form-data'};return this.start_tag_for('form',html_options)};EJS.Helpers.prototype.form_tag_end=function(){return this.tag_end('form')};EJS.Helpers.prototype.hidden_field_tag=function(name,value,html_options){return this.input_field_tag(name,value,'hidden',html_options)};EJS.Helpers.prototype.input_field_tag=function(name,value,inputType,html_options){html_options=html_options||{};html_options.id=html_options.id||name;html_options.value=value||'';html_options.type=inputType||'text';html_options.name=name;return this.single_tag_for('input',html_options)};EJS.Helpers.prototype.is_current_page=function(url){return(window.location.href==url||window.location.pathname==url?true:false)};EJS.Helpers.prototype.link_to=function(name,url,html_options){if(!name)var name='null';if(!html_options)var html_options={};if(html_options.confirm){html_options.onclick=" var ret_confirm = confirm(\""+html_options.confirm+"\"); if(!ret_confirm){ return false;} ";html_options.confirm=null};html_options.href=url;return this.start_tag_for('a',html_options)+name+this.tag_end('a')};EJS.Helpers.prototype.submit_link_to=function(name,url,html_options){if(!name)var name='null';if(!html_options)var html_options={};html_options.onclick=html_options.onclick||'';if(html_options.confirm){html_options.onclick=" var ret_confirm = confirm(\""+html_options.confirm+"\"); if(!ret_confirm){ return false;} ";html_options.confirm=null};html_options.value=name;html_options.type='submit';html_options.onclick=html_options.onclick+(url?this.url_for(url):'')+'return false;';return this.start_tag_for('input',html_options)};EJS.Helpers.prototype.link_to_if=function(condition,name,url,html_options,post,block){return this.link_to_unless((condition==false),name,url,html_options,post,block)};EJS.Helpers.prototype.link_to_unless=function(condition,name,url,html_options,block){html_options=html_options||{};if(condition){if(block&&typeof block=='function'){return block(name,url,html_options,block)}else return name}else return this.link_to(name,url,html_options)};EJS.Helpers.prototype.link_to_unless_current=function(name,url,html_options,block){html_options=html_options||{};return this.link_to_unless(this.is_current_page(url),name,url,html_options,block)};EJS.Helpers.prototype.password_field_tag=function(name,value,html_options){return this.input_field_tag(name,value,'password',html_options)};EJS.Helpers.prototype.select_tag=function(name,value,choices,html_options){html_options=html_options||{};html_options.id=html_options.id||name;html_options.name=name;var txt='';txt+=this.start_tag_for('select',html_options);for(var i=0;i<choices.length;i++){var choice=choices[i],optionOptions={value:choice.value};if(choice.value==value)optionOptions.selected='selected';txt+=this.start_tag_for('option',optionOptions)+choice.text+this.tag_end('option')};txt+=this.tag_end('select');return txt};EJS.Helpers.prototype.single_tag_for=function(tag,html_options){return this.tag(tag,html_options,'/>')};EJS.Helpers.prototype.start_tag_for=function(tag,html_options){return this.tag(tag,html_options)};EJS.Helpers.prototype.submit_tag=function(name,html_options){html_options=html_options||{};html_options.type=html_options.type||'submit';html_options.value=name||'Submit';return this.single_tag_for('input',html_options)};EJS.Helpers.prototype.tag=function(tag,html_options,end){if(!end)var end='>';var txt=' ';for(var attr in html_options){if(html_options[attr]!=null){var value=html_options[attr].toString()}else var value='';if(attr=="Class")attr="class";if(value.indexOf("'")!=-1){txt+=attr+'=\"'+value+'\" '}else txt+=attr+"='"+value+"' "};return'<'+tag+txt+end};EJS.Helpers.prototype.tag_end=function(tag){return'</'+tag+'>'};EJS.Helpers.prototype.text_area_tag=function(name,value,html_options){html_options=html_options||{};html_options.id=html_options.id||name;html_options.name=html_options.name||name;value=value||'';if(html_options.size){html_options.cols=html_options.size.split('x')[0];html_options.rows=html_options.size.split('x')[1];delete html_options.size};html_options.cols=html_options.cols||50;html_options.rows=html_options.rows||4;return this.start_tag_for('textarea',html_options)+value+this.tag_end('textarea')};EJS.Helpers.prototype.text_tag=EJS.Helpers.prototype.text_area_tag;EJS.Helpers.prototype.text_field_tag=function(name,value,html_options){return this.input_field_tag(name,value,'text',html_options)};EJS.Helpers.prototype.url_for=function(url){return'window.location="'+url+'";'};EJS.Helpers.prototype.img_tag=function(image_location,alt,options){options=options||{};options.src=image_location;options.alt=alt;return this.single_tag_for('img',options)}
;
/*! nanoScrollerJS - v0.8.7 - (c) 2015 James Florentino; Licensed MIT */

!function(a){return"function"==typeof define&&define.amd?define(["jquery"],function(b){return a(b,window,document)}):"object"==typeof exports?module.exports=a(require("jquery"),window,document):a(jQuery,window,document)}(function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;z={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},u="scrollbar",t="scroll",l="mousedown",m="mouseenter",n="mousemove",p="mousewheel",o="mouseup",s="resize",h="drag",i="enter",w="up",r="panedown",f="DOMMouseScroll",g="down",x="wheel",j="keydown",k="keyup",v="touchmove",d="Microsoft Internet Explorer"===b.navigator.appName&&/msie 7./i.test(b.navigator.appVersion)&&b.ActiveXObject,e=null,D=b.requestAnimationFrame,y=b.cancelAnimationFrame,F=c.createElement("div").style,H=function(){var a,b,c,d,e,f;for(d=["t","webkitT","MozT","msT","OT"],a=e=0,f=d.length;f>e;a=++e)if(c=d[a],b=d[a]+"ransform",b in F)return d[a].substr(0,d[a].length-1);return!1}(),G=function(a){return H===!1?!1:""===H?a:H+a.charAt(0).toUpperCase()+a.substr(1)},E=G("transform"),B=E!==!1,A=function(){var a,b,d;return a=c.createElement("div"),b=a.style,b.position="absolute",b.width="100px",b.height="100px",b.overflow=t,b.top="-9999px",c.body.appendChild(a),d=a.offsetWidth-a.clientWidth,c.body.removeChild(a),d},C=function(){var a,c,d;return c=b.navigator.userAgent,(a=/(?=.+Mac OS X)(?=.+Firefox)/.test(c))?(d=/Firefox\/\d{2}\./.exec(c),d&&(d=d[0].replace(/\D+/g,"")),a&&+d>23):!1},q=function(){function j(d,f){this.el=d,this.options=f,e||(e=A()),this.$el=a(this.el),this.doc=a(this.options.documentContext||c),this.win=a(this.options.windowContext||b),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return j.prototype.preventScrolling=function(a,b){if(this.isActive)if(a.type===f)(b===g&&a.originalEvent.detail>0||b===w&&a.originalEvent.detail<0)&&a.preventDefault();else if(a.type===p){if(!a.originalEvent||!a.originalEvent.wheelDelta)return;(b===g&&a.originalEvent.wheelDelta<0||b===w&&a.originalEvent.wheelDelta>0)&&a.preventDefault()}},j.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},j.prototype.updateScrollValues=function(){var a,b;a=this.content,this.maxScrollTop=a.scrollHeight-a.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=a.scrollTop,b=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==b&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:b}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},j.prototype.setOnScrollStyles=function(){var a;B?(a={},a[E]="translate(0, "+this.sliderTop+"px)"):a={top:this.sliderTop},D?(y&&this.scrollRAF&&y(this.scrollRAF),this.scrollRAF=D(function(b){return function(){return b.scrollRAF=null,b.slider.css(a)}}(this))):this.slider.css(a)},j.prototype.createEvents=function(){this.events={down:function(a){return function(b){return a.isBeingDragged=!0,a.offsetY=b.pageY-a.slider.offset().top,a.slider.is(b.target)||(a.offsetY=0),a.pane.addClass(a.options.activeClass),a.doc.bind(n,a.events[h]).bind(o,a.events[w]),a.body.bind(m,a.events[i]),!1}}(this),drag:function(a){return function(b){return a.sliderY=b.pageY-a.$el.offset().top-a.paneTop-(a.offsetY||.5*a.sliderHeight),a.scroll(),a.contentScrollTop>=a.maxScrollTop&&a.prevScrollTop!==a.maxScrollTop?a.$el.trigger("scrollend"):0===a.contentScrollTop&&0!==a.prevScrollTop&&a.$el.trigger("scrolltop"),!1}}(this),up:function(a){return function(b){return a.isBeingDragged=!1,a.pane.removeClass(a.options.activeClass),a.doc.unbind(n,a.events[h]).unbind(o,a.events[w]),a.body.unbind(m,a.events[i]),!1}}(this),resize:function(a){return function(b){a.reset()}}(this),panedown:function(a){return function(b){return a.sliderY=(b.offsetY||b.originalEvent.layerY)-.5*a.sliderHeight,a.scroll(),a.events.down(b),!1}}(this),scroll:function(a){return function(b){a.updateScrollValues(),a.isBeingDragged||(a.iOSNativeScrolling||(a.sliderY=a.sliderTop,a.setOnScrollStyles()),null!=b&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(b,g),a.prevScrollTop!==a.maxScrollTop&&a.$el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(b,w),0!==a.prevScrollTop&&a.$el.trigger("scrolltop"))))}}(this),wheel:function(a){return function(b){var c;if(null!=b)return c=b.delta||b.wheelDelta||b.originalEvent&&b.originalEvent.wheelDelta||-b.detail||b.originalEvent&&-b.originalEvent.detail,c&&(a.sliderY+=-c/3),a.scroll(),!1}}(this),enter:function(a){return function(b){var c;if(a.isBeingDragged)return 1!==(b.buttons||b.which)?(c=a.events)[w].apply(c,arguments):void 0}}(this)}},j.prototype.addEvents=function(){var a;this.removeEvents(),a=this.events,this.options.disableResize||this.win.bind(s,a[s]),this.iOSNativeScrolling||(this.slider.bind(l,a[g]),this.pane.bind(l,a[r]).bind(""+p+" "+f,a[x])),this.$content.bind(""+t+" "+p+" "+f+" "+v,a[t])},j.prototype.removeEvents=function(){var a;a=this.events,this.win.unbind(s,a[s]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+t+" "+p+" "+f+" "+v,a[t])},j.prototype.generate=function(){var a,c,d,f,g,h,i;return f=this.options,h=f.paneClass,i=f.sliderClass,a=f.contentClass,(g=this.$el.children("."+h)).length||g.children("."+i).length||this.$el.append('<div class="'+h+'"><div class="'+i+'" /></div>'),this.pane=this.$el.children("."+h),this.slider=this.pane.find("."+i),0===e&&C()?(d=b.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),c={right:-14,paddingRight:+d+14}):e&&(c={right:-e},this.$el.addClass(f.enabledClass)),null!=c&&this.$content.css(c),this},j.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},j.prototype.reset=function(){var a,b,c,f,g,h,i,j,k,l,m,n;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),a=this.content,f=a.style,g=f.overflowY,d&&this.$content.css({height:this.$content.height()}),b=a.scrollHeight+e,l=parseInt(this.$el.css("max-height"),10),l>0&&(this.$el.height(""),this.$el.height(a.scrollHeight>l?l:a.scrollHeight)),i=this.pane.outerHeight(!1),k=parseInt(this.pane.css("top"),10),h=parseInt(this.pane.css("bottom"),10),j=i+k+h,n=Math.round(j/b*i),n<this.options.sliderMinHeight?n=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&n>this.options.sliderMaxHeight&&(n=this.options.sliderMaxHeight),g===t&&f.overflowX!==t&&(n+=e),this.maxSliderTop=j-n,this.contentHeight=b,this.paneHeight=i,this.paneOuterHeight=j,this.sliderHeight=n,this.paneTop=k,this.slider.height(n),this.events.scroll(),this.pane.show(),this.isActive=!0,a.scrollHeight===a.clientHeight||this.pane.outerHeight(!0)>=a.scrollHeight&&g!==t?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===a.scrollHeight&&g===t?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),c=this.$content.css("position"),("static"===c||"relative"===c)&&(m=parseInt(this.$content.css("right"),10),m&&this.$content.css({right:"",marginRight:m})),this)},j.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},j.prototype.scrollBottom=function(a){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-a).trigger(p),this.stop().restore(),this):void 0},j.prototype.scrollTop=function(a){return this.isActive?(this.$content.scrollTop(+a).trigger(p),this.stop().restore(),this):void 0},j.prototype.scrollTo=function(a){return this.isActive?(this.scrollTop(this.$el.find(a).get(0).offsetTop),this):void 0},j.prototype.stop=function(){return y&&this.scrollRAF&&(y(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},j.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),d&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},j.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout(function(a){return function(){a.pane.removeClass(a.options.flashedClass)}}(this),this.options.flashDelay),this):void 0},j}(),a.fn.nanoScroller=function(b){return this.each(function(){var c,d;if((d=this.nanoscroller)||(c=a.extend({},z,b),this.nanoscroller=d=new q(this,c)),b&&"object"==typeof b){if(a.extend(d.options,b),null!=b.scrollBottom)return d.scrollBottom(b.scrollBottom);if(null!=b.scrollTop)return d.scrollTop(b.scrollTop);if(b.scrollTo)return d.scrollTo(b.scrollTo);if("bottom"===b.scroll)return d.scrollBottom(0);if("top"===b.scroll)return d.scrollTop(0);if(b.scroll&&b.scroll instanceof a)return d.scrollTo(b.scroll);if(b.stop)return d.stop();if(b.destroy)return d.destroy();if(b.flash)return d.flash()}return d.reset()})},a.fn.nanoScroller.Constructor=q});
//# sourceMappingURL=jquery.nanoscroller.min.js.map
;
/*!
* jquery.inputmask.bundle.js
* http://github.com/RobinHerbots/jquery.inputmask
* Copyright (c) 2010 - 2015 Robin Herbots
* Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
* Version: 3.2.6-11
*/
!function(a){function b(c,d){return this instanceof b?(a.isPlainObject(c)?d=c:(d=d||{},d.alias=c),this.el=void 0,this.opts=a.extend(!0,{},this.defaults,d),this.noMasksCache=d&&void 0!==d.definitions,this.userOptions=d||{},void e(this.opts.alias,d,this.opts)):new b(c,d)}function c(a){var b=document.createElement("input"),c="on"+a,d=c in b;return d||(b.setAttribute(c,"return;"),d="function"==typeof b[c]),b=null,d}function d(a){var b="text"===a||"tel"===a||"password"===a;if(!b){var c=document.createElement("input");c.setAttribute("type",a),b="text"===c.type,c=null}return b}function e(b,c,d){var f=d.aliases[b];return f?(f.alias&&e(f.alias,void 0,d),a.extend(!0,d,f),a.extend(!0,d,c),!0):(null===d.mask&&(d.mask=b),!1)}function f(b,c,d){function f(a,c){c=void 0!==c?c:b.getAttribute("data-inputmask-"+a),null!==c&&("string"==typeof c&&(0===a.indexOf("on")?c=window[c]:"false"===c?c=!1:"true"===c&&(c=!0)),d[a]=c)}var g,h,i,j,k=b.getAttribute("data-inputmask");if(k&&""!==k&&(k=k.replace(new RegExp("'","g"),'"'),h=JSON.parse("{"+k+"}")),h){i=void 0;for(j in h)if("alias"===j.toLowerCase()){i=h[j];break}}f("alias",i),d.alias&&e(d.alias,d,c);for(g in c){if(h){i=void 0;for(j in h)if(j.toLowerCase()===g.toLowerCase()){i=h[j];break}}f(g,i)}return a.extend(!0,c,d),c}function g(c,d){function e(b){function d(a,b,c,d){this.matches=[],this.isGroup=a||!1,this.isOptional=b||!1,this.isQuantifier=c||!1,this.isAlternator=d||!1,this.quantifier={min:1,max:1}}function e(b,d,e){var f=c.definitions[d];e=void 0!==e?e:b.matches.length;var g=b.matches[e-1];if(f&&!r){f.placeholder=a.isFunction(f.placeholder)?f.placeholder(c):f.placeholder;for(var h=f.prevalidator,i=h?h.length:0,j=1;j<f.cardinality;j++){var k=i>=j?h[j-1]:[],l=k.validator,m=k.cardinality;b.matches.splice(e++,0,{fn:l?"string"==typeof l?new RegExp(l):new function(){this.test=l}:new RegExp("."),cardinality:m?m:1,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==(f.definitionSymbol||d),casing:f.casing,def:f.definitionSymbol||d,placeholder:f.placeholder,mask:d}),g=b.matches[e-1]}b.matches.splice(e++,0,{fn:f.validator?"string"==typeof f.validator?new RegExp(f.validator):new function(){this.test=f.validator}:new RegExp("."),cardinality:f.cardinality,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==(f.definitionSymbol||d),casing:f.casing,def:f.definitionSymbol||d,placeholder:f.placeholder,mask:d})}else b.matches.splice(e++,0,{fn:null,cardinality:0,optionality:b.isOptional,newBlockMarker:void 0===g||g.def!==d,casing:null,def:c.staticDefinitionSymbol||d,placeholder:void 0!==c.staticDefinitionSymbol?d:void 0,mask:d}),r=!1}function f(a,b){a.isGroup&&(a.isGroup=!1,e(a,c.groupmarker.start,0),b!==!0&&e(a,c.groupmarker.end))}function g(a,b,c,d){b.matches.length>0&&(void 0===d||d)&&(c=b.matches[b.matches.length-1],f(c)),e(b,a)}function h(){if(t.length>0){if(m=t[t.length-1],g(k,m,o,!m.isAlternator),m.isAlternator){n=t.pop();for(var a=0;a<n.matches.length;a++)n.matches[a].isGroup=!1;t.length>0?(m=t[t.length-1],m.matches.push(n)):s.matches.push(n)}}else g(k,s,o)}function i(a){function b(a){return a===c.optionalmarker.start?a=c.optionalmarker.end:a===c.optionalmarker.end?a=c.optionalmarker.start:a===c.groupmarker.start?a=c.groupmarker.end:a===c.groupmarker.end&&(a=c.groupmarker.start),a}a.matches=a.matches.reverse();for(var d in a.matches){var e=parseInt(d);if(a.matches[d].isQuantifier&&a.matches[e+1]&&a.matches[e+1].isGroup){var f=a.matches[d];a.matches.splice(d,1),a.matches.splice(e+1,0,f)}void 0!==a.matches[d].matches?a.matches[d]=i(a.matches[d]):a.matches[d]=b(a.matches[d])}return a}for(var j,k,l,m,n,o,p,q=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,r=!1,s=new d,t=[],u=[];j=q.exec(b);)if(k=j[0],r)h();else switch(k.charAt(0)){case c.escapeChar:r=!0;break;case c.optionalmarker.end:case c.groupmarker.end:if(l=t.pop(),void 0!==l)if(t.length>0){if(m=t[t.length-1],m.matches.push(l),m.isAlternator){n=t.pop();for(var v=0;v<n.matches.length;v++)n.matches[v].isGroup=!1;t.length>0?(m=t[t.length-1],m.matches.push(n)):s.matches.push(n)}}else s.matches.push(l);else h();break;case c.optionalmarker.start:t.push(new d(!1,!0));break;case c.groupmarker.start:t.push(new d(!0));break;case c.quantifiermarker.start:var w=new d(!1,!1,!0);k=k.replace(/[{}]/g,"");var x=k.split(","),y=isNaN(x[0])?x[0]:parseInt(x[0]),z=1===x.length?y:isNaN(x[1])?x[1]:parseInt(x[1]);if(("*"===z||"+"===z)&&(y="*"===z?0:1),w.quantifier={min:y,max:z},t.length>0){var A=t[t.length-1].matches;j=A.pop(),j.isGroup||(p=new d(!0),p.matches.push(j),j=p),A.push(j),A.push(w)}else j=s.matches.pop(),j.isGroup||(p=new d(!0),p.matches.push(j),j=p),s.matches.push(j),s.matches.push(w);break;case c.alternatormarker:t.length>0?(m=t[t.length-1],o=m.matches.pop()):o=s.matches.pop(),o.isAlternator?t.push(o):(n=new d(!1,!1,!1,!0),n.matches.push(o),t.push(n));break;default:h()}for(;t.length>0;)l=t.pop(),f(l,!0),s.matches.push(l);return s.matches.length>0&&(o=s.matches[s.matches.length-1],f(o),u.push(s)),c.numericInput&&i(u[0]),u}function f(f,g){if(null===f||""===f)return void 0;if(1===f.length&&c.greedy===!1&&0!==c.repeat&&(c.placeholder=""),c.repeat>0||"*"===c.repeat||"+"===c.repeat){var h="*"===c.repeat?0:"+"===c.repeat?1:c.repeat;f=c.groupmarker.start+f+c.groupmarker.end+c.quantifiermarker.start+h+","+c.repeat+c.quantifiermarker.end}var i;return void 0===b.prototype.masksCache[f]||d===!0?(i={mask:f,maskToken:e(f),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:g},d!==!0&&(b.prototype.masksCache[c.numericInput?f.split("").reverse().join(""):f]=i,i=a.extend(!0,{},b.prototype.masksCache[c.numericInput?f.split("").reverse().join(""):f]))):i=a.extend(!0,{},b.prototype.masksCache[c.numericInput?f.split("").reverse().join(""):f]),i}function g(a){return a=a.toString()}var h;if(a.isFunction(c.mask)&&(c.mask=c.mask(c)),a.isArray(c.mask)){if(c.mask.length>1){c.keepStatic=null===c.keepStatic?!0:c.keepStatic;var i="(";return a.each(c.numericInput?c.mask.reverse():c.mask,function(b,c){i.length>1&&(i+=")|("),i+=g(void 0===c.mask||a.isFunction(c.mask)?c:c.mask)}),i+=")",f(i,c.mask)}c.mask=c.mask.pop()}return c.mask&&(h=void 0===c.mask.mask||a.isFunction(c.mask.mask)?f(g(c.mask),c.mask):f(g(c.mask.mask),c.mask)),h}function h(e,f,g){function i(a,b,c){b=b||0;var d,e,f,g=[],h=0;do{if(a===!0&&p().validPositions[h]){var i=p().validPositions[h];e=i.match,d=i.locator.slice(),g.push(c===!0?i.input:L(h,e))}else f=u(h,d,h-1),e=f.match,d=f.locator.slice(),g.push(L(h,e));h++}while((void 0===ra||ra>h-1)&&null!==e.fn||null===e.fn&&""!==e.def||b>=h);return g.pop(),g}function p(){return f}function q(a){var b=p();b.buffer=void 0,a!==!0&&(b.tests={},b._buffer=void 0,b.validPositions={},b.p=0)}function r(a,b){var c=p(),d=-1,e=c.validPositions;void 0===a&&(a=-1);var f=d,g=d;for(var h in e){var i=parseInt(h);e[i]&&(b||null!==e[i].match.fn)&&(a>=i&&(f=i),i>=a&&(g=i))}return d=-1!==f&&a-f>1||a>g?f:g}function s(b,c,d){if(g.insertMode&&void 0!==p().validPositions[b]&&void 0===d){var e,f=a.extend(!0,{},p().validPositions),h=r();for(e=b;h>=e;e++)delete p().validPositions[e];p().validPositions[b]=c;var i,j=!0,k=p().validPositions;for(e=i=b;h>=e;e++){var l=f[e];if(void 0!==l)for(var m=i,n=-1;m<G()&&(null==l.match.fn&&k[e]&&(k[e].match.optionalQuantifier===!0||k[e].match.optionality===!0)||null!=l.match.fn);){if(null===l.match.fn||!g.keepStatic&&k[e]&&(void 0!==k[e+1]&&y(e+1,k[e].locator.slice(),e).length>1||void 0!==k[e].alternation)?m++:m=H(i),w(m,l.match.def)){j=E(m,l.input,!0,!0)!==!1,i=m;break}if(j=null==l.match.fn,n===m)break;n=m}if(!j)break}if(!j)return p().validPositions=a.extend(!0,{},f),q(!0),!1}else p().validPositions[b]=c;return q(!0),!0}function t(a,b,c,d){var e,f=a;for(p().p=a,e=f;b>e;e++)void 0!==p().validPositions[e]&&(c===!0||g.canClearPosition(p(),e,r(),d,g)!==!1)&&delete p().validPositions[e];for(e=f+1;e<=r();){for(;void 0!==p().validPositions[f];)f++;var h=p().validPositions[f];if(f>e&&(e=f+1),void 0===p().validPositions[e]&&F(e)||void 0!==h)e++;else{var i=u(e);w(f,i.match.def)?E(f,i.input||L(e),!0)!==!1&&(delete p().validPositions[e],e++):F(e)||(e++,f--),f++}}var j=r(),k=G();for(d!==!0&&c!==!0&&void 0!==p().validPositions[j]&&p().validPositions[j].input===g.radixPoint&&delete p().validPositions[j],e=j+1;k>=e;e++)p().validPositions[e]&&delete p().validPositions[e];q(!0)}function u(a,b,c){var d=p().validPositions[a];if(void 0===d)for(var e=y(a,b,c),f=r(),h=p().validPositions[f]||y(0)[0],i=void 0!==h.alternation?h.locator[h.alternation].toString().split(","):[],j=0;j<e.length&&(d=e[j],!(d.match&&(g.greedy&&d.match.optionalQuantifier!==!0||(d.match.optionality===!1||d.match.newBlockMarker===!1)&&d.match.optionalQuantifier!==!0)&&(void 0===h.alternation||h.alternation!==d.alternation||void 0!==d.locator[h.alternation]&&D(d.locator[h.alternation].toString().split(","),i))));j++);return d}function v(a){return p().validPositions[a]?p().validPositions[a].match:y(a)[0].match}function w(a,b){for(var c=!1,d=y(a),e=0;e<d.length;e++)if(d[e].match&&d[e].match.def===b){c=!0;break}return c}function x(b,c){var d,e;return(p().tests[b]||p().validPositions[b])&&a.each(p().tests[b]||[p().validPositions[b]],function(a,b){var f=b.alternation?b.locator[b.alternation].toString().indexOf(c):-1;(void 0===e||e>f)&&-1!==f&&(d=b,e=f)}),d}function y(b,c,d,e){function f(c,d,e,i){function k(e,i,n){function o(a,b){var c=x(a,b);return c?c.locator.slice(c.alternation+1):[]}if(j>1e4)throw"Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+p().mask;if(j===b&&void 0===e.matches)return l.push({match:e,locator:i.reverse()}),!0;if(void 0!==e.matches){if(e.isGroup&&n!==e){if(e=k(c.matches[a.inArray(e,c.matches)+1],i))return!0}else if(e.isOptional){var q=e;if(e=f(e,d,i,n)){if(g=l[l.length-1].match,h=0===a.inArray(g,q.matches),!h)return!0;m=!0,j=b}}else if(e.isAlternator){var r,s=e,t=[],u=l.slice(),v=i.length,w=d.length>0?d.shift():-1;if(-1===w||"string"==typeof w){var y,z=j,A=d.slice(),B=[];if("string"==typeof w)B=w.split(",");else for(y=0;y<s.matches.length;y++)B.push(y);for(var C=0;C<B.length;C++){if(y=parseInt(B[C]),l=[],d=o(j,y),e=k(s.matches[y]||c.matches[y],[y].concat(i),n)||e,e!==!0&&void 0!==e&&B[B.length-1]<s.matches.length){var D=c.matches.indexOf(e)+1;c.matches.length>D&&(e=k(c.matches[D],[D].concat(i.slice(1,i.length)),n),e&&(B.push(D.toString()),a.each(l,function(a,b){b.alternation=i.length-1})))}r=l.slice(),j=z,l=[];for(var E=0;E<A.length;E++)d[E]=A[E];for(var F=0;F<r.length;F++){var G=r[F];G.alternation=G.alternation||v;for(var H=0;H<t.length;H++){var I=t[H];if(G.match.def===I.match.def&&("string"!=typeof w||-1!==a.inArray(G.locator[G.alternation].toString(),B))){G.match.mask===I.match.mask&&(r.splice(F,1),F--),-1===I.locator[G.alternation].toString().indexOf(G.locator[G.alternation])&&(I.locator[G.alternation]=I.locator[G.alternation]+","+G.locator[G.alternation],I.alternation=G.alternation);break}}}t=t.concat(r)}"string"==typeof w&&(t=a.map(t,function(b,c){if(isFinite(c)){var d,e=b.alternation,f=b.locator[e].toString().split(",");b.locator[e]=void 0,b.alternation=void 0;for(var g=0;g<f.length;g++)d=-1!==a.inArray(f[g],B),d&&(void 0!==b.locator[e]?(b.locator[e]+=",",b.locator[e]+=f[g]):b.locator[e]=parseInt(f[g]),b.alternation=e);if(void 0!==b.locator[e])return b}})),l=u.concat(t),j=b,m=l.length>0}else e=k(s.matches[w]||c.matches[w],[w].concat(i),n);if(e)return!0}else if(e.isQuantifier&&n!==c.matches[a.inArray(e,c.matches)-1])for(var J=e,K=d.length>0?d.shift():0;K<(isNaN(J.quantifier.max)?K+1:J.quantifier.max)&&b>=j;K++){var L=c.matches[a.inArray(J,c.matches)-1];if(e=k(L,[K].concat(i),L)){if(g=l[l.length-1].match,g.optionalQuantifier=K>J.quantifier.min-1,h=0===a.inArray(g,L.matches)){if(K>J.quantifier.min-1){m=!0,j=b;break}return!0}return!0}}else if(e=f(e,d,i,n))return!0}else j++}for(var n=d.length>0?d.shift():0;n<c.matches.length;n++)if(c.matches[n].isQuantifier!==!0){var o=k(c.matches[n],[n].concat(e),i);if(o&&j===b)return o;if(j>b)break}}var g,h,i=p().maskToken,j=c?d:0,k=c||[0],l=[],m=!1;if(b>-1){if(e===!0&&p().tests[b])return p().tests[b];if(void 0===c){for(var n,o=b-1;void 0===(n=p().validPositions[o])&&o>-1&&(!p().tests[o]||void 0===(n=p().tests[o][0]));)o--;void 0!==n&&o>-1&&(j=o,k=n.locator.slice())}for(var q=k.shift();q<i.length;q++){var r=f(i[q],k,[q]);if(r&&j===b||j>b)break}}return(0===l.length||m)&&l.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:""},locator:[]}),p().tests[b]=a.extend(!0,[],l),p().tests[b]}function z(){return void 0===p()._buffer&&(p()._buffer=i(!1,1)),p()._buffer}function A(a){if(void 0===p().buffer||a===!0){if(a===!0)for(var b in p().tests)void 0===p().validPositions[b]&&delete p().tests[b];p().buffer=i(!0,r(),!0)}return p().buffer}function B(a,b,c){var d;if(c=c,a===!0)q(),a=0,b=c.length;else for(d=a;b>d;d++)delete p().validPositions[d],delete p().tests[d];for(d=a;b>d;d++)q(!0),c[d]!==g.skipOptionalPartCharacter&&E(d,c[d],!0,!0)}function C(a,b){switch(b.casing){case"upper":a=a.toUpperCase();break;case"lower":a=a.toLowerCase()}return a}function D(b,c){for(var d=g.greedy?c:c.slice(0,1),e=!1,f=0;f<b.length;f++)if(-1!==a.inArray(b[f],d)){e=!0;break}return e}function E(b,c,d,e){function f(b,c,d,e){var f=!1;return a.each(y(b),function(h,i){for(var j=i.match,k=c?1:0,l="",m=j.cardinality;m>k;m--)l+=J(b-(m-1));if(c&&(l+=c),A(!0),f=null!=j.fn?j.fn.test(l,p(),b,d,g):c!==j.def&&c!==g.skipOptionalPartCharacter||""===j.def?!1:{c:j.placeholder||j.def,pos:b},f!==!1){var n=void 0!==f.c?f.c:c;n=n===g.skipOptionalPartCharacter&&null===j.fn?j.placeholder||j.def:n;var o=b,u=A();if(void 0!==f.remove&&(a.isArray(f.remove)||(f.remove=[f.remove]),a.each(f.remove.sort(function(a,b){return b-a}),function(a,b){t(b,b+1,!0)})),void 0!==f.insert&&(a.isArray(f.insert)||(f.insert=[f.insert]),a.each(f.insert.sort(function(a,b){return a-b}),function(a,b){E(b.pos,b.c,!0)})),f.refreshFromBuffer){var v=f.refreshFromBuffer;if(d=!0,B(v===!0?v:v.start,v.end,u),void 0===f.pos&&void 0===f.c)return f.pos=r(),!1;if(o=void 0!==f.pos?f.pos:b,o!==b)return f=a.extend(f,E(o,n,!0)),!1}else if(f!==!0&&void 0!==f.pos&&f.pos!==b&&(o=f.pos,B(b,o,A().slice()),o!==b))return f=a.extend(f,E(o,n,!0)),!1;return f!==!0&&void 0===f.pos&&void 0===f.c?!1:(h>0&&q(!0),s(o,a.extend({},i,{input:C(n,j)}),e)||(f=!1),!1)}}),f}function h(b,c,d,e){for(var f,h,i,j,k,l,m=a.extend(!0,{},p().validPositions),n=a.extend(!0,{},p().tests),o=r();o>=0&&(j=p().validPositions[o],!j||void 0===j.alternation||(f=o,h=p().validPositions[f].alternation,u(f).locator[j.alternation]===j.locator[j.alternation]));o--);if(void 0!==h){f=parseInt(f);for(var s in p().validPositions)if(s=parseInt(s),j=p().validPositions[s],s>=f&&void 0!==j.alternation){var t;0===f?(t=[],a.each(p().tests[f],function(a,b){void 0!==b.locator[h]&&(t=t.concat(b.locator[h].toString().split(",")))})):t=p().validPositions[f].locator[h].toString().split(",");var v=void 0!==j.locator[h]?j.locator[h]:t[0];v.length>0&&(v=v.split(",")[0]);for(var w=0;w<t.length;w++){var y=[],z=0,A=0;if(v<t[w]){for(var B,C,D=s;D>=0;D--)if(B=p().validPositions[D],void 0!==B){var F=x(D,t[w]);p().validPositions[D].match.def!==F.match.def&&(y.push(p().validPositions[D].input),p().validPositions[D]=F,p().validPositions[D].input=L(D),null===p().validPositions[D].match.fn&&A++,B=F),C=B.locator[h],B.locator[h]=parseInt(t[w]);break}if(v!==B.locator[h]){for(k=s+1;k<r(void 0,!0)+1;k++)l=p().validPositions[k],l&&null!=l.match.fn?y.push(l.input):b>k&&z++,delete p().validPositions[k],delete p().tests[k];for(q(!0),g.keepStatic=!g.keepStatic,i=!0;y.length>0;){var G=y.shift();if(G!==g.skipOptionalPartCharacter&&!(i=E(r(void 0,!0)+1,G,!1,!0)))break}if(B.alternation=h,B.locator[h]=C,i){var H=r(b)+1;for(k=s+1;k<r()+1;k++)l=p().validPositions[k],(void 0===l||null==l.match.fn)&&b>k&&A++;b+=A-z,i=E(b>H?H:b,c,d,e)}if(g.keepStatic=!g.keepStatic,i)return i;q(),p().validPositions=a.extend(!0,{},m),p().tests=a.extend(!0,{},n)}}}break}}return!1}function i(b,c){for(var d=p().validPositions[c],e=d.locator,f=e.length,g=b;c>g;g++)if(!F(g,!0)){var h=y(g),i=h[0],j=-1;a.each(h,function(a,b){for(var c=0;f>c&&(void 0!==b.locator[c]&&D(b.locator[c].toString().split(","),e[c].toString().split(",")));c++)c>j&&(j=c,i=b)}),s(g,a.extend({},i,{input:i.match.def}),!0)}}d=d===!0;for(var j=A(),k=b-1;k>-1&&!p().validPositions[k];k--);for(k++;b>k;k++)void 0===p().validPositions[k]&&((!F(k)||j[k]!==L(k))&&y(k).length>1||j[k]===g.radixPoint||"0"===j[k]&&a.inArray(g.radixPoint,j)<k)&&f(k,j[k],!0);var l=b,m=!1,n=a.extend(!0,{},p().validPositions);if(l<G()&&(m=f(l,c,d,e),(!d||e)&&m===!1)){var o=p().validPositions[l];if(!o||null!==o.match.fn||o.match.def!==c&&c!==g.skipOptionalPartCharacter){if((g.insertMode||void 0===p().validPositions[H(l)])&&!F(l,!0))for(var v=l+1,w=H(l);w>=v;v++)if(m=f(v,c,d,e),m!==!1){i(l,v),l=v;break}}else m={caret:H(l)}}if(m===!1&&g.keepStatic&&(m=h(b,c,d,e)),m===!0&&(m={pos:l}),a.isFunction(g.postValidation)&&m!==!1&&!d){var z=g.postValidation(A(!0),g);if(z){if(z.refreshFromBuffer){var I=z.refreshFromBuffer;B(I===!0?I:I.start,I.end,z.buffer),q(!0),m=z}}else q(!0),p().validPositions=a.extend(!0,{},n),m=!1}return m}function F(a,b){var c=v(a);if(null!=c.fn)return c.fn;if(b!==!0&&a>-1&&!g.keepStatic&&void 0===p().validPositions[a]){var d=y(a,void 0,void 0,!0);return d.length>2}return!1}function G(){var a;ra=void 0!==pa?pa.maxLength:void 0,-1===ra&&(ra=void 0);var b,c=r(),d=p().validPositions[c],e=void 0!==d?d.locator.slice():void 0;for(b=c+1;void 0===d||null!==d.match.fn||null===d.match.fn&&""!==d.match.def;b++)d=u(b,e,b-1),e=d.locator.slice();var f=v(b-1);return a=""!==f.def?b:b-1,void 0===ra||ra>a?a:ra}function H(a,b){var c=G();if(a>=c)return c;for(var d=a;++d<c&&(b===!0&&(v(d).newBlockMarker!==!0||!F(d))||b!==!0&&!F(d)&&(g.nojumps!==!0||g.nojumpsThreshold>d)););return d}function I(a,b){var c=a;if(0>=c)return 0;for(;--c>0&&(b===!0&&v(c).newBlockMarker!==!0||b!==!0&&!F(c)););return c}function J(a){return void 0===p().validPositions[a]?L(a):p().validPositions[a].input}function K(b,c,d,e,f){if(e&&a.isFunction(g.onBeforeWrite)){var h=g.onBeforeWrite(e,c,d,g);if(h){if(h.refreshFromBuffer){var i=h.refreshFromBuffer;B(i===!0?i:i.start,i.end,h.buffer||c),c=A(!0)}void 0!==d&&(d=void 0!==h.caret?h.caret:d)}}b.inputmask._valueSet(c.join("")),void 0===d||void 0!==e&&"blur"===e.type||O(b,d),f===!0&&(va=!0,a(b).trigger("input"))}function L(a,b){if(b=b||v(a),void 0!==b.placeholder)return b.placeholder;if(null===b.fn){if(a>-1&&!g.keepStatic&&void 0===p().validPositions[a]){var c,d=y(a),e=0;if(d.length>2)for(var f=0;f<d.length;f++)if(d[f].match.optionality!==!0&&d[f].match.optionalQuantifier!==!0&&(null===d[f].match.fn||void 0===c||d[f].match.fn.test(c.match.def,p(),a,!0,g)!==!1)&&(e++,null===d[f].match.fn&&(c=d[f]),e>1))return g.placeholder.charAt(a%g.placeholder.length)}return b.def}return g.placeholder.charAt(a%g.placeholder.length)}function M(c,d,e,f){function h(){var a=!1,b=z().slice(k,H(k)).join("").indexOf(j);if(-1!==b&&!F(k)){a=!0;for(var c=z().slice(k,k+b),d=0;d<c.length;d++)if(" "!==c[d]){a=!1;break}}return a}var i=f.slice(),j="",k=0;if(q(),p().p=H(-1),!e)if(g.autoUnmask!==!0){var l=z().slice(0,H(-1)).join(""),m=i.join("").match(new RegExp("^"+b.escapeRegex(l),"g"));m&&m.length>0&&(i.splice(0,m.length*l.length),k=H(k))}else k=H(k);a.each(i,function(b,d){var f=a.Event("keypress");f.which=d.charCodeAt(0),j+=d;var i=r(void 0,!0),l=p().validPositions[i],m=u(i+1,l?l.locator.slice():void 0,i);if(!h()||e||g.autoUnmask){var n=e?b:null==m.match.fn&&m.match.optionality&&i+1<p().p?i+1:p().p;X.call(c,f,!0,!1,e,n),k=n+1,j=""}else X.call(c,f,!0,!1,!0,i+1)}),d&&K(c,A(),document.activeElement===c?H(r(0)):void 0,a.Event("checkval"))}function N(b){if(b&&void 0===b.inputmask)return b.value;var c=[],d=p().validPositions;for(var e in d)d[e].match&&null!=d[e].match.fn&&c.push(d[e].input);var f=0===c.length?null:(ta?c.reverse():c).join("");if(null!==f){var h=(ta?A().slice().reverse():A()).join("");a.isFunction(g.onUnMask)&&(f=g.onUnMask(h,f,g)||f)}return f}function O(a,b,c){function d(a){if(ta&&"number"==typeof a&&(!g.greedy||""!==g.placeholder)){var b=A().join("").length;a=b-a}return a}var e;if("number"!=typeof b)return a.setSelectionRange?(b=a.selectionStart,c=a.selectionEnd):window.getSelection?(e=window.getSelection().getRangeAt(0),(e.commonAncestorContainer.parentNode===a||e.commonAncestorContainer===a)&&(b=e.startOffset,c=e.endOffset)):document.selection&&document.selection.createRange&&(e=document.selection.createRange(),b=0-e.duplicate().moveStart("character",-1e5),c=b+e.text.length),{begin:d(b),end:d(c)};b=d(b),c=d(c),c="number"==typeof c?c:b;var f=parseInt(((a.ownerDocument.defaultView||window).getComputedStyle?(a.ownerDocument.defaultView||window).getComputedStyle(a,null):a.currentStyle).fontSize)*c;if(a.scrollLeft=f>a.scrollWidth?f:0,l||g.insertMode!==!1||b!==c||c++,a.setSelectionRange)a.selectionStart=b,a.selectionEnd=c;else if(window.getSelection){if(e=document.createRange(),void 0===a.firstChild){var h=document.createTextNode("");a.appendChild(h)}e.setStart(a.firstChild,b<a.inputmask._valueGet().length?b:a.inputmask._valueGet().length),e.setEnd(a.firstChild,c<a.inputmask._valueGet().length?c:a.inputmask._valueGet().length),e.collapse(!0);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else a.createTextRange&&(e=a.createTextRange(),e.collapse(!0),e.moveEnd("character",c),e.moveStart("character",b),e.select())}function P(b){var c,d,e=A(),f=e.length,g=r(),h={},i=p().validPositions[g],j=void 0!==i?i.locator.slice():void 0;for(c=g+1;c<e.length;c++)d=u(c,j,c-1),j=d.locator.slice(),h[c]=a.extend(!0,{},d);var k=i&&void 0!==i.alternation?i.locator[i.alternation]:void 0;for(c=f-1;c>g&&(d=h[c],(d.match.optionality||d.match.optionalQuantifier||k&&(k!==h[c].locator[i.alternation]&&null!=d.match.fn||null===d.match.fn&&d.locator[i.alternation]&&D(d.locator[i.alternation].toString().split(","),k.toString().split(","))&&""!==y(c)[0].def))&&e[c]===L(c,d.match));c--)f--;return b?{l:f,def:h[f]?h[f].match:void 0}:f}function Q(a){for(var b=P(),c=a.length-1;c>b&&!F(c);c--);return a.splice(b,c+1-b),a}function R(b){if(a.isFunction(g.isComplete))return g.isComplete(b,g);if("*"===g.repeat)return void 0;var c=!1,d=P(!0),e=I(d.l);if(void 0===d.def||d.def.newBlockMarker||d.def.optionality||d.def.optionalQuantifier){c=!0;for(var f=0;e>=f;f++){var h=u(f).match;if(null!==h.fn&&void 0===p().validPositions[f]&&h.optionality!==!0&&h.optionalQuantifier!==!0||null===h.fn&&b[f]!==L(f,h)){c=!1;break}}}return c}function S(a,b){return ta?a-b>1||a-b===1&&g.insertMode:b-a>1||b-a===1&&g.insertMode}function T(c){return function(d){var e=!1,f=!1;if(void 0===this.inputmask){var h=a.data(this,"_inputmask_opts");h?new b(h).mask(this):a(this).off(".inputmask")}else{if("setvalue"===d.type||!(this.disabled||this.readOnly&&!("keydown"===d.type&&d.ctrlKey&&67===d.keyCode||g.tabThrough===!1&&d.keyCode===b.keyCode.TAB))){switch(d.type){case"input":if(va===!0||e===!0)return va=!1,d.preventDefault();f=!1;break;case"keydown":ua=!1,e=!1,f=!0;break;case"keypress":if(ua===!0)return d.preventDefault();ua=!0;break;case"compositionstart":e=!0;break;case"compositionupdate":va=f;break;case"compositionend":e=!1,f=!1;break;case"cut":va=!0}return c.apply(this,arguments)}d.preventDefault()}}}function U(b){function c(b){if(a.valHooks&&(void 0===a.valHooks[b]||a.valHooks[b].inputmaskpatch!==!0)){var c=a.valHooks[b]&&a.valHooks[b].get?a.valHooks[b].get:function(a){return a.value},d=a.valHooks[b]&&a.valHooks[b].set?a.valHooks[b].set:function(a,b){return a.value=b,a};a.valHooks[b]={get:function(a){if(a.inputmask){if(a.inputmask.opts.autoUnmask)return a.inputmask.unmaskedvalue();var b=c(a),d=a.inputmask.maskset,e=d._buffer;return e=e?e.join(""):"",b!==e?b:""}return c(a)},set:function(b,c){var e,f=a(b);return e=d(b,c),b.inputmask&&f.trigger("setvalue.inputmask"),e},inputmaskpatch:!0}}}function d(){return this.inputmask?this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():h.call(this)!==z().join("")?document.activeElement===this&&g.clearMaskOnLostFocus?(ta?Q(A().slice()).reverse():Q(A().slice())).join(""):h.call(this):"":h.call(this)}function e(b){i.call(this,b),this.inputmask&&a(this).trigger("setvalue.inputmask")}function f(b){a(b).on("mouseenter.inputmask",T(function(b){var c=a(this),d=this,e=d.inputmask._valueGet();""!==e&&e!==A().join("")&&c.trigger("setvalue.inputmask")}))}var h,i;b.inputmask.__valueGet||(Object.getOwnPropertyDescriptor&&void 0===b.value?(h=function(){return this.textContent},i=function(a){this.textContent=a},Object.defineProperty(b,"value",{get:d,set:e})):document.__lookupGetter__&&b.__lookupGetter__("value")?(h=b.__lookupGetter__("value"),i=b.__lookupSetter__("value"),b.__defineGetter__("value",d),b.__defineSetter__("value",e)):(h=function(){return b.value},i=function(a){b.value=a},c(b.type),f(b)),b.inputmask.__valueGet=h,b.inputmask._valueGet=function(a){return ta&&a!==!0?h.call(this.el).split("").reverse().join(""):h.call(this.el)},b.inputmask.__valueSet=i,b.inputmask._valueSet=function(a,b){i.call(this.el,null===a||void 0===a?"":b!==!0&&ta?a.split("").reverse().join(""):a)})}function V(c,d,e,f){function h(){if(g.keepStatic){q(!0);var b,d=[],e=a.extend(!0,{},p().validPositions);for(b=r();b>=0;b--){var f=p().validPositions[b];if(f&&(null!=f.match.fn&&d.push(f.input),delete p().validPositions[b],void 0!==f.alternation&&f.locator[f.alternation]===u(b).locator[f.alternation]))break}if(b>-1)for(;d.length>0;){p().p=H(r());var h=a.Event("keypress");h.which=d.pop().charCodeAt(0),X.call(c,h,!0,!1,!1,p().p)}else p().validPositions=a.extend(!0,{},e)}}if((g.numericInput||ta)&&(d===b.keyCode.BACKSPACE?d=b.keyCode.DELETE:d===b.keyCode.DELETE&&(d=b.keyCode.BACKSPACE),ta)){var i=e.end;e.end=e.begin,e.begin=i}d===b.keyCode.BACKSPACE&&(e.end-e.begin<1||g.insertMode===!1)?(e.begin=I(e.begin),void 0===p().validPositions[e.begin]||p().validPositions[e.begin].input!==g.groupSeparator&&p().validPositions[e.begin].input!==g.radixPoint||e.begin--):d===b.keyCode.DELETE&&e.begin===e.end&&(e.end=F(e.end)?e.end+1:H(e.end)+1,void 0===p().validPositions[e.begin]||p().validPositions[e.begin].input!==g.groupSeparator&&p().validPositions[e.begin].input!==g.radixPoint||e.end++),t(e.begin,e.end,!1,f),f!==!0&&h();var j=r(e.begin);j<e.begin?(-1===j&&q(),p().p=H(j)):f!==!0&&(p().p=e.begin)}function W(d){var e=this,f=a(e),h=d.keyCode,i=O(e);h===b.keyCode.BACKSPACE||h===b.keyCode.DELETE||j&&127===h||d.ctrlKey&&88===h&&!c("cut")?(d.preventDefault(),88===h&&(na=A().join("")),V(e,h,i),K(e,A(),p().p,d,na!==A().join("")),e.inputmask._valueGet()===z().join("")?f.trigger("cleared"):R(A())===!0&&f.trigger("complete"),g.showTooltip&&(e.title=g.tooltip||p().mask)):h===b.keyCode.END||h===b.keyCode.PAGE_DOWN?setTimeout(function(){var a=H(r());g.insertMode||a!==G()||d.shiftKey||a--,O(e,d.shiftKey?i.begin:a,a)},0):h===b.keyCode.HOME&&!d.shiftKey||h===b.keyCode.PAGE_UP?O(e,0,d.shiftKey?i.begin:0):(g.undoOnEscape&&h===b.keyCode.ESCAPE||90===h&&d.ctrlKey)&&d.altKey!==!0?(M(e,!0,!1,na.split("")),f.trigger("click")):h!==b.keyCode.INSERT||d.shiftKey||d.ctrlKey?g.tabThrough===!0&&h===b.keyCode.TAB?(d.shiftKey===!0?(null===v(i.begin).fn&&(i.begin=H(i.begin)),i.end=I(i.begin,!0),i.begin=I(i.end,!0)):(i.begin=H(i.begin,!0),i.end=H(i.begin,!0),i.end<G()&&i.end--),i.begin<G()&&(d.preventDefault(),O(e,i.begin,i.end))):g.insertMode!==!1||d.shiftKey||(h===b.keyCode.RIGHT?setTimeout(function(){var a=O(e);O(e,a.begin)},0):h===b.keyCode.LEFT&&setTimeout(function(){var a=O(e);O(e,ta?a.begin+1:a.begin-1)},0)):(g.insertMode=!g.insertMode,O(e,g.insertMode||i.begin!==G()?i.begin:i.begin-1)),g.onKeyDown.call(this,d,A(),O(e).begin,g),wa=-1!==a.inArray(h,g.ignorables)}function X(c,d,e,f,h){var i=this,j=a(i),k=c.which||c.charCode||c.keyCode;if(!(d===!0||c.ctrlKey&&c.altKey)&&(c.ctrlKey||c.metaKey||wa))return k===b.keyCode.ENTER&&na!==A().join("")&&(na=A().join(""),setTimeout(function(){j.trigger("change")},0)),!0;if(k){46===k&&c.shiftKey===!1&&","===g.radixPoint&&(k=44);var l,m=d?{begin:h,end:h}:O(i),n=String.fromCharCode(k),o=S(m.begin,m.end);o&&(p().undoPositions=a.extend(!0,{},p().validPositions),V(i,b.keyCode.DELETE,m,!0),m.begin=p().p,g.insertMode||(g.insertMode=!g.insertMode,s(m.begin,f),g.insertMode=!g.insertMode),o=!g.multi),p().writeOutBuffer=!0;var r=ta&&!o?m.end:m.begin,t=E(r,n,f);if(t!==!1){if(t!==!0&&(r=void 0!==t.pos?t.pos:r,n=void 0!==t.c?t.c:n),q(!0),void 0!==t.caret)l=t.caret;else{var u=p().validPositions;l=!g.keepStatic&&(void 0!==u[r+1]&&y(r+1,u[r].locator.slice(),r).length>1||void 0!==u[r].alternation)?r+1:H(r)}p().p=l}if(e!==!1){var v=this;if(setTimeout(function(){g.onKeyValidation.call(v,k,t,g)},0),p().writeOutBuffer&&t!==!1){var w=A();K(i,w,d?void 0:g.numericInput?I(l):l,c,d!==!0),d!==!0&&setTimeout(function(){R(w)===!0&&j.trigger("complete")},0)}else o&&(p().buffer=void 0,p().validPositions=p().undoPositions)}else o&&(p().buffer=void 0,p().validPositions=p().undoPositions);if(g.showTooltip&&(i.title=g.tooltip||p().mask),d&&a.isFunction(g.onBeforeWrite)){var x=g.onBeforeWrite(c,A(),l,g);if(x&&x.refreshFromBuffer){var z=x.refreshFromBuffer;B(z===!0?z:z.start,z.end,x.buffer),q(!0),x.caret&&(p().p=x.caret)}}if(c.preventDefault(),d)return t}}function Y(b){var c=this,d=b.originalEvent||b,e=a(c),f=c.inputmask._valueGet(!0),h=O(c);if("propertychange"===b.type&&c.inputmask._valueGet().length<=G())return!0;if("paste"===b.type){var i=f.substr(0,h.begin),j=f.substr(h.end,f.length);i===z().slice(0,h.begin).join("")&&(i=""),j===z().slice(h.end).join("")&&(j=""),window.clipboardData&&window.clipboardData.getData?f=i+window.clipboardData.getData("Text")+j:d.clipboardData&&d.clipboardData.getData&&(f=i+d.clipboardData.getData("text/plain")+j)}var k=f;if(a.isFunction(g.onBeforePaste)){if(k=g.onBeforePaste(f,g),k===!1)return b.preventDefault(),!1;k||(k=f)}return M(c,!1,!1,ta?k.split("").reverse():k.toString().split("")),K(c,A(),void 0,b,!0),e.trigger("click"),R(A())===!0&&e.trigger("complete"),!1}function Z(b){var c=this;M(c,!0,!1,c.inputmask._valueGet().split("")),R(A())===!0&&a(c).trigger("complete"),b.preventDefault()}function $(a){var c=this,d=O(c),e=c.inputmask._valueGet();e=e.replace(new RegExp("("+b.escapeRegex(z().join(""))+")*"),""),d.begin>e.length&&(O(c,e.length),d=O(c)),A().length-e.length!==1||e.charAt(d.begin)===A()[d.begin]||e.charAt(d.begin+1)===A()[d.begin]||F(d.begin)?Z.call(this,a):(a.keyCode=g.keyCode.BACKSPACE,W.call(c,a)),a.preventDefault()}function _(a){var b=a.originalEvent||a;na=A().join(""),""===oa||0!==b.data.indexOf(oa)}function aa(b){var c=this,d=b.originalEvent||b;0===d.data.indexOf(oa)&&(q(),p().p=H(-1),va=!0);for(var e=d.data,f=0;f<e.length;f++){var h=a.Event("keypress");h.which=e.charCodeAt(f),ua=!1,wa=!1,X.call(c,h,!0,!1,!1,p().p)}setTimeout(function(){var a=p().p;K(c,A(),g.numericInput?I(a):a)},0),oa=d.data}function ba(a){}function ca(b){var c=this,d=c.inputmask._valueGet();M(c,!0,!1,(a.isFunction(g.onBeforeMask)?g.onBeforeMask(d,g)||d:d).split("")),na=A().join(""),(g.clearMaskOnLostFocus||g.clearIncomplete)&&c.inputmask._valueGet()===z().join("")&&c.inputmask._valueSet("")}function da(a){var b=this,c=b.inputmask._valueGet();g.showMaskOnFocus&&(!g.showMaskOnHover||g.showMaskOnHover&&""===c)?b.inputmask._valueGet()!==A().join("")&&K(b,A(),H(r())):xa===!1&&O(b,H(r())),g.positionCaretOnTab===!0&&setTimeout(function(){O(b,H(r()))},0),na=A().join("")}function ea(a){var b=this;if(xa=!1,g.clearMaskOnLostFocus){var c=A().slice(),d=b.inputmask._valueGet();document.activeElement!==b&&d!==b.getAttribute("placeholder")&&""!==d&&(-1===r()&&d===z().join("")?c=[]:Q(c),K(b,c))}}function fa(b){function c(b){if(g.radixFocus&&""!==g.radixPoint){var c=p().validPositions;if(void 0===c[b]||c[b].input===L(b)){if(b<H(-1))return!0;var d=a.inArray(g.radixPoint,A());if(-1!==d){for(var e in c)if(e>d&&c[e].input!==L(e))return!1;return!0}}}return!1}var d=this;if(document.activeElement===d){var e=O(d);if(e.begin===e.end)if(c(e.begin))O(d,a.inArray(g.radixPoint,A()));else{var f=e.begin,h=r(f),i=H(h);
    i>f?O(d,F(f)||F(f-1)?f:H(f)):((A()[i]!==L(i)||!F(i,!0)&&v(i).def===L(i))&&(i=H(i)),O(d,i))}}}function ga(a){var b=this;setTimeout(function(){O(b,0,H(r()))},0)}function ha(c){var d=this,e=a(d),f=O(d),h=c.originalEvent||c,i=window.clipboardData||h.clipboardData,j=ta?A().slice(f.end,f.begin):A().slice(f.begin,f.end);i.setData("text",ta?j.reverse().join(""):j.join("")),document.execCommand&&document.execCommand("copy"),V(d,b.keyCode.DELETE,f),K(d,A(),p().p,c,na!==A().join("")),d.inputmask._valueGet()===z().join("")&&e.trigger("cleared"),g.showTooltip&&(d.title=g.tooltip||p().mask)}function ia(b){var c=a(this),d=this;if(d.inputmask){var e=d.inputmask._valueGet(),f=A().slice();na!==f.join("")&&setTimeout(function(){c.trigger("change"),na=f.join("")},0),""!==e&&(g.clearMaskOnLostFocus&&(-1===r()&&e===z().join("")?f=[]:Q(f)),R(f)===!1&&(setTimeout(function(){c.trigger("incomplete")},0),g.clearIncomplete&&(q(),f=g.clearMaskOnLostFocus?[]:z().slice())),K(d,f,void 0,b))}}function ja(a){var b=this;xa=!0,document.activeElement!==b&&g.showMaskOnHover&&b.inputmask._valueGet()!==A().join("")&&K(b,A())}function ka(a){na!==A().join("")&&qa.trigger("change"),g.clearMaskOnLostFocus&&-1===r()&&pa.inputmask._valueGet&&pa.inputmask._valueGet()===z().join("")&&pa.inputmask._valueSet(""),g.removeMaskOnSubmit&&(pa.inputmask._valueSet(pa.inputmask.unmaskedvalue(),!0),setTimeout(function(){K(pa,A())},0))}function la(a){setTimeout(function(){qa.trigger("setvalue.inputmask")},0)}function ma(b){if(pa=b,qa=a(pa),g.showTooltip&&(pa.title=g.tooltip||p().mask),("rtl"===pa.dir||g.rightAlign)&&(pa.style.textAlign="right"),("rtl"===pa.dir||g.numericInput)&&(pa.dir="ltr",pa.removeAttribute("dir"),pa.inputmask.isRTL=!0,ta=!0),qa.off(".inputmask"),U(pa),("INPUT"===pa.tagName&&d(pa.getAttribute("type"))||pa.isContentEditable||"TEXTAREA"===pa.tagName)&&(a(pa.form).on("submit.inputmask",ka).on("reset.inputmask",la),qa.on("mouseenter.inputmask",T(ja)).on("blur.inputmask",T(ia)).on("focus.inputmask",T(da)).on("mouseleave.inputmask",T(ea)).on("click.inputmask",T(fa)).on("dblclick.inputmask",T(ga)).on(o+".inputmask dragdrop.inputmask drop.inputmask",T(Y)).on("cut.inputmask",T(ha)).on("complete.inputmask",T(g.oncomplete)).on("incomplete.inputmask",T(g.onincomplete)).on("cleared.inputmask",T(g.oncleared)).on("keydown.inputmask",T(W)).on("keypress.inputmask",T(X)),m||qa.on("compositionstart.inputmask",T(_)).on("compositionupdate.inputmask",T(aa)).on("compositionend.inputmask",T(ba)),"paste"===o&&qa.on("input.inputmask",T(Z)),(k||m||l||n)&&(qa.off("input.inputmask"),qa.on("input.inputmask",T($)))),qa.on("setvalue.inputmask",T(ca)),""!==pa.inputmask._valueGet()||g.clearMaskOnLostFocus===!1){var c=a.isFunction(g.onBeforeMask)?g.onBeforeMask(pa.inputmask._valueGet(),g)||pa.inputmask._valueGet():pa.inputmask._valueGet();M(pa,!0,!1,c.split(""));var e=A().slice();na=e.join(""),R(e)===!1&&g.clearIncomplete&&q(),g.clearMaskOnLostFocus&&(e.join("")===z().join("")?e=[]:Q(e)),K(pa,e),document.activeElement===pa&&O(pa,H(r()))}}var na,oa,pa,qa,ra,sa,ta=!1,ua=!1,va=!1,wa=!1,xa=!0;if(void 0!==e)switch(e.action){case"isComplete":return pa=e.el,R(A());case"unmaskedvalue":return pa=e.el,void 0!==pa&&void 0!==pa.inputmask?(f=pa.inputmask.maskset,g=pa.inputmask.opts,ta=pa.inputmask.isRTL):(sa=e.value,g.numericInput&&(ta=!0),sa=(a.isFunction(g.onBeforeMask)?g.onBeforeMask(sa,g)||sa:sa).split(""),M(void 0,!1,!1,ta?sa.reverse():sa),a.isFunction(g.onBeforeWrite)&&g.onBeforeWrite(void 0,A(),0,g)),N(pa);case"mask":pa=e.el,f=pa.inputmask.maskset,g=pa.inputmask.opts,ta=pa.inputmask.isRTL,na=A().join(""),ma(pa);break;case"format":return g.numericInput&&(ta=!0),sa=(a.isFunction(g.onBeforeMask)?g.onBeforeMask(e.value,g)||e.value:e.value).split(""),M(void 0,!1,!1,ta?sa.reverse():sa),a.isFunction(g.onBeforeWrite)&&g.onBeforeWrite(void 0,A(),0,g),e.metadata?{value:ta?A().slice().reverse().join(""):A().join(""),metadata:h({action:"getmetadata"},f,g)}:ta?A().slice().reverse().join(""):A().join("");case"isValid":g.numericInput&&(ta=!0),e.value?(sa=e.value.split(""),M(void 0,!1,!0,ta?sa.reverse():sa)):e.value=A().join("");for(var ya=A(),za=P(),Aa=ya.length-1;Aa>za&&!F(Aa);Aa--);return ya.splice(za,Aa+1-za),R(ya)&&e.value===A().join("");case"getemptymask":return z();case"remove":pa=e.el,qa=a(pa),f=pa.inputmask.maskset,g=pa.inputmask.opts,pa.inputmask._valueSet(N(pa)),qa.off(".inputmask");var Ba;Object.getOwnPropertyDescriptor&&(Ba=Object.getOwnPropertyDescriptor(pa,"value")),Ba&&Ba.get?pa.inputmask.__valueGet&&Object.defineProperty(pa,"value",{get:pa.inputmask.__valueGet,set:pa.inputmask.__valueSet}):document.__lookupGetter__&&pa.__lookupGetter__("value")&&pa.inputmask.__valueGet&&(pa.__defineGetter__("value",pa.inputmask.__valueGet),pa.__defineSetter__("value",pa.inputmask.__valueSet)),pa.inputmask=void 0;break;case"getmetadata":if(a.isArray(f.metadata)){for(var Ca,Da=r(),Ea=Da;Ea>=0;Ea--)if(p().validPositions[Ea]&&void 0!==p().validPositions[Ea].alternation){Ca=p().validPositions[Ea].alternation;break}return void 0!==Ca?f.metadata[p().validPositions[Da].locator[Ca]]:f.metadata[0]}return f.metadata}}b.prototype={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:a.noop,onincomplete:a.noop,oncleared:a.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:a.noop,onBeforeMask:null,onBeforePaste:function(b,c){return a.isFunction(c.onBeforeMask)?c.onBeforeMask(b,c):b},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:a.noop,skipOptionalPartCharacter:" ",showTooltip:!1,tooltip:void 0,numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",groupSeparator:"",radixFocus:!1,nojumps:!1,nojumpsThreshold:0,keepStatic:null,positionCaretOnTab:!1,tabThrough:!1,supportsInputType:[],definitions:{9:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:null,canClearPosition:a.noop,postValidation:null,staticDefinitionSymbol:void 0},masksCache:{},mask:function(c){var d=this;return"string"==typeof c&&(c=document.getElementById(c)||document.querySelectorAll(c)),c=c.nodeName?[c]:c,a.each(c,function(c,e){var i=a.extend(!0,{},d.opts);f(e,i,a.extend(!0,{},d.userOptions));var j=g(i,d.noMasksCache);void 0!==j&&(void 0!==e.inputmask&&e.inputmask.remove(),e.inputmask=new b,e.inputmask.opts=i,e.inputmask.noMasksCache=d.noMasksCache,e.inputmask.userOptions=a.extend(!0,{},d.userOptions),e.inputmask.el=e,e.inputmask.maskset=j,e.inputmask.isRTL=!1,a.data(e,"_inputmask_opts",i),h({action:"mask",el:e}))}),c&&c[0]?c[0].inputmask||this:this},option:function(b){return"string"==typeof b?this.opts[b]:"object"==typeof b?(a.extend(this.opts,b),a.extend(this.userOptions,b),this.el&&(void 0!==b.mask||void 0!==b.alias?this.mask(this.el):(a.data(this.el,"_inputmask_opts",this.opts),h({action:"mask",el:this.el}))),this):void 0},unmaskedvalue:function(a){return h({action:"unmaskedvalue",el:this.el,value:a},this.el&&this.el.inputmask?this.el.inputmask.maskset:g(this.opts,this.noMasksCache),this.opts)},remove:function(){return this.el?(h({action:"remove",el:this.el}),this.el.inputmask=void 0,this.el):void 0},getemptymask:function(){return h({action:"getemptymask"},this.maskset||g(this.opts,this.noMasksCache),this.opts)},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return h({action:"isComplete",el:this.el},this.maskset||g(this.opts,this.noMasksCache),this.opts)},getmetadata:function(){return h({action:"getmetadata"},this.maskset||g(this.opts,this.noMasksCache),this.opts)},isValid:function(a){return h({action:"isValid",value:a},this.maskset||g(this.opts,this.noMasksCache),this.opts)},format:function(a,b){return h({action:"format",value:a,metadata:b},this.maskset||g(this.opts,this.noMasksCache),this.opts)}},b.extendDefaults=function(c){a.extend(!0,b.prototype.defaults,c)},b.extendDefinitions=function(c){a.extend(!0,b.prototype.defaults.definitions,c)},b.extendAliases=function(c){a.extend(!0,b.prototype.defaults.aliases,c)},b.format=function(a,c,d){return b(c).format(a,d)},b.unmask=function(a,c){return b(c).unmaskedvalue(a)},b.isValid=function(a,c){return b(c).isValid(a)},b.remove=function(b){a.each(b,function(a,b){b.inputmask&&b.inputmask.remove()})},b.escapeRegex=function(a){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return a.replace(new RegExp("(\\"+b.join("|\\")+")","gim"),"\\$1")},b.keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91};var i=navigator.userAgent,j=null!==i.match(new RegExp("iphone","i")),k=null!==i.match(new RegExp("android.*safari.*","i")),l=null!==i.match(new RegExp("android.*chrome.*","i")),m=null!==i.match(new RegExp("android.*firefox.*","i")),n=/Kindle/i.test(i)||/Silk/i.test(i)||/KFTT/i.test(i)||/KFOT/i.test(i)||/KFJWA/i.test(i)||/KFJWI/i.test(i)||/KFSOWI/i.test(i)||/KFTHWA/i.test(i)||/KFTHWI/i.test(i)||/KFAPWA/i.test(i)||/KFAPWI/i.test(i),o=c("paste")?"paste":c("input")?"input":"propertychange";return window.Inputmask=b,b}(jQuery),function(a,b){return void 0===a.fn.inputmask&&(a.fn.inputmask=function(c,d){var e,f=this[0];if(d=d||{},"string"==typeof c)switch(c){case"unmaskedvalue":return f&&f.inputmask?f.inputmask.unmaskedvalue():a(f).val();case"remove":return this.each(function(){this.inputmask&&this.inputmask.remove()});case"getemptymask":return f&&f.inputmask?f.inputmask.getemptymask():"";case"hasMaskedValue":return f&&f.inputmask?f.inputmask.hasMaskedValue():!1;case"isComplete":return f&&f.inputmask?f.inputmask.isComplete():!0;case"getmetadata":return f&&f.inputmask?f.inputmask.getmetadata():void 0;case"setvalue":a(f).val(d),f&&void 0!==f.inputmask&&a(f).triggerHandler("setvalue.inputmask");break;case"option":if("string"!=typeof d)return this.each(function(){return void 0!==this.inputmask?this.inputmask.option(d):void 0});if(f&&void 0!==f.inputmask)return f.inputmask.option(d);break;default:return d.alias=c,e=new b(d),this.each(function(){e.mask(this)})}else{if("object"==typeof c)return e=new b(c),void 0===c.mask&&void 0===c.alias?this.each(function(){return void 0!==this.inputmask?this.inputmask.option(c):void e.mask(this)}):this.each(function(){e.mask(this)});if(void 0===c)return this.each(function(){e=new b(d),e.mask(this)})}}),a.fn.inputmask}(jQuery,Inputmask),function(a,b){return b.extendDefinitions({h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),b.extendAliases({"dd/mm/yyyy":{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+c+"[01])")},val2:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|[12][0-9])"+c+"(0[1-9]|1[012]))|(30"+c+"(0[13-9]|1[012]))|(31"+c+"(0[13578]|1[02]))")}},leapday:"29/02/",separator:"/",yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(a,b,c){if(isNaN(a))return!1;var d=parseInt(a.concat(b.toString().slice(a.length))),e=parseInt(a.concat(c.toString().slice(a.length)));return(isNaN(d)?!1:d>=b&&c>=d)||(isNaN(e)?!1:e>=b&&c>=e)},determinebaseyear:function(a,b,c){var d=(new Date).getFullYear();if(a>d)return a;if(d>b){for(var e=b.toString().slice(0,2),f=b.toString().slice(2,4);e+c>b;)e--;var g=e+f;return a>g?a:g}return d},onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey&&c.keyCode===b.keyCode.RIGHT){var h=new Date;g.val(h.getDate().toString()+(h.getMonth()+1).toString()+h.getFullYear().toString()),g.trigger("setvalue.inputmask")}},getFrontValue:function(a,b,c){for(var d=0,e=0,f=0;f<a.length&&"2"!==a.charAt(f);f++){var g=c.definitions[a.charAt(f)];g?(d+=e,e=g.cardinality):e++}return b.join("").substr(d,e)},definitions:{1:{validator:function(a,b,c,d,e){var f=e.regex.val1.test(a);return d||f||a.charAt(1)!==e.separator&&-1==="-./".indexOf(a.charAt(1))||!(f=e.regex.val1.test("0"+a.charAt(0)))?f:(b.buffer[c-1]="0",{refreshFromBuffer:{start:c-1,end:c},pos:c,c:a.charAt(0)})},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=a;isNaN(b.buffer[c+1])||(f+=b.buffer[c+1]);var g=1===f.length?e.regex.val1pre.test(f):e.regex.val1.test(f);if(!d&&!g){if(g=e.regex.val1.test(a+"0"))return b.buffer[c]=a,b.buffer[++c]="0",{pos:c,c:"0"};if(g=e.regex.val1.test("0"+a))return b.buffer[c]="0",c++,{pos:c}}return g},cardinality:1}]},2:{validator:function(a,b,c,d,e){var f=e.getFrontValue(b.mask,b.buffer,e);-1!==f.indexOf(e.placeholder[0])&&(f="01"+e.separator);var g=e.regex.val2(e.separator).test(f+a);if(!d&&!g&&(a.charAt(1)===e.separator||-1!=="-./".indexOf(a.charAt(1)))&&(g=e.regex.val2(e.separator).test(f+"0"+a.charAt(0))))return b.buffer[c-1]="0",{refreshFromBuffer:{start:c-1,end:c},pos:c,c:a.charAt(0)};if(e.mask.indexOf("2")===e.mask.length-1&&g){var h=b.buffer.join("").substr(4,4)+a;if(h!==e.leapday)return!0;var i=parseInt(b.buffer.join("").substr(0,4),10);return i%4===0?i%100===0?i%400===0?!0:!1:!0:!1}return g},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){isNaN(b.buffer[c+1])||(a+=b.buffer[c+1]);var f=e.getFrontValue(b.mask,b.buffer,e);-1!==f.indexOf(e.placeholder[0])&&(f="01"+e.separator);var g=1===a.length?e.regex.val2pre(e.separator).test(f+a):e.regex.val2(e.separator).test(f+a);return d||g||!(g=e.regex.val2(e.separator).test(f+"0"+a))?g:(b.buffer[c]="0",c++,{pos:c})},cardinality:1}]},y:{validator:function(a,b,c,d,e){if(e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear)){var f=b.buffer.join("").substr(0,6);if(f!==e.leapday)return!0;var g=parseInt(a,10);return g%4===0?g%100===0?g%400===0?!0:!1:!0:!1}return!1},cardinality:4,prevalidator:[{validator:function(a,b,c,d,e){var f=e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear);if(!d&&!f){var g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a+"0").toString().slice(0,1);if(f=e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear))return b.buffer[c++]=g.charAt(0),{pos:c};if(g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a+"0").toString().slice(0,2),f=e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear))return b.buffer[c++]=g.charAt(0),b.buffer[c++]=g.charAt(1),{pos:c}}return f},cardinality:1},{validator:function(a,b,c,d,e){var f=e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear);if(!d&&!f){var g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a).toString().slice(0,2);if(f=e.isInYearRange(a[0]+g[1]+a[1],e.yearrange.minyear,e.yearrange.maxyear))return b.buffer[c++]=g.charAt(1),{pos:c};if(g=e.determinebaseyear(e.yearrange.minyear,e.yearrange.maxyear,a).toString().slice(0,2),e.isInYearRange(g+a,e.yearrange.minyear,e.yearrange.maxyear)){var h=b.buffer.join("").substr(0,6);if(h!==e.leapday)f=!0;else{var i=parseInt(a,10);f=i%4===0?i%100===0?i%400===0?!0:!1:!0:!1}}else f=!1;if(f)return b.buffer[c-1]=g.charAt(0),b.buffer[c++]=g.charAt(1),b.buffer[c++]=a.charAt(0),{refreshFromBuffer:{start:c-3,end:c},pos:c}}return f},cardinality:2},{validator:function(a,b,c,d,e){return e.isInYearRange(a,e.yearrange.minyear,e.yearrange.maxyear)},cardinality:3}]}},insertMode:!1,autoUnmask:!1},"mm/dd/yyyy":{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[13-9]|1[012])"+c+"[0-3])|(02"+c+"[0-2])")},val2:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+c+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+c+"30)|((0[13578]|1[02])"+c+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey&&c.keyCode===b.keyCode.RIGHT){var h=new Date;g.val((h.getMonth()+1).toString()+h.getDate().toString()+h.getFullYear().toString()),g.trigger("setvalue.inputmask")}}},"yyyy/mm/dd":{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey&&c.keyCode===b.keyCode.RIGHT){var h=new Date;g.val(h.getFullYear().toString()+(h.getMonth()+1).toString()+h.getDate().toString()),g.trigger("setvalue.inputmask")}}},"dd.mm.yyyy":{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:".",alias:"dd/mm/yyyy"},"dd-mm-yyyy":{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:"-",alias:"dd/mm/yyyy"},"mm.dd.yyyy":{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:".",alias:"mm/dd/yyyy"},"mm-dd-yyyy":{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:"-",alias:"mm/dd/yyyy"},"yyyy.mm.dd":{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:".",alias:"yyyy/mm/dd"},"yyyy-mm-dd":{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:"-",alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-4]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-4]"),ampm:new RegExp("^[a|p|A|P][m|M]"),mspre:new RegExp("[0-5]"),ms:new RegExp("[0-5][0-9]")},timeseparator:":",hourFormat:"24",definitions:{h:{validator:function(a,b,c,d,e){if("24"===e.hourFormat&&24===parseInt(a,10))return b.buffer[c-1]="0",b.buffer[c]="0",{refreshFromBuffer:{start:c-1,end:c},c:"0"};var f=e.regex.hrs.test(a);if(!d&&!f&&(a.charAt(1)===e.timeseparator||-1!=="-.:".indexOf(a.charAt(1)))&&(f=e.regex.hrs.test("0"+a.charAt(0))))return b.buffer[c-1]="0",b.buffer[c]=a.charAt(0),c++,{refreshFromBuffer:{start:c-2,end:c},pos:c,c:e.timeseparator};if(f&&"24"!==e.hourFormat&&e.regex.hrs24.test(a)){var g=parseInt(a,10);return 24===g?(b.buffer[c+5]="a",b.buffer[c+6]="m"):(b.buffer[c+5]="p",b.buffer[c+6]="m"),g-=12,10>g?(b.buffer[c]=g.toString(),b.buffer[c-1]="0"):(b.buffer[c]=g.toString().charAt(1),b.buffer[c-1]=g.toString().charAt(0)),{refreshFromBuffer:{start:c-1,end:c+6},c:b.buffer[c]}}return f},cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=e.regex.hrspre.test(a);return d||f||!(f=e.regex.hrs.test("0"+a))?f:(b.buffer[c]="0",c++,{pos:c})},cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:function(a,b,c,d,e){var f=e.regex.mspre.test(a);return d||f||!(f=e.regex.ms.test("0"+a))?f:(b.buffer[c]="0",c++,{pos:c})},cardinality:1}]},t:{validator:function(a,b,c,d,e){return e.regex.ampm.test(a+"m")},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},"mm/dd/yyyy hh:mm xm":{mask:"1/2/y h:s t\\m",placeholder:"mm/dd/yyyy hh:mm xm",alias:"datetime12",regex:{val2pre:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[13-9]|1[012])"+c+"[0-3])|(02"+c+"[0-2])")},val2:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+c+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+c+"30)|((0[13578]|1[02])"+c+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey&&c.keyCode===b.keyCode.RIGHT){var h=new Date;g.val((h.getMonth()+1).toString()+h.getDate().toString()+h.getFullYear().toString()),g.trigger("setvalue.inputmask")}}},"hh:mm t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:s t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm:ss":{mask:"h:s:s",placeholder:"hh:mm:ss",alias:"datetime",autoUnmask:!1},"hh:mm":{mask:"h:s",placeholder:"hh:mm",alias:"datetime",autoUnmask:!1},date:{alias:"dd/mm/yyyy"},"mm/yyyy":{mask:"1/y",placeholder:"mm/yyyy",leapday:"donotuse",separator:"/",alias:"mm/dd/yyyy"},shamsi:{regex:{val2pre:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+c+"[0-3])")},val2:function(a){var c=b.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+c+"(0[1-9]|[12][0-9]))|((0[1-9]|1[012])"+c+"30)|((0[1-6])"+c+"31)")},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},yearrange:{minyear:1300,maxyear:1499},mask:"y/1/2",leapday:"/12/30",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",clearIncomplete:!0}}),b}(jQuery,Inputmask),function(a,b){return b.extendDefinitions({A:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,casing:"upper"},"&":{validator:"[0-9A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,casing:"upper"},"#":{validator:"[0-9A-Fa-f]",cardinality:1,casing:"upper"}}),b.extendAliases({url:{definitions:{i:{validator:".",cardinality:1}},mask:"(\\http://)|(\\http\\s://)|(ftp://)|(ftp\\s://)i{+}",insertMode:!1,autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(a,b,c,d,e){return c-1>-1&&"."!==b.buffer[c-1]?(a=b.buffer[c-1]+a,a=c-2>-1&&"."!==b.buffer[c-2]?b.buffer[c-2]+a:"0"+a):a="00"+a,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(a)},cardinality:1}},onUnMask:function(a,b,c){return a}},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,64}]@*{1,64}[.*{2,64}][.*{2,6}][.*{1,2}]",greedy:!1,onBeforePaste:function(a,b){return a=a.toLowerCase(),a.replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"}},onUnMask:function(a,b,c){return a}},mac:{mask:"##:##:##:##:##:##"}}),b}(jQuery,Inputmask),function(a,b){return b.extendAliases({numeric:{mask:function(a){function b(b){for(var c="",d=0;d<b.length;d++)c+=a.definitions[b.charAt(d)]?"\\"+b.charAt(d):b.charAt(d);return c}if(0!==a.repeat&&isNaN(a.integerDigits)&&(a.integerDigits=a.repeat),a.repeat=0,a.groupSeparator===a.radixPoint&&("."===a.radixPoint?a.groupSeparator=",":","===a.radixPoint?a.groupSeparator=".":a.groupSeparator="")," "===a.groupSeparator&&(a.skipOptionalPartCharacter=void 0),a.autoGroup=a.autoGroup&&""!==a.groupSeparator,a.autoGroup&&("string"==typeof a.groupSize&&isFinite(a.groupSize)&&(a.groupSize=parseInt(a.groupSize)),isFinite(a.integerDigits))){var c=Math.floor(a.integerDigits/a.groupSize),d=a.integerDigits%a.groupSize;a.integerDigits=parseInt(a.integerDigits)+(0===d?c-1:c),a.integerDigits<1&&(a.integerDigits="*")}a.placeholder.length>1&&(a.placeholder=a.placeholder.charAt(0)),a.radixFocus=a.radixFocus&&""!==a.placeholder&&a.integerOptional===!0,a.definitions[";"]=a.definitions["~"],a.definitions[";"].definitionSymbol="~",a.numericInput===!0&&(a.radixFocus=!1,a.digitsOptional=!1,isNaN(a.digits)&&(a.digits=2),a.decimalProtect=!1);var e=b(a.prefix);return e+="[+]",e+=a.integerOptional===!0?"~{1,"+a.integerDigits+"}":"~{"+a.integerDigits+"}",void 0!==a.digits&&(isNaN(a.digits)||parseInt(a.digits)>0)&&(e+=a.digitsOptional?"["+(a.decimalProtect?":":a.radixPoint)+";{1,"+a.digits+"}]":(a.decimalProtect?":":a.radixPoint)+";{"+a.digits+"}"),""!==a.negationSymbol.back&&(e+="[-]"),e+=b(a.suffix),a.greedy=!1,e},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,radixPoint:".",radixFocus:!0,groupSize:3,groupSeparator:"",autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",integerOptional:!0,prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:null,max:null,step:1,insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,postFormat:function(c,d,e,f){f.numericInput===!0&&(c=c.reverse(),isFinite(d)&&(d=c.join("").length-d-1));var g,h,i=!1;c.length>=f.suffix.length&&c.join("").indexOf(f.suffix)===c.length-f.suffix.length&&(c.length=c.length-f.suffix.length,i=!0),d=d>=c.length?c.length-1:d<f.prefix.length?f.prefix.length:d;var j=!1,k=c[d];if(""===f.groupSeparator||f.numericInput!==!0&&-1!==a.inArray(f.radixPoint,c)&&d>a.inArray(f.radixPoint,c)||new RegExp("["+b.escapeRegex(f.negationSymbol.front)+"+]").test(k)){if(i)for(g=0,h=f.suffix.length;h>g;g++)c.push(f.suffix.charAt(g));return{pos:d}}var l=c.slice();k===f.groupSeparator&&(l.splice(d--,1),k=l[d]),e?k!==f.radixPoint&&(l[d]="?"):l.splice(d,0,"?");var m=l.join(""),n=m;if(m.length>0&&f.autoGroup||e&&-1!==m.indexOf(f.groupSeparator)){var o=b.escapeRegex(f.groupSeparator);j=0===m.indexOf(f.groupSeparator),m=m.replace(new RegExp(o,"g"),"");var p=m.split(f.radixPoint);if(m=""===f.radixPoint?m:p[0],m!==f.prefix+"?0"&&m.length>=f.groupSize+f.prefix.length)for(var q=new RegExp("([-+]?[\\d?]+)([\\d?]{"+f.groupSize+"})");q.test(m);)m=m.replace(q,"$1"+f.groupSeparator+"$2"),m=m.replace(f.groupSeparator+f.groupSeparator,f.groupSeparator);""!==f.radixPoint&&p.length>1&&(m+=f.radixPoint+p[1])}for(j=n!==m,c.length=m.length,g=0,h=m.length;h>g;g++)c[g]=m.charAt(g);var r=a.inArray("?",c);if(-1===r&&k===f.radixPoint&&(r=a.inArray(f.radixPoint,c)),e?c[r]=k:c.splice(r,1),!j&&i)for(g=0,h=f.suffix.length;h>g;g++)c.push(f.suffix.charAt(g));return r=f.numericInput&&isFinite(d)?c.join("").length-r-1:r,f.numericInput&&(c=c.reverse(),a.inArray(f.radixPoint,c)<r&&c.join("").length-f.suffix.length!==r&&(r-=1)),{pos:r,refreshFromBuffer:j,buffer:c}},onBeforeWrite:function(c,d,e,f){if(c&&("blur"===c.type||"checkval"===c.type)){var g=d.join(""),h=g.replace(f.prefix,"");if(h=h.replace(f.suffix,""),h=h.replace(new RegExp(b.escapeRegex(f.groupSeparator),"g"),""),","===f.radixPoint&&(h=h.replace(b.escapeRegex(f.radixPoint),".")),isFinite(h)&&isFinite(f.min)&&parseFloat(h)<parseFloat(f.min))return a.extend(!0,{refreshFromBuffer:!0,buffer:(f.prefix+f.min).split("")},f.postFormat((f.prefix+f.min).split(""),0,!0,f));if(f.numericInput!==!0){var i=""!==f.radixPoint?d.join("").split(f.radixPoint):[d.join("")],j=i[0].match(f.regex.integerPart(f)),k=2===i.length?i[1].match(f.regex.integerNPart(f)):void 0;if(j){j[0]!==f.negationSymbol.front+"0"&&j[0]!==f.negationSymbol.front&&"+"!==j[0]||void 0!==k&&!k[0].match(/^0+$/)||d.splice(j.index,1);var l=a.inArray(f.radixPoint,d);if(-1!==l){if(isFinite(f.digits)&&!f.digitsOptional){for(var m=1;m<=f.digits;m++)(void 0===d[l+m]||d[l+m]===f.placeholder.charAt(0))&&(d[l+m]="0");return{refreshFromBuffer:g!==d.join(""),buffer:d}}if(l===d.length-f.suffix.length-1)return d.splice(l,1),{refreshFromBuffer:!0,buffer:d}}}}}if(f.autoGroup){var n=f.postFormat(d,f.numericInput?e:e-1,!0,f);return n.caret=e<=f.prefix.length?n.pos:n.pos+1,n}},regex:{integerPart:function(a){return new RegExp("["+b.escapeRegex(a.negationSymbol.front)+"+]?\\d+")},integerNPart:function(a){return new RegExp("[\\d"+b.escapeRegex(a.groupSeparator)+"]+")}},signHandler:function(a,b,c,d,e){if(!d&&e.allowMinus&&"-"===a||e.allowPlus&&"+"===a){var f=b.buffer.join("").match(e.regex.integerPart(e));if(f&&f[0].length>0)return b.buffer[f.index]===("-"===a?"+":e.negationSymbol.front)?"-"===a?""!==e.negationSymbol.back?{pos:f.index,c:e.negationSymbol.front,remove:f.index,caret:c,insert:{pos:b.buffer.length-e.suffix.length-1,c:e.negationSymbol.back}}:{pos:f.index,c:e.negationSymbol.front,remove:f.index,caret:c}:""!==e.negationSymbol.back?{pos:f.index,c:"+",remove:[f.index,b.buffer.length-e.suffix.length-1],caret:c}:{pos:f.index,c:"+",remove:f.index,caret:c}:b.buffer[f.index]===("-"===a?e.negationSymbol.front:"+")?"-"===a&&""!==e.negationSymbol.back?{remove:[f.index,b.buffer.length-e.suffix.length-1],caret:c-1}:{remove:f.index,caret:c-1}:"-"===a?""!==e.negationSymbol.back?{pos:f.index,c:e.negationSymbol.front,caret:c+1,insert:{pos:b.buffer.length-e.suffix.length,c:e.negationSymbol.back}}:{pos:f.index,c:e.negationSymbol.front,caret:c+1}:{pos:f.index,c:a,caret:c+1}}return!1},radixHandler:function(b,c,d,e,f){if(!e&&(-1!==a.inArray(b,[",","."])&&(b=f.radixPoint),b===f.radixPoint&&void 0!==f.digits&&(isNaN(f.digits)||parseInt(f.digits)>0))){var g=a.inArray(f.radixPoint,c.buffer),h=c.buffer.join("").match(f.regex.integerPart(f));if(-1!==g&&c.validPositions[g])return c.validPositions[g-1]?{caret:g+1}:{pos:h.index,c:h[0],caret:g+1};if(!h||"0"===h[0]&&h.index+1!==d)return c.buffer[h?h.index:d]="0",{pos:(h?h.index:d)+1,c:f.radixPoint}}return!1},leadingZeroHandler:function(b,c,d,e,f){if(f.numericInput===!0){if("0"===c.buffer[c.buffer.length-f.prefix.length-1])return{pos:d,remove:c.buffer.length-f.prefix.length-1}}else{var g=c.buffer.join("").match(f.regex.integerNPart(f)),h=a.inArray(f.radixPoint,c.buffer);if(g&&!e&&(-1===h||h>=d))if(0===g[0].indexOf("0")){d<f.prefix.length&&(d=g.index);var i=a.inArray(f.radixPoint,c._buffer),j=c._buffer&&c.buffer.slice(h).join("")===c._buffer.slice(i).join("")||0===parseInt(c.buffer.slice(h+1).join("")),k=c._buffer&&c.buffer.slice(g.index,h).join("")===c._buffer.slice(f.prefix.length,i).join("")||"0"===c.buffer.slice(g.index,h).join("");if(-1===h||j&&k)return c.buffer.splice(g.index,1),d=d>g.index?d-1:g.index,{pos:d,remove:g.index};if(g.index+1===d||"0"===b)return c.buffer.splice(g.index,1),d=g.index,{pos:d,remove:g.index}}else if("0"===b&&d<=g.index&&g[0]!==f.groupSeparator)return!1}return!0},postValidation:function(c,d){var e=!0,f=c.join(""),g=f.replace(d.prefix,"");return g=g.replace(d.suffix,""),g=g.replace(new RegExp(b.escapeRegex(d.groupSeparator),"g"),""),","===d.radixPoint&&(g=g.replace(b.escapeRegex(d.radixPoint),".")),g=g.replace(new RegExp("^"+b.escapeRegex(d.negationSymbol.front)),"-"),g=g.replace(new RegExp(b.escapeRegex(d.negationSymbol.back)+"$"),""),g=g===d.negationSymbol.front?g+"0":g,isFinite(g)&&(null!==d.max&&isFinite(d.max)&&(e=parseFloat(g)<=parseFloat(d.max)),e&&null!==d.min&&isFinite(d.min)&&(0>=g||g.toString().length>=d.min.toString().length)&&(e=parseFloat(g)>=parseFloat(d.min),e||(e=a.extend(!0,{refreshFromBuffer:!0,buffer:(d.prefix+d.min).split("")},d.postFormat((d.prefix+d.min).split(""),0,!0,d)),e.refreshFromBuffer=!0))),e},definitions:{"~":{validator:function(c,d,e,f,g){var h=g.signHandler(c,d,e,f,g);if(!h&&(h=g.radixHandler(c,d,e,f,g),!h&&(h=f?new RegExp("[0-9"+b.escapeRegex(g.groupSeparator)+"]").test(c):new RegExp("[0-9]").test(c),h===!0&&(h=g.leadingZeroHandler(c,d,e,f,g),h===!0)))){var i=a.inArray(g.radixPoint,d.buffer);h=-1!==i&&g.digitsOptional===!1&&g.numericInput!==!0&&e>i&&!f?{pos:e,remove:e}:{pos:e}}return h},cardinality:1,prevalidator:null},"+":{validator:function(a,b,c,d,e){var f=e.signHandler(a,b,c,d,e);return!f&&(d&&e.allowMinus&&a===e.negationSymbol.front||e.allowMinus&&"-"===a||e.allowPlus&&"+"===a)&&(f="-"===a?""!==e.negationSymbol.back?{pos:c,c:"-"===a?e.negationSymbol.front:"+",caret:c+1,insert:{pos:b.buffer.length,c:e.negationSymbol.back}}:{pos:c,c:"-"===a?e.negationSymbol.front:"+",caret:c+1}:!0),f},cardinality:1,prevalidator:null,placeholder:""},"-":{validator:function(a,b,c,d,e){var f=e.signHandler(a,b,c,d,e);return!f&&d&&e.allowMinus&&a===e.negationSymbol.back&&(f=!0),f},cardinality:1,prevalidator:null,placeholder:""},":":{validator:function(a,c,d,e,f){var g=f.signHandler(a,c,d,e,f);if(!g){var h="["+b.escapeRegex(f.radixPoint)+",\\.]";g=new RegExp(h).test(a),g&&c.validPositions[d]&&c.validPositions[d].match.placeholder===f.radixPoint&&(g={caret:d+1})}return g?{c:f.radixPoint}:g},cardinality:1,prevalidator:null,placeholder:function(a){return a.radixPoint}}},onUnMask:function(a,c,d){var e=a.replace(d.prefix,"");return e=e.replace(d.suffix,""),e=e.replace(new RegExp(b.escapeRegex(d.groupSeparator),"g"),""),d.unmaskAsNumber?(""!==d.radixPoint&&-1!==e.indexOf(d.radixPoint)&&(e=e.replace(b.escapeRegex.call(this,d.radixPoint),".")),
            Number(e)):e},isComplete:function(a,c){var d=a.join(""),e=a.slice();if(c.postFormat(e,0,!0,c),e.join("")!==d)return!1;var f=d.replace(c.prefix,"");return f=f.replace(c.suffix,""),f=f.replace(new RegExp(b.escapeRegex(c.groupSeparator),"g"),""),","===c.radixPoint&&(f=f.replace(b.escapeRegex(c.radixPoint),".")),isFinite(f)},onBeforeMask:function(a,c){if(""!==c.radixPoint&&isFinite(a))a=a.toString().replace(".",c.radixPoint);else{var d=a.match(/,/g),e=a.match(/\./g);e&&d?e.length>d.length?(a=a.replace(/\./g,""),a=a.replace(",",c.radixPoint)):d.length>e.length?(a=a.replace(/,/g,""),a=a.replace(".",c.radixPoint)):a=a.indexOf(".")<a.indexOf(",")?a.replace(/\./g,""):a=a.replace(/,/g,""):a=a.replace(new RegExp(b.escapeRegex(c.groupSeparator),"g"),"")}if(0===c.digits&&(-1!==a.indexOf(".")?a=a.substring(0,a.indexOf(".")):-1!==a.indexOf(",")&&(a=a.substring(0,a.indexOf(",")))),""!==c.radixPoint&&isFinite(c.digits)&&-1!==a.indexOf(c.radixPoint)){var f=a.split(c.radixPoint),g=f[1].match(new RegExp("\\d*"))[0];if(parseInt(c.digits)<g.toString().length){var h=Math.pow(10,parseInt(c.digits));a=a.replace(b.escapeRegex(c.radixPoint),"."),a=Math.round(parseFloat(a)*h)/h,a=a.toString().replace(".",c.radixPoint)}}return a.toString()},canClearPosition:function(c,d,e,f,g){var h=c.validPositions[d].input,i=h!==g.radixPoint||null!==c.validPositions[d].match.fn&&g.decimalProtect===!1||isFinite(h)||d===e||h===g.groupSeparator||h===g.negationSymbol.front||h===g.negationSymbol.back;if(i&&isFinite(h)){var j,k=a.inArray(g.radixPoint,c.buffer),l=!1;if(void 0===c.validPositions[k]&&(c.validPositions[k]={input:g.radixPoint},l=!0),!f&&c.buffer){j=c.buffer.join("").substr(0,d).match(g.regex.integerNPart(g));var m=d+1,n=null==j||0===parseInt(j[0].replace(new RegExp(b.escapeRegex(g.groupSeparator),"g"),""));if(n)for(;c.validPositions[m]&&(c.validPositions[m].input===g.groupSeparator||"0"===c.validPositions[m].input);)delete c.validPositions[m],m++}var o=[];for(var p in c.validPositions)void 0!==c.validPositions[p].input&&o.push(c.validPositions[p].input);if(l&&delete c.validPositions[k],k>0){var q=o.join("");if(j=q.match(g.regex.integerNPart(g)))if(k>=d)if(0===j[0].indexOf("0"))i=j.index!==d||"0"===g.placeholder;else{var r=parseInt(j[0].replace(new RegExp(b.escapeRegex(g.groupSeparator),"g"),"")),s=parseInt(q.split(g.radixPoint)[1]);10>r&&c.validPositions[d]&&("0"!==g.placeholder||s>0)&&(c.validPositions[d].input="0",c.p=g.prefix.length+1,i=!1)}else 0===j[0].indexOf("0")&&3===q.length&&(c.validPositions={},i=!1)}}return i},onKeyDown:function(c,d,e,f){var g=a(this);if(c.ctrlKey)switch(c.keyCode){case b.keyCode.UP:g.val(parseFloat(this.inputmask.unmaskedvalue())+parseInt(f.step)),g.trigger("setvalue.inputmask");break;case b.keyCode.DOWN:g.val(parseFloat(this.inputmask.unmaskedvalue())-parseInt(f.step)),g.trigger("setvalue.inputmask")}}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:0,radixPoint:""},percentage:{alias:"numeric",digits:2,radixPoint:".",placeholder:"0",autoGroup:!1,min:0,max:100,suffix:" %",allowPlus:!1,allowMinus:!1}}),b}(jQuery,Inputmask),function(a,b){return b.extendAliases({phone:{url:"phone-codes/phone-codes.js",countrycode:"",mask:function(b){b.definitions["#"]=b.definitions[9];var c=[];return a.ajax({url:b.url,async:!1,dataType:"json",success:function(a){c=a},error:function(a,c,d){alert(d+" - "+b.url)}}),c=c.sort(function(a,b){return(a.mask||a)<(b.mask||b)?-1:1})},keepStatic:!1,nojumps:!0,nojumpsThreshold:1,onBeforeMask:function(a,b){var c=a.replace(/^0/g,"");return(c.indexOf(b.countrycode)>1||-1===c.indexOf(b.countrycode))&&(c="+"+b.countrycode+c),c}},phonebe:{alias:"phone",url:"phone-codes/phone-be.js",countrycode:"32",nojumpsThreshold:4}}),b}(jQuery,Inputmask),function(a,b){return b.extendAliases({Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,isComplete:function(a,b){return new RegExp(b.regex).test(a.join(""))},definitions:{r:{validator:function(b,c,d,e,f){function g(a,b){this.matches=[],this.isGroup=a||!1,this.isQuantifier=b||!1,this.quantifier={min:1,max:1},this.repeaterPart=void 0}function h(){var a,b,c=new g,d=[];for(f.regexTokens=[];a=f.tokenizer.exec(f.regex);)switch(b=a[0],b.charAt(0)){case"(":d.push(new g(!0));break;case")":j=d.pop(),d.length>0?d[d.length-1].matches.push(j):c.matches.push(j);break;case"{":case"+":case"*":var e=new g(!1,!0);b=b.replace(/[{}]/g,"");var h=b.split(","),i=isNaN(h[0])?h[0]:parseInt(h[0]),k=1===h.length?i:isNaN(h[1])?h[1]:parseInt(h[1]);if(e.quantifier={min:i,max:k},d.length>0){var l=d[d.length-1].matches;a=l.pop(),a.isGroup||(j=new g(!0),j.matches.push(a),a=j),l.push(a),l.push(e)}else a=c.matches.pop(),a.isGroup||(j=new g(!0),j.matches.push(a),a=j),c.matches.push(a),c.matches.push(e);break;default:d.length>0?d[d.length-1].matches.push(b):c.matches.push(b)}c.matches.length>0&&f.regexTokens.push(c)}function i(b,c){var d=!1;c&&(l+="(",n++);for(var e=0;e<b.matches.length;e++){var f=b.matches[e];if(f.isGroup===!0)d=i(f,!0);else if(f.isQuantifier===!0){var g=a.inArray(f,b.matches),h=b.matches[g-1],j=l;if(isNaN(f.quantifier.max)){for(;f.repeaterPart&&f.repeaterPart!==l&&f.repeaterPart.length>l.length&&!(d=i(h,!0)););d=d||i(h,!0),d&&(f.repeaterPart=l),l=j+f.quantifier.max}else{for(var k=0,m=f.quantifier.max-1;m>k&&!(d=i(h,!0));k++);l=j+"{"+f.quantifier.min+","+f.quantifier.max+"}"}}else if(void 0!==f.matches)for(var p=0;p<f.length&&!(d=i(f[p],c));p++);else{var q;if("["==f.charAt(0)){q=l,q+=f;for(var r=0;n>r;r++)q+=")";var s=new RegExp("^("+q+")$");d=s.test(o)}else for(var t=0,u=f.length;u>t;t++)if("\\"!==f.charAt(t)){q=l,q+=f.substr(0,t+1),q=q.replace(/\|$/,"");for(var r=0;n>r;r++)q+=")";var s=new RegExp("^("+q+")$");if(d=s.test(o))break}l+=f}if(d)break}return c&&(l+=")",n--),d}var j,k=c.buffer.slice(),l="",m=!1,n=0;null===f.regexTokens&&h(),k.splice(d,0,b);for(var o=k.join(""),p=0;p<f.regexTokens.length;p++){var q=f.regexTokens[p];if(m=i(q,q.isGroup))break}return m},cardinality:1}}}}),b}(jQuery,Inputmask);
;
(function(root,factory){if(typeof define==='function'&&define.amd){define('sifter',factory)}else if(typeof exports==='object'){module.exports=factory()}else root.Sifter=factory()}(this,function(){var Sifter=function(items,settings){this.items=items;this.settings=settings||{diacritics:true}};Sifter.prototype.tokenize=function(query){query=trim(String(query||'').toLowerCase());if(!query||!query.length)return[];var i,n,regex,letter,tokens=[],words=query.split(/ +/);for(i=0,n=words.length;i<n;i++){regex=escape_regex(words[i]);if(this.settings.diacritics)for(letter in DIACRITICS)if(DIACRITICS.hasOwnProperty(letter))regex=regex.replace(new RegExp(letter,'g'),DIACRITICS[letter]);tokens.push({string:words[i],regex:new RegExp(regex,'i')})};return tokens};Sifter.prototype.iterator=function(object,callback){var iterator;if(is_array(object)){iterator=Array.prototype.forEach||function(callback){for(var i=0,n=this.length;i<n;i++)callback(this[i],i,this)}}else iterator=function(callback){for(var key in this)if(this.hasOwnProperty(key))callback(this[key],key,this)};iterator.apply(object,[callback])};Sifter.prototype.getScoreFunction=function(search,options){var self,fields,tokens,token_count;self=this;search=self.prepareSearch(search,options);tokens=search.tokens;fields=search.options.fields;token_count=tokens.length;var scoreValue=function(value,token){var score,pos;if(!value)return 0;value=String(value||'');pos=value.search(token.regex);if(pos===-1)return 0;score=token.string.length/value.length;if(pos===0)score+=0.5;return score},scoreObject=(function(){var field_count=fields.length;if(!field_count)return function(){return 0};if(field_count===1)return function(token,data){return scoreValue(data[fields[0]],token)};return function(token,data){for(var i=0,sum=0;i<field_count;i++)sum+=scoreValue(data[fields[i]],token);return sum/field_count}})();if(!token_count)return function(){return 0};if(token_count===1)return function(data){return scoreObject(tokens[0],data)};if(search.options.conjunction==='and'){return function(data){var score;for(var i=0,sum=0;i<token_count;i++){score=scoreObject(tokens[i],data);if(score<=0)return 0;sum+=score};return sum/token_count}}else return function(data){for(var i=0,sum=0;i<token_count;i++)sum+=scoreObject(tokens[i],data);return sum/token_count}};Sifter.prototype.getSortFunction=function(search,options){var i,n,self,field,fields,fields_count,multiplier,multipliers,get_field,implicit_score,sort;self=this;search=self.prepareSearch(search,options);sort=(!search.query&&options.sort_empty)||options.sort;get_field=function(name,result){if(name==='$score')return result.score;return self.items[result.id][name]};fields=[];if(sort)for(i=0,n=sort.length;i<n;i++)if(search.query||sort[i].field!=='$score')fields.push(sort[i]);if(search.query){implicit_score=true;for(i=0,n=fields.length;i<n;i++)if(fields[i].field==='$score'){implicit_score=false;break};if(implicit_score)fields.unshift({field:'$score',direction:'desc'})}else for(i=0,n=fields.length;i<n;i++)if(fields[i].field==='$score'){fields.splice(i,1);break};multipliers=[];for(i=0,n=fields.length;i<n;i++)multipliers.push(fields[i].direction==='desc'?-1:1);fields_count=fields.length;if(!fields_count){return null}else if(fields_count===1){field=fields[0].field;multiplier=multipliers[0];return function(a,b){return multiplier*cmp(get_field(field,a),get_field(field,b))}}else return function(a,b){var i,result,a_value,b_value,field;for(i=0;i<fields_count;i++){field=fields[i].field;result=multipliers[i]*cmp(get_field(field,a),get_field(field,b));if(result)return result};return 0}};Sifter.prototype.prepareSearch=function(query,options){if(typeof query==='object')return query;options=extend({},options);var option_fields=options.fields,option_sort=options.sort,option_sort_empty=options.sort_empty;if(option_fields&&!is_array(option_fields))options.fields=[option_fields];if(option_sort&&!is_array(option_sort))options.sort=[option_sort];if(option_sort_empty&&!is_array(option_sort_empty))options.sort_empty=[option_sort_empty];return{options:options,query:String(query||'').toLowerCase(),tokens:this.tokenize(query),total:0,items:[]}};Sifter.prototype.search=function(query,options){var self=this,value,score,search,calculateScore,fn_sort,fn_score;search=this.prepareSearch(query,options);options=search.options;query=search.query;fn_score=options.score||self.getScoreFunction(search);if(query.length){self.iterator(self.items,function(item,id){score=fn_score(item);if(options.filter===false||score>0)search.items.push({score:score,id:id})})}else self.iterator(self.items,function(item,id){search.items.push({score:1,id:id})});fn_sort=self.getSortFunction(search,options);if(fn_sort)search.items.sort(fn_sort);search.total=search.items.length;if(typeof options.limit==='number')search.items=search.items.slice(0,options.limit);return search};var cmp=function(a,b){if(typeof a==='number'&&typeof b==='number')return a>b?1:(a<b?-1:0);a=asciifold(String(a||''));b=asciifold(String(b||''));if(a>b)return 1;if(b>a)return-1;return 0},extend=function(a,b){var i,n,k,object;for(i=1,n=arguments.length;i<n;i++){object=arguments[i];if(!object)continue;for(k in object)if(object.hasOwnProperty(k))a[k]=object[k]};return a},trim=function(str){return(str+'').replace(/^\s+|\s+$|/g,'')},escape_regex=function(str){return(str+'').replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1')},is_array=Array.isArray||($&&$.isArray)||function(object){return Object.prototype.toString.call(object)==='[object Array]'},DIACRITICS={a:'[aÀÁÂÃÄÅàáâãäåĀāąĄ]',c:'[cÇçćĆčČ]',d:'[dđĐďĎ]',e:'[eÈÉÊËèéêëěĚĒēęĘ]',i:'[iÌÍÎÏìíîïĪī]',l:'[lłŁ]',n:'[nÑñňŇńŃ]',o:'[oÒÓÔÕÕÖØòóôõöøŌō]',r:'[rřŘ]',s:'[sŠšśŚ]',t:'[tťŤ]',u:'[uÙÚÛÜùúûüůŮŪū]',y:'[yŸÿýÝ]',z:'[zŽžżŻźŹ]'},asciifold=(function(){var i,n,k,chunk,foreignletters='',lookup={};for(k in DIACRITICS)if(DIACRITICS.hasOwnProperty(k)){chunk=DIACRITICS[k].substring(2,DIACRITICS[k].length-1);foreignletters+=chunk;for(i=0,n=chunk.length;i<n;i++)lookup[chunk.charAt(i)]=k};var regexp=new RegExp('['+foreignletters+']','g');return function(str){return str.replace(regexp,function(foreignletter){return lookup[foreignletter]}).toLowerCase()}})();return Sifter}));(function(root,factory){if(typeof define==='function'&&define.amd){define('microplugin',factory)}else if(typeof exports==='object'){module.exports=factory()}else root.MicroPlugin=factory()}(this,function(){var MicroPlugin={};MicroPlugin.mixin=function(Interface){Interface.plugins={};Interface.prototype.initializePlugins=function(plugins){var i,n,key,self=this,queue=[];self.plugins={names:[],settings:{},requested:{},loaded:{}};if(utils.isArray(plugins)){for(i=0,n=plugins.length;i<n;i++)if(typeof plugins[i]==='string'){queue.push(plugins[i])}else{self.plugins.settings[plugins[i].name]=plugins[i].options;queue.push(plugins[i].name)}}else if(plugins)for(key in plugins)if(plugins.hasOwnProperty(key)){self.plugins.settings[key]=plugins[key];queue.push(key)};while(queue.length)self.require(queue.shift())};Interface.prototype.loadPlugin=function(name){var self=this,plugins=self.plugins,plugin=Interface.plugins[name];if(!Interface.plugins.hasOwnProperty(name))throw new Error('Unable to find "'+name+'" plugin');plugins.requested[name]=true;plugins.loaded[name]=plugin.fn.apply(self,[self.plugins.settings[name]||{}]);plugins.names.push(name)};Interface.prototype.require=function(name){var self=this,plugins=self.plugins;if(!self.plugins.loaded.hasOwnProperty(name)){if(plugins.requested[name])throw new Error('Plugin has circular dependency ("'+name+'")');self.loadPlugin(name)};return plugins.loaded[name]};Interface.define=function(name,fn){Interface.plugins[name]={name:name,fn:fn}}};var utils={isArray:Array.isArray||function(vArg){return Object.prototype.toString.call(vArg)==='[object Array]'}};return MicroPlugin}));(function(root,factory){if(typeof define==='function'&&define.amd){define('selectize',['jquery','sifter','microplugin'],factory)}else if(typeof exports==='object'){module.exports=factory(require('jquery'),require('sifter'),require('microplugin'))}else root.Selectize=factory(root.jQuery,root.Sifter,root.MicroPlugin)}(this,function($,Sifter,MicroPlugin){'use strict';var highlight=function($element,pattern){if(typeof pattern==='string'&&!pattern.length)return;var regex=(typeof pattern==='string')?new RegExp(pattern,'i'):pattern,highlight=function(node){var skip=0;if(node.nodeType===3){var pos=node.data.search(regex);if(pos>=0&&node.data.length>0){var match=node.data.match(regex),spannode=document.createElement('span');spannode.className='highlight';var middlebit=node.splitText(pos),endbit=middlebit.splitText(match[0].length),middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);skip=1}}else if(node.nodeType===1&&node.childNodes&&!/(script|style)/i.test(node.tagName))for(var i=0;i<node.childNodes.length;++i)i+=highlight(node.childNodes[i]);return skip};return $element.each(function(){highlight(this)})},MicroEvent=function(){};MicroEvent.prototype={on:function(event,fct){this._events=this._events||{};this._events[event]=this._events[event]||[];this._events[event].push(fct)},off:function(event,fct){var n=arguments.length;if(n===0)return delete this._events;if(n===1)return delete this._events[event];this._events=this._events||{};if(event in this._events===false)return;this._events[event].splice(this._events[event].indexOf(fct),1)},trigger:function(event){this._events=this._events||{};if(event in this._events===false)return;for(var i=0;i<this._events[event].length;i++)this._events[event][i].apply(this,Array.prototype.slice.call(arguments,1))}};MicroEvent.mixin=function(destObject){var props=['on','off','trigger'];for(var i=0;i<props.length;i++)destObject.prototype[props[i]]=MicroEvent.prototype[props[i]]};var IS_MAC=/Mac/.test(navigator.userAgent),KEY_A=65,KEY_COMMA=188,KEY_RETURN=13,KEY_ESC=27,KEY_LEFT=37,KEY_UP=38,KEY_P=80,KEY_RIGHT=39,KEY_DOWN=40,KEY_N=78,KEY_BACKSPACE=8,KEY_DELETE=46,KEY_SHIFT=16,KEY_CMD=IS_MAC?91:17,KEY_CTRL=IS_MAC?18:17,KEY_TAB=9,TAG_SELECT=1,TAG_INPUT=2,SUPPORTS_VALIDITY_API=!/android/i.test(window.navigator.userAgent)&&!!document.createElement('form').validity,isset=function(object){return typeof object!=='undefined'},hash_key=function(value){if(typeof value==='undefined'||value===null)return null;if(typeof value==='boolean')return value?'1':'0';return value+''},escape_html=function(str){return(str+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')},escape_replace=function(str){return(str+'').replace(/\$/g,'$$$$')},hook={};hook.before=function(self,method,fn){var original=self[method];self[method]=function(){fn.apply(self,arguments);return original.apply(self,arguments)}};hook.after=function(self,method,fn){var original=self[method];self[method]=function(){var result=original.apply(self,arguments);fn.apply(self,arguments);return result}};var once=function(fn){var called=false;return function(){if(called)return;called=true;fn.apply(this,arguments)}},debounce=function(fn,delay){var timeout;return function(){var self=this,args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(self,args)},delay)}},debounce_events=function(self,types,fn){var type,trigger=self.trigger,event_args={};self.trigger=function(){var type=arguments[0];if(types.indexOf(type)!==-1){event_args[type]=arguments}else return trigger.apply(self,arguments)};fn.apply(self,[]);self.trigger=trigger;for(type in event_args)if(event_args.hasOwnProperty(type))trigger.apply(self,event_args[type])},watchChildEvent=function($parent,event,selector,fn){$parent.on(event,selector,function(e){var child=e.target;while(child&&child.parentNode!==$parent[0])child=child.parentNode;e.currentTarget=child;return fn.apply(this,[e])})},getSelection=function(input){var result={};if('selectionStart'in input){result.start=input.selectionStart;result.length=input.selectionEnd-result.start}else if(document.selection){input.focus();var sel=document.selection.createRange(),selLen=document.selection.createRange().text.length;sel.moveStart('character',-input.value.length);result.start=sel.text.length-selLen;result.length=selLen};return result},transferStyles=function($from,$to,properties){var i,n,styles={};if(properties){for(i=0,n=properties.length;i<n;i++)styles[properties[i]]=$from.css(properties[i])}else styles=$from.css();$to.css(styles)},measureString=function(str,$parent){if(!str)return 0;var $test=$('<test>').css({position:'absolute',top:-99999,left:-99999,width:'auto',padding:0,whiteSpace:'pre'}).text(str).appendTo('body');transferStyles($parent,$test,['letterSpacing','fontSize','fontFamily','fontWeight','textTransform']);var width=$test.width();$test.remove();return width},autoGrow=function($input){var currentWidth=null,update=function(e,options){var value,keyCode,printable,placeholder,width,shift,character,selection;e=e||window.event||{};options=options||{};if(e.metaKey||e.altKey)return;if(!options.force&&$input.data('grow')===false)return;value=$input.val();if(e.type&&e.type.toLowerCase()==='keydown'){keyCode=e.keyCode;printable=((keyCode>=97&&keyCode<=122)||(keyCode>=65&&keyCode<=90)||(keyCode>=48&&keyCode<=57)||keyCode===32);if(keyCode===KEY_DELETE||keyCode===KEY_BACKSPACE){selection=getSelection($input[0]);if(selection.length){value=value.substring(0,selection.start)+value.substring(selection.start+selection.length)}else if(keyCode===KEY_BACKSPACE&&selection.start){value=value.substring(0,selection.start-1)+value.substring(selection.start+1)}else if(keyCode===KEY_DELETE&&typeof selection.start!=='undefined')value=value.substring(0,selection.start)+value.substring(selection.start+1)}else if(printable){shift=e.shiftKey;character=String.fromCharCode(e.keyCode);if(shift){character=character.toUpperCase()}else character=character.toLowerCase();value+=character}};placeholder=$input.attr('placeholder');if(!value&&placeholder)value=placeholder;width=measureString(value,$input)+4;if(width!==currentWidth){currentWidth=width;$input.width(width);$input.triggerHandler('resize')}};$input.on('keydown keyup update blur',update);update()},Selectize=function($input,settings){var key,i,n,dir,input,self=this;input=$input[0];input.selectize=self;var computedStyle=window.getComputedStyle&&window.getComputedStyle(input,null);dir=computedStyle?computedStyle.getPropertyValue('direction'):input.currentStyle&&input.currentStyle.direction;dir=dir||$input.parents('[dir]:first').attr('dir')||'';$.extend(self,{order:0,settings:settings,$input:$input,tabIndex:$input.attr('tabindex')||'',tagType:input.tagName.toLowerCase()==='select'?TAG_SELECT:TAG_INPUT,rtl:/rtl/i.test(dir),eventNS:'.selectize'+(++Selectize.count),highlightedValue:null,isOpen:false,isDisabled:false,isRequired:$input.is('[required]'),isInvalid:false,isLocked:false,isFocused:false,isInputHidden:false,isSetup:false,isShiftDown:false,isCmdDown:false,isCtrlDown:false,ignoreFocus:false,ignoreBlur:false,ignoreHover:false,hasOptions:false,currentResults:null,lastValue:'',caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:settings.loadThrottle===null?self.onSearchChange:debounce(self.onSearchChange,settings.loadThrottle)});self.sifter=new Sifter(this.options,{diacritics:settings.diacritics});if(self.settings.options){for(i=0,n=self.settings.options.length;i<n;i++)self.registerOption(self.settings.options[i]);delete self.settings.options};if(self.settings.optgroups){for(i=0,n=self.settings.optgroups.length;i<n;i++)self.registerOptionGroup(self.settings.optgroups[i]);delete self.settings.optgroups};self.settings.mode=self.settings.mode||(self.settings.maxItems===1?'single':'multi');if(typeof self.settings.hideSelected!=='boolean')self.settings.hideSelected=self.settings.mode==='multi';self.initializePlugins(self.settings.plugins);self.setupCallbacks();self.setupTemplates();self.setup()};MicroEvent.mixin(Selectize);MicroPlugin.mixin(Selectize);$.extend(Selectize.prototype,{setup:function(){var self=this,settings=self.settings,eventNS=self.eventNS,$window=$(window),$document=$(document),$input=self.$input,$wrapper,$control,$control_input,$dropdown,$dropdown_content,$dropdown_parent,inputMode,timeout_blur,timeout_focus,classes,classes_plugins;inputMode=self.settings.mode;classes=$input.attr('class')||'';$wrapper=$('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode);$control=$('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper);$control_input=$('<input type="text" autocomplete="off" />').appendTo($control).attr('tabindex',$input.is(':disabled')?'-1':self.tabIndex);$dropdown_parent=$(settings.dropdownParent||$wrapper);$dropdown=$('<div>').addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent);$dropdown_content=$('<div>').addClass(settings.dropdownContentClass).appendTo($dropdown);if(self.settings.copyClassesToDropdown)$dropdown.addClass(classes);$wrapper.css({width:$input[0].style.width});if(self.plugins.names.length){classes_plugins='plugin-'+self.plugins.names.join(' plugin-');$wrapper.addClass(classes_plugins);$dropdown.addClass(classes_plugins)};if((settings.maxItems===null||settings.maxItems>1)&&self.tagType===TAG_SELECT)$input.attr('multiple','multiple');if(self.settings.placeholder)$control_input.attr('placeholder',settings.placeholder);if(!self.settings.splitOn&&self.settings.delimiter){var delimiterEscaped=self.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');self.settings.splitOn=new RegExp('\\s*'+delimiterEscaped+'+\\s*')};if($input.attr('autocorrect'))$control_input.attr('autocorrect',$input.attr('autocorrect'));if($input.attr('autocapitalize'))$control_input.attr('autocapitalize',$input.attr('autocapitalize'));self.$wrapper=$wrapper;self.$control=$control;self.$control_input=$control_input;self.$dropdown=$dropdown;self.$dropdown_content=$dropdown_content;$dropdown.on('mouseenter','[data-selectable]',function(){return self.onOptionHover.apply(self,arguments)});$dropdown.on('mousedown click','[data-selectable]',function(){return self.onOptionSelect.apply(self,arguments)});watchChildEvent($control,'mousedown','*:not(input)',function(){return self.onItemSelect.apply(self,arguments)});autoGrow($control_input);$control.on({mousedown:function(){return self.onMouseDown.apply(self,arguments)},click:function(){return self.onClick.apply(self,arguments)}});$control_input.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return self.onKeyDown.apply(self,arguments)},keyup:function(){return self.onKeyUp.apply(self,arguments)},keypress:function(){return self.onKeyPress.apply(self,arguments)},resize:function(){self.positionDropdown.apply(self,[])},blur:function(){return self.onBlur.apply(self,arguments)},focus:function(){self.ignoreBlur=false;return self.onFocus.apply(self,arguments)},paste:function(){return self.onPaste.apply(self,arguments)}});$document.on('keydown'+eventNS,function(e){self.isCmdDown=e[IS_MAC?'metaKey':'ctrlKey'];self.isCtrlDown=e[IS_MAC?'altKey':'ctrlKey'];self.isShiftDown=e.shiftKey});$document.on('keyup'+eventNS,function(e){if(e.keyCode===KEY_CTRL)self.isCtrlDown=false;if(e.keyCode===KEY_SHIFT)self.isShiftDown=false;if(e.keyCode===KEY_CMD)self.isCmdDown=false});$document.on('mousedown'+eventNS,function(e){if(self.isFocused){if(e.target===self.$dropdown[0]||e.target.parentNode===self.$dropdown[0])return false;if(!self.$control.has(e.target).length&&e.target!==self.$control[0])self.blur(e.target)}});$window.on(['scroll'+eventNS,'resize'+eventNS].join(' '),function(){if(self.isOpen)self.positionDropdown.apply(self,arguments)});$window.on('mousemove'+eventNS,function(){self.ignoreHover=false});this.revertSettings={$children:$input.children().detach(),tabindex:$input.attr('tabindex')};$input.attr('tabindex',-1).hide().after(self.$wrapper);if($.isArray(settings.items)){self.setValue(settings.items);delete settings.items};if(SUPPORTS_VALIDITY_API)$input.on('invalid'+eventNS,function(e){e.preventDefault();self.isInvalid=true;self.refreshState()});self.updateOriginalInput();self.refreshItems();self.refreshState();self.updatePlaceholder();self.isSetup=true;if($input.is(':disabled'))self.disable();self.on('change',this.onChange);$input.data('selectize',self);$input.addClass('selectized');self.trigger('initialize');if(settings.preload===true)self.onSearchChange('')},setupTemplates:function(){var self=this,field_label=self.settings.labelField,field_optgroup=self.settings.optgroupLabelField,templates={optgroup:function(data){return'<div class="optgroup">'+data.html+'</div>'},optgroup_header:function(data,escape){return'<div class="optgroup-header">'+escape(data[field_optgroup])+'</div>'},option:function(data,escape){return'<div class="option">'+escape(data[field_label])+'</div>'},item:function(data,escape){return'<div class="item">'+escape(data[field_label])+'</div>'},option_create:function(data,escape){return'<div class="create">Add <strong>'+escape(data.input)+'</strong>&hellip;</div>'}};self.settings.render=$.extend({},templates,self.settings.render)},setupCallbacks:function(){var key,fn,callbacks={initialize:'onInitialize',change:'onChange',item_add:'onItemAdd',item_remove:'onItemRemove',clear:'onClear',option_add:'onOptionAdd',option_remove:'onOptionRemove',option_clear:'onOptionClear',optgroup_add:'onOptionGroupAdd',optgroup_remove:'onOptionGroupRemove',optgroup_clear:'onOptionGroupClear',dropdown_open:'onDropdownOpen',dropdown_close:'onDropdownClose',type:'onType',load:'onLoad',focus:'onFocus',blur:'onBlur'};for(key in callbacks)if(callbacks.hasOwnProperty(key)){fn=this.settings[callbacks[key]];if(fn)this.on(key,fn)}},onClick:function(e){var self=this;if(!self.isFocused){self.focus();e.preventDefault()}},onMouseDown:function(e){var self=this,defaultPrevented=e.isDefaultPrevented(),$target=$(e.target);if(self.isFocused){if(e.target!==self.$control_input[0]){if(self.settings.mode==='single'){self.isOpen?self.close():self.open()}else if(!defaultPrevented)self.setActiveItem(null);return false}}else if(!defaultPrevented)window.setTimeout(function(){self.focus()},0)},onChange:function(){this.$input.trigger('change')},onPaste:function(e){var self=this;if(self.isFull()||self.isInputHidden||self.isLocked){e.preventDefault()}else if(self.settings.splitOn)setTimeout(function(){var splitInput=$.trim(self.$control_input.val()||'').split(self.settings.splitOn);for(var i=0,n=splitInput.length;i<n;i++)self.createItem(splitInput[i])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var character=String.fromCharCode(e.keyCode||e.which);if(this.settings.create&&this.settings.mode==='multi'&&character===this.settings.delimiter){this.createItem();e.preventDefault();return false}},onKeyDown:function(e){var isInput=e.target===this.$control_input[0],self=this;if(self.isLocked){if(e.keyCode!==KEY_TAB)e.preventDefault();return};switch(e.keyCode){case KEY_A:if(self.isCmdDown){self.selectAll();return};break;case KEY_ESC:if(self.isOpen){e.preventDefault();e.stopPropagation();self.close()};return;case KEY_N:if(!e.ctrlKey||e.altKey)break;case KEY_DOWN:if(!self.isOpen&&self.hasOptions){self.open()}else if(self.$activeOption){self.ignoreHover=true;var $next=self.getAdjacentOption(self.$activeOption,1);if($next.length)self.setActiveOption($next,true,true)};e.preventDefault();return;case KEY_P:if(!e.ctrlKey||e.altKey)break;case KEY_UP:if(self.$activeOption){self.ignoreHover=true;var $prev=self.getAdjacentOption(self.$activeOption,-1);if($prev.length)self.setActiveOption($prev,true,true)};e.preventDefault();return;case KEY_RETURN:if(self.isOpen&&self.$activeOption){self.onOptionSelect({currentTarget:self.$activeOption});e.preventDefault()};return;case KEY_LEFT:self.advanceSelection(-1,e);return;case KEY_RIGHT:self.advanceSelection(1,e);return;case KEY_TAB:if(self.settings.selectOnTab&&self.isOpen&&self.$activeOption){self.onOptionSelect({currentTarget:self.$activeOption});if(!self.isFull())e.preventDefault()};if(self.settings.create&&self.createItem())e.preventDefault();return;case KEY_BACKSPACE:case KEY_DELETE:self.deleteSelection(e);return};if((self.isFull()||self.isInputHidden)&&!(IS_MAC?e.metaKey:e.ctrlKey)){e.preventDefault();return}},onKeyUp:function(e){var self=this;if(self.isLocked)return e&&e.preventDefault();var value=self.$control_input.val()||'';if(self.lastValue!==value){self.lastValue=value;self.onSearchChange(value);self.refreshOptions();self.trigger('type',value)}},onSearchChange:function(value){var self=this,fn=self.settings.load;if(!fn)return;if(self.loadedSearches.hasOwnProperty(value))return;self.loadedSearches[value]=true;self.load(function(callback){fn.apply(self,[value,callback])})},onFocus:function(e){var self=this,wasFocused=self.isFocused;if(self.isDisabled){self.blur();e&&e.preventDefault();return false};if(self.ignoreFocus)return;self.isFocused=true;if(self.settings.preload==='focus')self.onSearchChange('');if(!wasFocused)self.trigger('focus');if(!self.$activeItems.length){self.showInput();self.setActiveItem(null);self.refreshOptions(!!self.settings.openOnFocus)};self.refreshState()},onBlur:function(e,dest){var self=this;if(!self.isFocused)return;self.isFocused=false;if(self.ignoreFocus){return}else if(!self.ignoreBlur&&document.activeElement===self.$dropdown_content[0]){self.ignoreBlur=true;self.onFocus(e);return};var deactivate=function(){self.close();self.setTextboxValue('');self.setActiveItem(null);self.setActiveOption(null);self.setCaret(self.items.length);self.refreshState();(dest||document.body).focus();self.ignoreFocus=false;self.trigger('blur')};self.ignoreFocus=true;if(self.settings.createOnBlur){self.onOptionSelect({currentTarget:self.$activeOption})}else deactivate()},onOptionHover:function(e){if(this.ignoreHover)return;this.setActiveOption(e.currentTarget,false)},onOptionSelect:function(e){var value,$target,$option,self=this;if(e.preventDefault){e.preventDefault();e.stopPropagation()};$target=$(e.currentTarget);if($target.hasClass('create')){self.createItem(null,function(){if(self.settings.closeAfterSelect)self.close()})}else{value=$target.attr('data-value');if(typeof value!=='undefined'){self.lastQuery=null;self.setTextboxValue('');self.addItem(value);if(self.settings.closeAfterSelect){self.close()}else if(!self.settings.hideSelected&&e.type&&/mouse/.test(e.type))self.setActiveOption(self.getOption(value))}}},onItemSelect:function(e){var self=this;if(self.isLocked)return;if(self.settings.mode==='multi'){e.preventDefault();self.setActiveItem(e.currentTarget,e)}},load:function(fn){var self=this,$wrapper=self.$wrapper.addClass(self.settings.loadingClass);self.loading++;fn.apply(self,[function(results){self.loading=Math.max(self.loading-1,0);if(results&&results.length){self.addOption(results);self.refreshOptions(self.isFocused&&!self.isInputHidden)};if(!self.loading)$wrapper.removeClass(self.settings.loadingClass);self.trigger('load',results)}])},setTextboxValue:function(value){var $input=this.$control_input,changed=$input.val()!==value;if(changed){$input.val(value).triggerHandler('update');this.lastValue=value}},getValue:function(){if(this.tagType===TAG_SELECT&&this.$input.attr('multiple')){return this.items}else return this.items.join(this.settings.delimiter)},setValue:function(value,silent){var events=silent?[]:['change'];debounce_events(this,events,function(){this.clear(silent);this.addItems(value,silent)})},setActiveItem:function($item,e){var self=this,eventName,i,idx,begin,end,item,swap,$last;if(self.settings.mode==='single')return;$item=$($item);if(!$item.length){$(self.$activeItems).removeClass('active');self.$activeItems=[];if(self.isFocused)self.showInput();return};eventName=e&&e.type.toLowerCase();if(eventName==='mousedown'&&self.isShiftDown&&self.$activeItems.length){$last=self.$control.children('.active:last');begin=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$last[0]]);end=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$item[0]]);if(begin>end){swap=begin;begin=end;end=swap};for(i=begin;i<=end;i++){item=self.$control[0].childNodes[i];if(self.$activeItems.indexOf(item)===-1){$(item).addClass('active');self.$activeItems.push(item)}};e.preventDefault()}else if((eventName==='mousedown'&&self.isCtrlDown)||(eventName==='keydown'&&this.isShiftDown)){if($item.hasClass('active')){idx=self.$activeItems.indexOf($item[0]);self.$activeItems.splice(idx,1);$item.removeClass('active')}else self.$activeItems.push($item.addClass('active')[0])}else{$(self.$activeItems).removeClass('active');self.$activeItems=[$item.addClass('active')[0]]};self.hideInput();if(!this.isFocused)self.focus()},setActiveOption:function($option,scroll,animate){var height_menu,height_item,y,scroll_top,scroll_bottom,self=this;if(self.$activeOption)self.$activeOption.removeClass('active');self.$activeOption=null;$option=$($option);if(!$option.length)return;self.$activeOption=$option.addClass('active');if(scroll||!isset(scroll)){height_menu=self.$dropdown_content.height();height_item=self.$activeOption.outerHeight(true);scroll=self.$dropdown_content.scrollTop()||0;y=self.$activeOption.offset().top-self.$dropdown_content.offset().top+scroll;scroll_top=y;scroll_bottom=y-height_menu+height_item;if(y+height_item>height_menu+scroll){self.$dropdown_content.stop().animate({scrollTop:scroll_bottom},animate?self.settings.scrollDuration:0)}else if(y<scroll)self.$dropdown_content.stop().animate({scrollTop:scroll_top},animate?self.settings.scrollDuration:0)}},selectAll:function(){var self=this;if(self.settings.mode==='single')return;self.$activeItems=Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active'));if(self.$activeItems.length){self.hideInput();self.close()};self.focus()},hideInput:function(){var self=this;self.setTextboxValue('');self.$control_input.css({opacity:0,position:'absolute',left:self.rtl?1e4:-1e4});self.isInputHidden=true},showInput:function(){this.$control_input.css({opacity:1,position:'relative',left:0});this.isInputHidden=false},focus:function(){var self=this;if(self.isDisabled)return;self.ignoreFocus=true;self.$control_input[0].focus();window.setTimeout(function(){self.ignoreFocus=false;self.onFocus()},0)},blur:function(dest){this.$control_input[0].blur();this.onBlur(null,dest)},getScoreFunction:function(query){return this.sifter.getScoreFunction(query,this.getSearchOptions())},getSearchOptions:function(){var settings=this.settings,sort=settings.sortField;if(typeof sort==='string')sort=[{field:sort}];return{fields:settings.searchField,conjunction:settings.searchConjunction,sort:sort}},search:function(query){var i,value,score,result,calculateScore,self=this,settings=self.settings,options=this.getSearchOptions();if(settings.score){calculateScore=self.settings.score.apply(this,[query]);if(typeof calculateScore!=='function')throw new Error('Selectize "score" setting must be a function that returns a function')};if(query!==self.lastQuery){self.lastQuery=query;result=self.sifter.search(query,$.extend(options,{score:calculateScore}));self.currentResults=result}else result=$.extend(true,{},self.currentResults);if(settings.hideSelected)for(i=result.items.length-1;i>=0;i--)if(self.items.indexOf(hash_key(result.items[i].id))!==-1)result.items.splice(i,1);return result},refreshOptions:function(triggerDropdown){var i,j,k,n,groups,groups_order,option,option_html,optgroup,optgroups,html,html_children,has_create_option,$active,$active_before,$create;if(typeof triggerDropdown==='undefined')triggerDropdown=true;var self=this,query=$.trim(self.$control_input.val()),results=self.search(query),$dropdown_content=self.$dropdown_content,active_before=self.$activeOption&&hash_key(self.$activeOption.attr('data-value'));n=results.items.length;if(typeof self.settings.maxOptions==='number')n=Math.min(n,self.settings.maxOptions);groups={};groups_order=[];for(i=0;i<n;i++){option=self.options[results.items[i].id];option_html=self.render('option',option);optgroup=option[self.settings.optgroupField]||'';optgroups=$.isArray(optgroup)?optgroup:[optgroup];for(j=0,k=optgroups&&optgroups.length;j<k;j++){optgroup=optgroups[j];if(!self.optgroups.hasOwnProperty(optgroup))optgroup='';if(!groups.hasOwnProperty(optgroup)){groups[optgroup]=[];groups_order.push(optgroup)};groups[optgroup].push(option_html)}};if(this.settings.lockOptgroupOrder)groups_order.sort(function(a,b){var a_order=self.optgroups[a].$order||0,b_order=self.optgroups[b].$order||0;return a_order-b_order});html=[];for(i=0,n=groups_order.length;i<n;i++){optgroup=groups_order[i];if(self.optgroups.hasOwnProperty(optgroup)&&groups[optgroup].length){html_children=self.render('optgroup_header',self.optgroups[optgroup])||'';html_children+=groups[optgroup].join('');html.push(self.render('optgroup',$.extend({},self.optgroups[optgroup],{html:html_children})))}else html.push(groups[optgroup].join(''))};$dropdown_content.html(html.join(''));if(self.settings.highlight&&results.query.length&&results.tokens.length)for(i=0,n=results.tokens.length;i<n;i++)highlight($dropdown_content,results.tokens[i].regex);if(!self.settings.hideSelected)for(i=0,n=self.items.length;i<n;i++)self.getOption(self.items[i]).addClass('selected');has_create_option=self.canCreate(query);if(has_create_option){$dropdown_content.prepend(self.render('option_create',{input:query}));$create=$($dropdown_content[0].childNodes[0])};self.hasOptions=results.items.length>0||has_create_option;if(self.hasOptions){if(results.items.length>0){$active_before=active_before&&self.getOption(active_before);if($active_before&&$active_before.length){$active=$active_before}else if(self.settings.mode==='single'&&self.items.length)$active=self.getOption(self.items[0]);if(!$active||!$active.length)if($create&&!self.settings.addPrecedence){$active=self.getAdjacentOption($create,1)}else $active=$dropdown_content.find('[data-selectable]:first')}else $active=$create;self.setActiveOption($active);if(triggerDropdown&&!self.isOpen)self.open()}else{self.setActiveOption(null);if(triggerDropdown&&self.isOpen)self.close()}},addOption:function(data){var i,n,value,self=this;if($.isArray(data)){for(i=0,n=data.length;i<n;i++)self.addOption(data[i]);return};if(value=self.registerOption(data)){self.userOptions[value]=true;self.lastQuery=null;self.trigger('option_add',value,data)}},registerOption:function(data){var key=hash_key(data[this.settings.valueField]);if(!key||this.options.hasOwnProperty(key))return false;data.$order=data.$order||++this.order;this.options[key]=data;return key},registerOptionGroup:function(data){var key=hash_key(data[this.settings.optgroupValueField]);if(!key)return false;data.$order=data.$order||++this.order;this.optgroups[key]=data;return key},addOptionGroup:function(id,data){data[this.settings.optgroupValueField]=id;if(id=this.registerOptionGroup(data))this.trigger('optgroup_add',id,data)},removeOptionGroup:function(id){if(this.optgroups.hasOwnProperty(id)){delete this.optgroups[id];this.renderCache={};this.trigger('optgroup_remove',id)}},clearOptionGroups:function(){this.optgroups={};this.renderCache={};this.trigger('optgroup_clear')},updateOption:function(value,data){var self=this,$item,$item_new,value_new,index_item,cache_items,cache_options,order_old;value=hash_key(value);value_new=hash_key(data[self.settings.valueField]);if(value===null)return;if(!self.options.hasOwnProperty(value))return;if(typeof value_new!=='string')throw new Error('Value must be set in option data');order_old=self.options[value].$order;if(value_new!==value){delete self.options[value];index_item=self.items.indexOf(value);if(index_item!==-1)self.items.splice(index_item,1,value_new)};data.$order=data.$order||order_old;self.options[value_new]=data;cache_items=self.renderCache['item'];cache_options=self.renderCache['option'];if(cache_items){delete cache_items[value];delete cache_items[value_new]};if(cache_options){delete cache_options[value];delete cache_options[value_new]};if(self.items.indexOf(value_new)!==-1){$item=self.getItem(value);$item_new=$(self.render('item',data));if($item.hasClass('active'))$item_new.addClass('active');$item.replaceWith($item_new)};self.lastQuery=null;if(self.isOpen)self.refreshOptions(false)},removeOption:function(value,silent){var self=this;value=hash_key(value);var cache_items=self.renderCache['item'],cache_options=self.renderCache['option'];if(cache_items)delete cache_items[value];if(cache_options)delete cache_options[value];delete self.userOptions[value];delete self.options[value];self.lastQuery=null;self.trigger('option_remove',value);self.removeItem(value,silent)},clearOptions:function(){var self=this;self.loadedSearches={};self.userOptions={};self.renderCache={};self.options=self.sifter.items={};self.lastQuery=null;self.trigger('option_clear');self.clear()},getOption:function(value){return this.getElementWithValue(value,this.$dropdown_content.find('[data-selectable]'))},getAdjacentOption:function($option,direction){var $options=this.$dropdown.find('[data-selectable]'),index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$()},getElementWithValue:function(value,$els){value=hash_key(value);if(typeof value!=='undefined'&&value!==null)for(var i=0,n=$els.length;i<n;i++)if($els[i].getAttribute('data-value')===value)return $($els[i]);return $()},getItem:function(value){return this.getElementWithValue(value,this.$control.children())},addItems:function(values,silent){var items=$.isArray(values)?values:[values];for(var i=0,n=items.length;i<n;i++){this.isPending=(i<n-1);this.addItem(items[i],silent)}},addItem:function(value,silent){var events=silent?[]:['change'];debounce_events(this,events,function(){var $item,$option,$options,self=this,inputMode=self.settings.mode,i,active,value_next,wasFull;value=hash_key(value);if(self.items.indexOf(value)!==-1){if(inputMode==='single')self.close();return};if(!self.options.hasOwnProperty(value))return;if(inputMode==='single')self.clear(silent);if(inputMode==='multi'&&self.isFull())return;$item=$(self.render('item',self.options[value]));wasFull=self.isFull();self.items.splice(self.caretPos,0,value);self.insertAtCaret($item);if(!self.isPending||(!wasFull&&self.isFull()))self.refreshState();if(self.isSetup){$options=self.$dropdown_content.find('[data-selectable]');if(!self.isPending){$option=self.getOption(value);value_next=self.getAdjacentOption($option,1).attr('data-value');self.refreshOptions(self.isFocused&&inputMode!=='single');if(value_next)self.setActiveOption(self.getOption(value_next))};if(!$options.length||self.isFull()){self.close()}else self.positionDropdown();self.updatePlaceholder();self.trigger('item_add',value,$item);self.updateOriginalInput({silent:silent})}})},removeItem:function(value,silent){var self=this,$item,i,idx;$item=(typeof value==='object')?value:self.getItem(value);value=hash_key($item.attr('data-value'));i=self.items.indexOf(value);if(i!==-1){$item.remove();if($item.hasClass('active')){idx=self.$activeItems.indexOf($item[0]);self.$activeItems.splice(idx,1)};self.items.splice(i,1);self.lastQuery=null;if(!self.settings.persist&&self.userOptions.hasOwnProperty(value))self.removeOption(value,silent);if(i<self.caretPos)self.setCaret(self.caretPos-1);self.refreshState();self.updatePlaceholder();self.updateOriginalInput({silent:silent});self.positionDropdown();self.trigger('item_remove',value,$item)}},createItem:function(input,triggerDropdown){var self=this,caret=self.caretPos;input=input||$.trim(self.$control_input.val()||'');var callback=arguments[arguments.length-1];if(typeof callback!=='function')callback=function(){};if(typeof triggerDropdown!=='boolean')triggerDropdown=true;if(!self.canCreate(input)){callback();return false};self.lock();var setup=(typeof self.settings.create==='function')?this.settings.create:function(input){var data={};data[self.settings.labelField]=input;data[self.settings.valueField]=input;return data},create=once(function(data){self.unlock();if(!data||typeof data!=='object')return callback();var value=hash_key(data[self.settings.valueField]);if(typeof value!=='string')return callback();self.setTextboxValue('');self.addOption(data);self.setCaret(caret);self.addItem(value);self.refreshOptions(triggerDropdown&&self.settings.mode!=='single');callback(data)}),output=setup.apply(this,[input,create]);if(typeof output!=='undefined')create(output);return true},refreshItems:function(){this.lastQuery=null;if(this.isSetup)this.addItem(this.items);this.refreshState();this.updateOriginalInput()},refreshState:function(){var invalid,self=this;if(self.isRequired){if(self.items.length)self.isInvalid=false;self.$control_input.prop('required',invalid)};self.refreshClasses()},refreshClasses:function(){var self=this,isFull=self.isFull(),isLocked=self.isLocked;self.$wrapper.toggleClass('rtl',self.rtl);self.$control.toggleClass('focus',self.isFocused).toggleClass('disabled',self.isDisabled).toggleClass('required',self.isRequired).toggleClass('invalid',self.isInvalid).toggleClass('locked',isLocked).toggleClass('full',isFull).toggleClass('not-full',!isFull).toggleClass('input-active',self.isFocused&&!self.isInputHidden).toggleClass('dropdown-active',self.isOpen).toggleClass('has-options',!$.isEmptyObject(self.options)).toggleClass('has-items',self.items.length>0);self.$control_input.data('grow',!isFull&&!isLocked)},isFull:function(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(opts){var i,j,n,m,sizeId,options,label,self=this;opts=opts||{};if(self.tagType===TAG_SELECT){options=[];for(i=0,n=self.items.length;i<n;i++){label=self.options[self.items[i]][self.settings.labelField]||'';for(j=0,m=self.revertSettings.$children.length;j<m;j++)if(self.items[i]===self.revertSettings.$children[j].value)sizeId=self.revertSettings.$children[j].dataset.sizeId;if(sizeId){options.push('<option value="'+escape_html(self.items[i])+'" selected="selected" data-size-id="'+sizeId+'">'+escape_html(label)+'</option>')}else options.push('<option value="'+escape_html(self.items[i])+'" selected="selected">'+escape_html(label)+'</option>')};if(!options.length&&!this.$input.attr('multiple'))options.push('<option value="" selected="selected"></option>');self.$input.html(options.join(''))}else{self.$input.val(self.getValue());self.$input.attr('value',self.$input.val())};if(self.isSetup)if(!opts.silent)self.trigger('change',self.$input.val())},updatePlaceholder:function(){if(!this.settings.placeholder)return;var $input=this.$control_input;if(this.items.length){$input.removeAttr('placeholder')}else $input.attr('placeholder',this.settings.placeholder);$input.triggerHandler('update',{force:true})},open:function(){var self=this;if(self.isLocked||self.isOpen||(self.settings.mode==='multi'&&self.isFull()))return;self.focus();self.isOpen=true;self.refreshState();self.$dropdown.css({visibility:'hidden',display:'block'});self.positionDropdown();self.$dropdown.css({visibility:'visible'});self.trigger('dropdown_open',self.$dropdown)},close:function(){var self=this,trigger=self.isOpen;if(self.settings.mode==='single'&&self.items.length)self.hideInput();self.isOpen=false;self.$dropdown.hide();self.setActiveOption(null);self.refreshState();if(trigger)self.trigger('dropdown_close',self.$dropdown)},positionDropdown:function(){var $control=this.$control,offset=this.settings.dropdownParent==='body'?$control.offset():$control.position();offset.top+=$control.outerHeight(true);this.$dropdown.css({width:$control.outerWidth(),top:offset.top,left:offset.left})},clear:function(silent){var self=this;if(!self.items.length)return;self.$control.children(':not(input)').remove();self.items=[];self.lastQuery=null;self.setCaret(0);self.setActiveItem(null);self.updatePlaceholder();self.updateOriginalInput({silent:silent});self.refreshState();self.showInput();self.trigger('clear')},insertAtCaret:function($el){var caret=Math.min(this.caretPos,this.items.length);if(caret===0){this.$control.prepend($el)}else $(this.$control[0].childNodes[caret]).before($el);this.setCaret(caret+1)},deleteSelection:function(e){var i,n,direction,selection,values,caret,option_select,$option_select,$tail,self=this;direction=(e&&e.keyCode===KEY_BACKSPACE)?-1:1;selection=getSelection(self.$control_input[0]);if(self.$activeOption&&!self.settings.hideSelected)option_select=self.getAdjacentOption(self.$activeOption,-1).attr('data-value');values=[];if(self.$activeItems.length){$tail=self.$control.children('.active:'+(direction>0?'last':'first'));caret=self.$control.children(':not(input)').index($tail);if(direction>0)caret++;for(i=0,n=self.$activeItems.length;i<n;i++)values.push($(self.$activeItems[i]).attr('data-value'));if(e){e.preventDefault();e.stopPropagation()}}else if((self.isFocused||self.settings.mode==='single')&&self.items.length)if(direction<0&&selection.start===0&&selection.length===0){values.push(self.items[self.caretPos-1])}else if(direction>0&&selection.start===self.$control_input.val().length)values.push(self.items[self.caretPos]);if(!values.length||(typeof self.settings.onDelete==='function'&&self.settings.onDelete.apply(self,[values])===false))return false;if(typeof caret!=='undefined')self.setCaret(caret);while(values.length)self.removeItem(values.pop());self.showInput();self.positionDropdown();self.refreshOptions(true);if(option_select){$option_select=self.getOption(option_select);if($option_select.length)self.setActiveOption($option_select)};return true},advanceSelection:function(direction,e){var tail,selection,idx,valueLength,cursorAtEdge,$tail,self=this;if(direction===0)return;if(self.rtl)direction*=-1;tail=direction>0?'last':'first';selection=getSelection(self.$control_input[0]);if(self.isFocused&&!self.isInputHidden){valueLength=self.$control_input.val().length;cursorAtEdge=direction<0?selection.start===0&&selection.length===0:selection.start===valueLength;if(cursorAtEdge&&!valueLength)self.advanceCaret(direction,e)}else{$tail=self.$control.children('.active:'+tail);if($tail.length){idx=self.$control.children(':not(input)').index($tail);self.setActiveItem(null);self.setCaret(direction>0?idx+1:idx)}}},advanceCaret:function(direction,e){var self=this,fn,$adj;if(direction===0)return;fn=direction>0?'next':'prev';if(self.isShiftDown){$adj=self.$control_input[fn]();if($adj.length){self.hideInput();self.setActiveItem($adj);e&&e.preventDefault()}}else self.setCaret(self.caretPos+direction)},setCaret:function(i){var self=this;if(self.settings.mode==='single'){i=self.items.length}else i=Math.max(0,Math.min(self.items.length,i));if(!self.isPending){var j,n,fn,$children,$child;$children=self.$control.children(':not(input)');for(j=0,n=$children.length;j<n;j++){$child=$($children[j]).detach();if(j<i){self.$control_input.before($child)}else self.$control.append($child)}};self.caretPos=i},lock:function(){this.close();this.isLocked=true;this.refreshState()},unlock:function(){this.isLocked=false;this.refreshState()},disable:function(){var self=this;self.$input.prop('disabled',true);self.$control_input.prop('disabled',true).prop('tabindex',-1);self.isDisabled=true;self.lock()},enable:function(){var self=this;self.$input.prop('disabled',false);self.$control_input.prop('disabled',false).prop('tabindex',self.tabIndex);self.isDisabled=false;self.unlock()},destroy:function(){var self=this,eventNS=self.eventNS,revertSettings=self.revertSettings;self.trigger('destroy');self.off();self.$wrapper.remove();self.$dropdown.remove();self.$input.html('').append(revertSettings.$children).removeAttr('tabindex').removeClass('selectized').attr({tabindex:revertSettings.tabindex}).show();self.$control_input.removeData('grow');self.$input.removeData('selectize');$(window).off(eventNS);$(document).off(eventNS);$(document.body).off(eventNS);delete self.$input[0].selectize},render:function(templateName,data){var value,id,label,html='',cache=false,self=this,regex_tag=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;if(templateName==='option'||templateName==='item'){value=hash_key(data[self.settings.valueField]);cache=!!value};if(cache){if(!isset(self.renderCache[templateName]))self.renderCache[templateName]={};if(self.renderCache[templateName].hasOwnProperty(value))return self.renderCache[templateName][value]};html=self.settings.render[templateName].apply(this,[data,escape_html]);if(templateName==='option'||templateName==='option_create')html=html.replace(regex_tag,'<$1 data-selectable');if(templateName==='optgroup'){id=data[self.settings.optgroupValueField]||'';html=html.replace(regex_tag,'<$1 data-group="'+escape_replace(escape_html(id))+'"')};if(templateName==='option'||templateName==='item')html=html.replace(regex_tag,'<$1 data-value="'+escape_replace(escape_html(value||''))+'"');if(cache)self.renderCache[templateName][value]=html;return html},clearCache:function(templateName){var self=this;if(typeof templateName==='undefined'){self.renderCache={}}else delete self.renderCache[templateName]},canCreate:function(input){var self=this;if(!self.settings.create)return false;var filter=self.settings.createFilter;return input.length&&(typeof filter!=='function'||filter.apply(self,[input]))&&(typeof filter!=='string'||new RegExp(filter).test(input))&&(!(filter instanceof RegExp)||filter.test(input))}});Selectize.count=0;Selectize.defaults={options:[],optgroups:[],plugins:[],delimiter:',',splitOn:null,persist:true,diacritics:true,create:false,createOnBlur:false,createFilter:null,highlight:true,openOnFocus:true,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:false,selectOnTab:false,preload:false,allowEmptyOption:false,closeAfterSelect:false,scrollDuration:60,loadThrottle:300,loadingClass:'loading',dataAttr:'data-data',optgroupField:'optgroup',valueField:'value',labelField:'text',optgroupLabelField:'label',optgroupValueField:'value',lockOptgroupOrder:false,sortField:'$order',searchField:['text'],searchConjunction:'and',mode:null,wrapperClass:'selectize-control',inputClass:'selectize-input',dropdownClass:'selectize-dropdown',dropdownContentClass:'selectize-dropdown-content',dropdownParent:null,copyClassesToDropdown:true,render:{}};$.fn.selectize=function(settings_user){var defaults=$.fn.selectize.defaults,settings=$.extend({},defaults,settings_user),attr_data=settings.dataAttr,field_label=settings.labelField,field_value=settings.valueField,field_optgroup=settings.optgroupField,field_optgroup_label=settings.optgroupLabelField,field_optgroup_value=settings.optgroupValueField,init_textbox=function($input,settings_element){var i,n,values,option,data_raw=$input.attr(attr_data);if(!data_raw){var value=$.trim($input.val()||'');if(!settings.allowEmptyOption&&!value.length)return;values=value.split(settings.delimiter);for(i=0,n=values.length;i<n;i++){option={};option[field_label]=values[i];option[field_value]=values[i];settings_element.options.push(option)};settings_element.items=values}else{settings_element.options=JSON.parse(data_raw);for(i=0,n=settings_element.options.length;i<n;i++)settings_element.items.push(settings_element.options[i][field_value])}},init_select=function($input,settings_element){var i,n,tagName,$children,order=0,options=settings_element.options,optionsMap={},readData=function($el){var data=attr_data&&$el.attr(attr_data);if(typeof data==='string'&&data.length)return JSON.parse(data);return null},addOption=function($option,group){$option=$($option);var value=hash_key($option.attr('value'));if(!value&&!settings.allowEmptyOption)return;if(optionsMap.hasOwnProperty(value)){if(group){var arr=optionsMap[value][field_optgroup];if(!arr){optionsMap[value][field_optgroup]=group}else if(!$.isArray(arr)){optionsMap[value][field_optgroup]=[arr,group]}else arr.push(group)};return};var option=readData($option)||{};option[field_label]=option[field_label]||$option.text();option[field_value]=option[field_value]||value;option[field_optgroup]=option[field_optgroup]||group;optionsMap[value]=option;options.push(option);if($option.is(':selected'))settings_element.items.push(value)},addGroup=function($optgroup){var i,n,id,optgroup,$options;$optgroup=$($optgroup);id=$optgroup.attr('label');if(id){optgroup=readData($optgroup)||{};optgroup[field_optgroup_label]=id;optgroup[field_optgroup_value]=id;settings_element.optgroups.push(optgroup)};$options=$('option',$optgroup);for(i=0,n=$options.length;i<n;i++)addOption($options[i],id)};settings_element.maxItems=$input.attr('multiple')?null:1;$children=$input.children();for(i=0,n=$children.length;i<n;i++){tagName=$children[i].tagName.toLowerCase();if(tagName==='optgroup'){addGroup($children[i])}else if(tagName==='option')addOption($children[i])}};return this.each(function(){if(this.selectize)return;var instance,$input=$(this),tag_name=this.tagName.toLowerCase(),placeholder=$input.attr('placeholder')||$input.attr('data-placeholder');if(!placeholder&&!settings.allowEmptyOption)placeholder=$input.children('option[value=""]').text();var settings_element={placeholder:placeholder,options:[],optgroups:[],items:[]};if(tag_name==='select'){init_select($input,settings_element)}else init_textbox($input,settings_element);instance=new Selectize($input,$.extend(true,{},defaults,settings_element,settings_user))})};$.fn.selectize.defaults=Selectize.defaults;$.fn.selectize.support={validity:SUPPORTS_VALIDITY_API};Selectize.define('drag_drop',function(options){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if(this.settings.mode!=='multi')return;var self=this;self.lock=(function(){var original=self.lock;return function(){var sortable=self.$control.data('sortable');if(sortable)sortable.disable();return original.apply(self,arguments)}})();self.unlock=(function(){var original=self.unlock;return function(){var sortable=self.$control.data('sortable');if(sortable)sortable.enable();return original.apply(self,arguments)}})();self.setup=(function(){var original=self.setup;return function(){original.apply(this,arguments);var $control=self.$control.sortable({items:'[data-value]',forcePlaceholderSize:true,disabled:self.isLocked,start:function(e,ui){ui.placeholder.css('width',ui.helper.css('width'));$control.css({overflow:'visible'})},stop:function(){$control.css({overflow:'hidden'});var active=self.$activeItems?self.$activeItems.slice():null,values=[];$control.children('[data-value]').each(function(){values.push($(this).attr('data-value'))});self.setValue(values);self.setActiveItem(active)}})}})()});Selectize.define('dropdown_header',function(options){var self=this;options=$.extend({title:'Untitled',headerClass:'selectize-dropdown-header',titleRowClass:'selectize-dropdown-header-title',labelClass:'selectize-dropdown-header-label',closeClass:'selectize-dropdown-header-close',html:function(data){return('<div class="'+data.headerClass+'"><div class="'+data.titleRowClass+'"><span class="'+data.labelClass+'">'+data.title+'</span><a href="javascript:void(0)" class="'+data.closeClass+'">&times;</a></div></div>')}},options);self.setup=(function(){var original=self.setup;return function(){original.apply(self,arguments);self.$dropdown_header=$(options.html(options));self.$dropdown.prepend(self.$dropdown_header)}})()});Selectize.define('optgroup_columns',function(options){var self=this;options=$.extend({equalizeWidth:true,equalizeHeight:true},options);this.getAdjacentOption=function($option,direction){var $options=$option.closest('[data-group]').find('[data-selectable]'),index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$()};this.onKeyDown=(function(){var original=self.onKeyDown;return function(e){var index,$option,$options,$optgroup;if(this.isOpen&&(e.keyCode===KEY_LEFT||e.keyCode===KEY_RIGHT)){self.ignoreHover=true;$optgroup=this.$activeOption.closest('[data-group]');index=$optgroup.find('[data-selectable]').index(this.$activeOption);if(e.keyCode===KEY_LEFT){$optgroup=$optgroup.prev('[data-group]')}else $optgroup=$optgroup.next('[data-group]');$options=$optgroup.find('[data-selectable]');$option=$options.eq(Math.min($options.length-1,index));if($option.length)this.setActiveOption($option);return};return original.apply(this,arguments)}})();var getScrollbarWidth=function(){var div,width=getScrollbarWidth.width,doc=document;if(typeof width==='undefined'){div=doc.createElement('div');div.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>';div=div.firstChild;doc.body.appendChild(div);width=getScrollbarWidth.width=div.offsetWidth-div.clientWidth;doc.body.removeChild(div)};return width},equalizeSizes=function(){var i,n,height_max,width,width_last,width_parent,$optgroups;$optgroups=$('[data-group]',self.$dropdown_content);n=$optgroups.length;if(!n||!self.$dropdown_content.width())return;if(options.equalizeHeight){height_max=0;for(i=0;i<n;i++)height_max=Math.max(height_max,$optgroups.eq(i).height());$optgroups.css({height:height_max})};if(options.equalizeWidth){width_parent=self.$dropdown_content.innerWidth()-getScrollbarWidth();width=Math.round(width_parent/n);$optgroups.css({width:width});if(n>1){width_last=width_parent-width*(n-1);$optgroups.eq(n-1).css({width:width_last})}}};if(options.equalizeHeight||options.equalizeWidth){hook.after(this,'positionDropdown',equalizeSizes);hook.after(this,'refreshOptions',equalizeSizes)}});Selectize.define('remove_button',function(options){if(this.settings.mode==='single')return;options=$.extend({label:'&times;',title:'Remove',className:'remove',append:true},options);var self=this,html='<a href="javascript:void(0)" class="'+options.className+'" tabindex="-1" title="'+escape_html(options.title)+'">'+options.label+'</a>',append=function(html_container,html_element){var pos=html_container.search(/(<\/[^>]+>\s*)$/);return html_container.substring(0,pos)+html_element+html_container.substring(pos)};this.setup=(function(){var original=self.setup;return function(){if(options.append){var render_item=self.settings.render.item;self.settings.render.item=function(data){return append(render_item.apply(this,arguments),html)}};original.apply(this,arguments);this.$control.on('click','.'+options.className,function(e){e.preventDefault();if(self.isLocked)return;var $item=$(e.currentTarget).parent();self.setActiveItem($item);if(self.deleteSelection())self.setCaret(self.items.length)})}})()});Selectize.define('restore_on_backspace',function(options){var self=this;options.text=options.text||function(option){return option[this.settings.labelField]};this.onKeyDown=(function(){var original=self.onKeyDown;return function(e){var index,option;if(e.keyCode===KEY_BACKSPACE&&this.$control_input.val()===''&&!this.$activeItems.length){index=this.caretPos-1;if(index>=0&&index<this.items.length){option=this.options[this.items[index]];if(this.deleteSelection(e)){this.setTextboxValue(options.text.apply(this,[option]));this.refreshOptions(true)};e.preventDefault();return}};return original.apply(this,arguments)}})()});return Selectize}))
;
var LayoutElement=function(element){if(!element)throw new Error('No element passed');this.getElement=function(){return element}};LayoutElement.create=function(element){return element.length?new LayoutElement(element):null};LayoutElement.TRANSITION_DURATION=300;LayoutElement.prototype.isVisible=function(){return this.getElement().is(':visible')}
;
var Notification=function(opt){var nq=App.getNotificationQueue();if(!opt.id){do{var id=Math.random().toString(36).slice(2)}while(nq.exists(id))}else var id=opt.id;this.id=id;this.message=opt.message;this.header=opt.header;this.addclass=opt.addclass||'';this.type=opt.type?opt.type:Notification.ERROR;if(this.type!==Notification.ERROR)this.timeout=opt.timeout?opt.timeout:0;var last=nq.last();this.n=last?last.n+1:1};Notification.ERROR=1;Notification.SUCCESS=2;Notification.NOTICE=3;Notification.prototype.setHideTimeout=function(ms){var self=this;this.hideTimeout=setTimeout(function(){self.hide(function(){clearTimeout(self.hideTimeout)})},ms||this.timeout+400)};Notification.prototype.show=function(){if(!App.getNotificationQueue().add(this))return false;this.el=$(new EJS({url:'/themes/ultrashop/templates/_notification.ejs'}).render({message:this.message,id:this.id,addclass:this.addclass,header:this.header}));switch(this.type){case Notification.ERROR:this.el.addClass('error-notification');break;case Notification.SUCCESS:break;case Notification.NOTICE:break;default:break};var container=$('.notification-wrapper');this.el.css({zIndex:+container.css('zIndex')+this.n});container.prepend(this.el);if(this.timeout)this.setHideTimeout();this.el.show().css({opacity:1});if(isMobile.any()){var messageLength=0;if(this.message!=undefined)messageLength=this.message.length;this.setHideTimeout(messageLength*messageLength+3e3)}else notificationPosition()
    function notificationPosition(){var notificationBlock=$('.notification-block'),notificationBlockWidth=notificationBlock.innerWidth(),notificationBlockHeight=notificationBlock.innerHeight();notificationBlock.css({marginLeft:-notificationBlockWidth/2,marginTop:-notificationBlockHeight/2})}};Notification.prototype.hide=function(callback){var self=this;self.el.css({opacity:0});setTimeout(function(){self.el.hide(function(){App.getNotificationQueue().remove(self);callback&&callback();self.el.remove()})},300)}
;
var Cart=function(element,options){if(!element)throw new Error('No element passed');this.getElement=function(){return element};this.path=options.path;this.$positions=element.find('.positions').children();this.$total=element.find('.total');this.total=0};Cart.prototype.getPositionsData=function(){return this.$positions.map(function(){return $(this).data()})};Cart.prototype.refreshTotal=function(){var self=this;self.total=0;self.$positions.each(function(index,el){var $el=$(el);self.total+=$el.data('active')?$el.data('sumPrice'):0});self.$total.text(self.format())};Cart.prototype.togglePosition=function($position){var activeToggle=$position.data('active');$position.find('.info').children().toggle();$position.data('active',!activeToggle);this.refreshTotal()};Cart.prototype.addPositions=function(positions,callback){var self=this;$.post(self.path+'add',{positions:positions||[]},function(data){if(data.error)return;callback&&callback(data.already_added_error);var lastAddedProduct=data.positions[data.positions.length-1],productsIds=[];productsIds.push(lastAddedProduct.id);if(lastAddedProduct)Analytics.facebookAddToCartTrack(lastAddedProduct.price,productsIds);if(!data.already_added_error)self.sendSoftcubeCart()})};Cart.prototype.removePositions=function(positions){var self=this;$.ajax({url:this.path+'remove',type:'POST',async:false,data:{positions:positions||[]}}).done(function(){$.get('/cart/getInfo',function(data){var $checkoutPage=$('.checkout-page');if($checkoutPage.length)$checkoutPage.trigger('receiveShoppingCartInfo',data)})});$.ajax({url:window.location.href}).done(function(data){var $dom=$(document.createElement("html"));$dom[0].innerHTML=data;$('#right').html($dom.find('#right').html());$('.cart-count').html($dom.find('.cart-count').html());self.sendSoftcubeCart()})};Cart.prototype.getPrice=function(id,callback){$.getJSON(this.path+'sumPrice',{id:id},function(data){if(data.error)return;callback&&callback(data)})};Cart.prototype.getCount=function(callback){$.getJSON(this.path+'count',function(data){if(data.error)return;callback&&callback(data)})};Cart.prototype.getPositionById=function(id){return this.getElement().find('[data-position-id="'+id+'"]')};Cart.prototype.format=function(){var number=this.total,decimals=0,dec_point=',',thousands_sep=' ';number=(number+'').replace(/[^0-9+\-Ee.]/g,'');var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=(typeof thousands_sep==='undefined')?',':thousands_sep,dec=(typeof dec_point==='undefined')?'.':dec_point,s='',toFixedFix=function(n,prec){var k=Math.pow(10,prec);return''+Math.round(n*k)/k};s=(prec?toFixedFix(n,prec):''+Math.round(n)).split('.');if(s[0].length>3)s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep);if((s[1]||'').length<prec){s[1]=s[1]||'';s[1]+=new Array(prec-s[1].length+1).join('0')};return s.join(dec)};Cart.prototype.sendSoftcubeCart=function(){if(!IS_PRODUCTION)return;window.setTimeout(function(){var element=$('.cart__main'),$positions=element.find('.positions').children();ScSendCart({user:getUser(),StatusCart:generateStatusCart($positions)})},1e3);var generateStatusCart=function($positions){var StatusCart=[];$positions.each(function(){var item={productKey:$(this).data('code'),price:$(this).data('sum-price'),quantity:1};StatusCart.push(item)});return StatusCart},getUser=function(){var user={firstName:$('#ScFirstName').html(),email:$('#ScMail').html()};return(user.firstName&&user.email)?user:false},ScSendCart=function(params){if(!params.user)delete params.user;window._sc.sendEvent("StatusCart",params)}}
;
var Form=function(element,options){if(!element)throw new Error('No element passed');this.getElement=function(){return element};this.id=element.attr('id');this.action=element.attr('action');this.method=element.attr('method');this.isAjax=options.isAjax;var self=this;element.on('submit',function(event){return self._submit(options.submitCallback)});element.find('.form-input[data-check="1"]').on('keyup',function(){self.onFieldChange($(this))});element.find('.form-select[data-check="1"]').on('change',function(){self.onFieldChange($(this))})};Form.create=function(element,options){return element.length?new Form(element,options||{}):null};Form.validateInput=function(input){if(!input)return false;if(input.is(':checkbox')){return input.is(':checked')}else return $.trim(input.val()).length};Form.prototype.onFieldChange=function(field){if(Form.validateInput(field)){this.hideError(field.data('errorId'));var notif=App.getNotificationQueue().get(this.id+'-error');notif&&notif.hide()}};Form.prototype.validate=function(){var self=this,errors=0;this.getElement().find('[data-check="1"]').each(function(){var $this=$(this);if(!$this.prop('disabled')&&!Form.validateInput($this)){errors++;self.showError($this.data('errorId'))}});return!errors};Form.prototype.showError=function(errorId){errorId&&this.getElement().find('.error-msg[data-id="'+errorId+'"]').show()};Form.prototype.hideError=function(errorId){errorId&&this.getElement().find('.error-msg[data-id="'+errorId+'"]').hide()};Form.prototype._submit=function(callback){var self=this;if(self.id=="feedback-form"){var inputEmail=$('#Feedback_email').val();if(inputEmail&&!App.validateEmail(inputEmail)){new Notification({id:'email-error',type:Notification.ERROR,message:'Введён некорректный email',header:'Ошибка',timeout:5e3}).show();return false};if(!self.validate()){new Notification({id:self.id+'-error',header:'Ошибка',message:'Вы не заполнили некоторые поля'}).show();return false}}else if(self.id=="order-form"){function toggleValidateClass($container,className,timeout){timeout=timeout||3e3;$container.addClass(className);window.setTimeout(function(){$container.removeClass(className)},timeout)};if(!self.validate()){var $form=self.getElement(),$inputEmail=$form.find('#Customer_email'),$inputPhone=$form.find('#CustomerAddress_phone'),$PhoneLength=$inputPhone.val().replace(/([\s\_\-\(\)])+/g,"").length,$inputFirstname=$form.find('#CustomerAddress_firstname'),$inputMiddlename=$form.find('#CustomerAddress_middlename'),$inputLastname=$form.find('#CustomerAddress_lastname'),$inputCity=$form.find('#CustomerAddress_city_id'),$inputDeliveryType=$form.find('#Order_delivery_id'),$inputWarehouse=$form.find('#CustomerAddress_warehouse_ref'),$inputStreet=$form.find('#CustomerAddress_street_ref'),$inputAddress=$form.find('#CustomerAddress_full_address');if(App.validateEmail($inputEmail.val())){toggleValidateClass($inputEmail.parent(),'success')}else toggleValidateClass($inputEmail.parent(),'error');if($inputFirstname.val()){toggleValidateClass($inputFirstname.parent(),'success')}else toggleValidateClass($inputFirstname.parent(),'error');if($inputMiddlename.val()){toggleValidateClass($inputMiddlename.parent(),'success')}else toggleValidateClass($inputMiddlename.parent(),'error');if($inputLastname.val()){toggleValidateClass($inputLastname.parent(),'success')}else toggleValidateClass($inputLastname.parent(),'error');if($PhoneLength<13){toggleValidateClass($inputPhone.parent(),'error')}else toggleValidateClass($inputPhone.parent(),'success');if($inputCity.val()){toggleValidateClass($inputCity.parent(),'success')}else toggleValidateClass($inputCity.parent(),'error');if($inputDeliveryType.val()){toggleValidateClass($inputDeliveryType.parent(),'success')}else toggleValidateClass($inputDeliveryType.parent(),'error');if($inputWarehouse.parent().is(':visible')&&$inputWarehouse.val()){toggleValidateClass($inputWarehouse.parent(),'success')}else toggleValidateClass($inputWarehouse.parent(),'error');if($inputStreet.parent().is(':visible')&&$inputStreet.val()){toggleValidateClass($inputStreet.parent(),'success')}else toggleValidateClass($inputStreet.parent(),'error');if($inputAddress.parent().is(':visible')&&$inputAddress.val()){toggleValidateClass($inputAddress.parent(),'success')}else toggleValidateClass($inputAddress.parent(),'error');return false}}else if(!self.validate()){new Notification({id:self.id+'-error',header:'Ошибка',message:'Вы не заполнили некоторые поля'}).show();return false};if(self.isAjax){$.ajax({type:self.method,url:self.action,data:self.getElement().serialize(),beforeSend:function(){self.getElement().css({cursor:'wait'})},complete:function(res){self.getElement().css({cursor:'auto'});if(res.responseText){var json=$.parseJSON(res.responseText);if(json.error){new Notification({id:self.id+'-error',header:'Ошибка',message:json.message||'Произошла ошибка. Попробуйте отправить запрос еще раз'}).show()}else if(json.success)callback&&callback(json)}else callback&&callback(res.responseText)}});return false}else return true}
;
var NotificationQueue=function(){this.list=[]};NotificationQueue.prototype.count=function(){return this.list.length};NotificationQueue.prototype.getPosition=function(id){var count=this.count(),position;for(var i=0;i<count;i++)if(this.list[i].id===id){position=i;break};return position};NotificationQueue.prototype.get=function(id){if(!id)return this.list;return this.list[this.getPosition(id)]};NotificationQueue.prototype.exists=function(id){return!!this.get(id)};NotificationQueue.prototype.add=function(notification){if(!this.exists(notification.id)){this.beforeAdd();this.list.push(notification);return true}else return false};NotificationQueue.prototype.remove=function(notification){var pos=this.getPosition(notification.id);if(pos!==undefined){this.list.splice(pos,1);this.onRemove()}};NotificationQueue.prototype.clear=function(){this.list=[]};NotificationQueue.prototype.last=function(){return this.list[this.count()-1]};NotificationQueue.prototype.beforeAdd=function(){var last=this.last();if(last&&last.timeout)clearTimeout(last.hideTimeout)};NotificationQueue.prototype.onRemove=function(){var last=this.last();if(last&&last.timeout)last.setHideTimeout(last.timeout)}
;
var Layout=function(){var elements={},currentFilterUrl=null,initElements=function(){var $left=$('#left'),$search=$('#search_wrap');if(!$search.length)return;var search=LayoutElement.create($search);search.show=function(){$('#search-text').addClass('grey');$('#search-form').removeClass('hide');$('#search_wrap').css('display','block');$('html, body').css({height:'100%',overflow:'hidden'})};search.hide=function(){$('#search-text').removeClass('grey');$('#search-form').addClass('hide');$('#search_wrap').css('display','none');$('html, body').css({height:'',overflow:''})};elements.search=search;$('body').delegate('.overlayWithSidebar','touchmove',function(e){e.preventDefault()});$('body').delegate('.overlayWithSidebar','click touchstart',function(e){e.preventDefault();if(!$('#filters').hasClass('show-filter')){left.hide()}else hideFilters()});$('body').delegate('.left-sidebar-close','click touchstart',function(){left.hide()});var left=LayoutElement.create($left);$('body').on("click",".mobile-menu-icon",function(){if(!$('#filters').length||$('#filters').length&&!$('#filters').hasClass('show-filter')){$('#left').hasClass('sidebarShow')?left.hide():left.show()}else hideFilters()})
    function openMobileFilter(){if(!$('#filters').hasClass('show-filter')){showFilters()}else hideFilters()};$('body').on("click",".open-filter-btt:not(.scroll-top)",function(){openMobileFilter()});$('.sort-block .left.mobile').click(function(){openMobileFilter()});$('body').on("click",".mobile-filter-do",function(e){e.preventDefault();hideFilters()});$('.close-arrow').on('click',function(){if($('#left').hasClass('sidebarShow')){if($('.main-group.men').hasClass('active')&&$('.content-group.men').hasClass('first-page')){left.hide()}else if($('.main-group.women').hasClass('active')&&$('.content-group.women').hasClass('first-page')){left.hide()}else if($('.main-group.men').hasClass('active')){$('.content-group.men').addClass('first-page');setTimeout("$('.content-group.men .sub-menu.active').removeClass('active');",500)}else{$('.content-group.women').addClass('first-page');setTimeout("$('.content-group.women .sub-menu.active').removeClass('active');",500)}}else hideFilters()})
    function wH(){return window.innerHeight||$(window).height()}
    function addHeight($elem){$elem.css({height:wH()-$('header').height()-$('.menu-header').height()})};$(window).on('resize',function(){addHeight($('.sub-menu-space .sub-menu, .content-group > ul, .menu-content'))});$('.main-group.men').on('click',function(){$('.main-group.women, .content-group.women').removeClass('active');$('.main-group.men, .content-group.men').addClass('active')});$('.main-group.women').on('click',function(){$('.main-group.men, .content-group.men').removeClass('active');$('.main-group.women, .content-group.women').addClass('active')});$('.head-menu').on('click',function(){var subMenu=$(this).data('sub-menu');if(subMenu==='news')return;if($('.main-group.men').hasClass('active')){addHeight($('.content-group.men .sub-menu-space .sub-menu.'+subMenu));$('.content-group.men .sub-menu-space .sub-menu.'+subMenu).addClass('active');$('.content-group.men').removeClass('first-page')}else{addHeight($('.content-group.women .sub-menu-space .sub-menu.'+subMenu));$('.content-group.women .sub-menu-space .sub-menu.'+subMenu).addClass('active');$('.content-group.women').removeClass('first-page')}})
    function showFilters(){openLeftSidebar($('#filters'),'show-filter');currentFilterUrl=$("#__filters").data("link")}
    function hideFilters(){closeLeftSidebar($('#filters'),'show-filter');filter_do()};left.show=function(){openLeftSidebar(this.getElement(),'sidebarShow');addHeight($('.content-group > ul, .menu-content'))};left.hide=function(){closeLeftSidebar(this.getElement(),'sidebarShow')}
    function openLeftSidebar($elem,className){$elem.addClass(className);$('#content, #product_wrap').addClass('contentWithSidebarLeft');$('.to-top').addClass('toTopWithSidebarLeft');$('.open-filter-btt').addClass('filterBttWithSidebarLeft');$('.overlayWithSidebar').addClass('open-mask').css({height:'100%',opacity:1});$('.nano-pane').css({opacity:0});$('html, body').css({overflow:'hidden'})}
    function closeLeftSidebar($elem,className){$elem.removeClass(className);$('#content, #product_wrap').removeClass('contentWithSidebarLeft');$('.to-top').removeClass('toTopWithSidebarLeft');$('.open-filter-btt').removeClass('filterBttWithSidebarLeft');$('.overlayWithSidebar').removeClass('open-mask').css({opacity:''});$('html, body').css({height:'',overflow:''});setTimeout(function(){$('.nano-pane').css({opacity:1});$('.overlayWithSidebar').css({height:''})},500)};elements.left=left}
    function filter_do(){var newFilterUrl=$("#__filters").data("link");if(currentFilterUrl===newFilterUrl)return false;$('.filter-mask').css({height:'100%'});window.location.href=newFilterUrl};var initFilters=function(){var filters=LayoutElement.create($filters);filters.show=function(){this.getElement().removeClass('close')};filters.hide=function(){this.getElement().stop().animate({width:80},LayoutElement.TRANSITION_DURATION);this.getElement().addClass('close')};filters.isOpened=function(){return!this.getElement().hasClass('close')};elements.filters=filters;return filters},initTicker=function(){var count=1,timer_id=setInterval(function(){$("#ticker_"+count).fadeOut(300);count++;if($("#ticker_"+count).length>0){$("#ticker_"+count).delay(300).fadeIn(300)}else{count=1;$("#ticker_"+count).delay(300).fadeIn(300)}},10*1e3);$('#banner-beta').mouseover(function(){$("#mainTicker").show()});$('#banner-beta').mouseleave(function(){$("#mainTicker").hide()})};return{init:function(){initElements();initTicker()},registerFilters:initFilters,getElement:function(name){return elements[name]||null}}}(),showBrandSubMenu=function(){var brandsBtns=document.querySelectorAll('.brands-menu-link'),brandsNavs=document.querySelector('.brands-menu-promo');brandsBtns.forEach(function(btn){var brand=btn.dataset.brand;btn.addEventListener('click',function(){var brandsNavActive=brandsNavs.querySelector('.brands-sub-menu.active')||0;if(brandsNavActive!=0)brandsNavActive.classList.remove('active');brandsNavs.querySelector('.brands-sub-menu[data-brand="'+brand+'"]').classList.add('active')})})};showBrandSubMenu();var createDisignersList=function(isfilter){var des_popup=$('body').find("#designers-popup");if(isfilter==true){if(des_popup.length===0)$('body').append('<div class="designers-popup " id="designers-popup"><div id="designers-search"></div><div id="designers-popup-close-filter">X</div><div id="header"></div><div class="designers-block nano has-scrollbar"><div class="nano-content"><div id="content"></div></div></div></div></div><div class="designers_shadow"></div>')}else if(des_popup.length===0)$('body').append('<div class="designers-popup " id="designers-popup"><div id="designers-popup-close-filter" class="designer-user">X</div><div class="designers-block nano has-scrollbar"><div class="nano-content" style="top: 35px!important"><div id="content" style="padding-top: 1px"></div></div></div></div></div><div class="designers_shadow"></div>')},showDisignersList=function(isfilter){if(isfilter==true){$.ajax({type:"post",url:document.URL,dataType:'html',data:{BrandsForFilter:1}}).done(function(data){$("#designers-popup").find("#content").html(data);$('.brand-block:last-child').after('<div class="brand-block-button"><button id="designers-popup-close-button" class="fs10 ls2">Выбрать</button></div>');$("input:checkbox[name='selected_designers']").each(function(){$(this).change(function(){if($(this).is(":checked")&&$('.designers-popup #header div').length<40){$('#header').css('display','block');$('#designers-popup-close-button').css('display','block');$("#designers-popup").find("#header").append("<div id='"+$(this).attr('id')+"_name' class='brand-f'>"+$('#'+$(this).attr('id')+'_label').html()+" (x)</div>")}else{$("#designers-popup").find("#"+$(this).attr('id')+"_name").remove();if($('.designers-popup #header div').length<1){$('.designers-popup #header').css('display','none');$('#designers-popup-close-button').css('display','none')}};if($('.designers-popup #header div').length>=40){$('.brand-block .item :checkbox').prop("disabled",true);$('.brand-block .item :checkbox:checked').prop("disabled",false)}else $('.brand-block .item :checkbox').prop("disabled",false);brandListTop()});if($(this).attr("checked")=="checked"){$('.designers-popup #header').css('display','block');$('#designers-popup-close-button').css('display','block');if($('.designers-popup #header div').length<40)$("#designers-popup").find("#header").append("<div id='"+$(this).attr('id')+"_name'>"+$('#'+$(this).attr('id')+'_label').html()+" (x)</div>");if($('.designers-popup #header div').length>=40){$('.brand-block .item :checkbox').prop("disabled",true);$('.brand-block .item :checkbox:checked').prop("disabled",false)}else $('.brand-block .item :checkbox').prop("disabled",false);brandListTop()};$("#designers-popup").delegate("#"+$(this).attr('id')+"_name",'click',function(){$(this).remove();$("#"+$(this).attr("id").replace('_name','')).removeAttr('checked');if($('.designers-popup #header div').length<1)$('.designers-popup #header').css('display','none'),$('#designers-popup-close-button').css('display','none');if($('.designers-popup #header div').length>=40){$('.brand-block .item :checkbox').prop("disabled",true);$('.brand-block .item :checkbox:checked').prop("disabled",false)}else $('.brand-block .item :checkbox').prop("disabled",false);brandListTop()});brandListTop()});$('.designers-block.nano').nanoScroller({paneClass:'scrollPopUp'})})}else $.ajax({url:"/shop/designer/getdesigners",dataType:'html'}).done(function(data){$("#designers-popup").find("#content").html(data);$('.item:last-child').after('<div class="brand-block-button" style="margin-top: 20px;"><button id="designers-popup-close-button" class="fs10 ls2 designer-user">Выбрать</button></div>');$("input:checkbox[name='selected_designers']").each(function(){$(this).change(function(){if($('input[type=checkbox]:checked').length>2){$('#designers-popup-close-button').css('display','block')}else $('#designers-popup-close-button').css('display','none')});if($('input[type=checkbox]:checked').length>2)$('#designers-popup-close-button').css('display','block')});$('.designers-block.nano').nanoScroller({paneClass:'scrollPopUp'})});$("#designers-popup").show();brandListTop();var serchinput='<input type="text" placeholder="Поиск" id="search-brand-btn">';$('#designers-search').append(serchinput);$(".designers-popup .nano-content #content").searcher({itemSelector:".brand-block",textSelector:".item",inputSelector:"#search-brand-btn",toggle:function(item,containsText){if(containsText){$(item).fadeIn()}else $(item).fadeOut()}})},brandListTop=function(brandHeaderHeight){var px=0;if($('.designers-popup  #header').is(':visible')){var brandHeaderHeight=$('.designers-popup  #header').height();switch(brandHeaderHeight){case 36:px=122;break;case 54:px=139;break;case 72:px=156;break;case 90:px=175;break;case 108:px=193;break;case 126:px=211;break;case 144:px=229;break;case 162:px=248;break;case 180:px=256;break;case 190:px=283;break;default:};$('.designers-block .nano-content').css('top',px)}else $('.designers-block .nano-content').css('top',65)},hideDisignersList=function(isfilter){if(isfilter==true){var designers_ids="";$("input:checkbox[name='selected_designers']:checked").each(function(){designers_ids+=$(this).attr("id")+","});designers_ids=designers_ids.slice(0,designers_ids.length-1);$.ajax({type:"post",data:{brand_id:designers_ids,getUrl:1,brandPopup:1}}).done(function(data){window.location.href=data})}else{var selected_designers=new Array();$("input:checkbox[name='selected_designers']:checked").each(function(){selected_designers.push($(this).attr("id"))});$.ajax({type:"get",url:"/shop/designer/savedesigners",dataType:"html",data:{selected_designers:selected_designers}}).done(function(data){$('#favorite_designers').html(data)})};$("#designers-popup").remove();$(".designers_shadow").remove()};$('body').delegate('.designer-user','click',function(){hideDisignersList()});$('body').delegate('#designers-close','click',function(){hideDisignersList()})
function historyReturn(){if(document.referrer.indexOf("ultra-shop")>-1){history.go(-1)}else return false}
function activeLinkItem(hoverEffect){$(hoverEffect).find('a').each(function(){var location=window.location.pathname,link=$(this).attr('href');if(location===link)$(this).addClass('active')})};activeLinkItem('.favourite-sex');var initBrandsCarousel=function(){var slider=$('.brands-block_carousel');if(slider.length<=0)return;var options={loop:true,margin:0,nav:false,dots:false,stagePadding:100,responsive:{0:{items:1,center:true},601:{items:3,center:true},991:{items:4,center:false}}};slider.owlCarousel(options);$(window).resize(function(){slider.trigger('destroy.owl.carousel');slider.html(slider.find('.owl-stage-outer').html()).removeClass('owl-loaded');slider.owlCarousel(options)})};$(document).ready(function(){initBrandsCarousel()})
;
var App=function(){var IS_GUEST=false,MAIN_CITY=908,CURRENT_GROUP='women',jivo_site_dialog_open=false,initMapbool=false,nq=new NotificationQueue();citiesWithDeliveryByCityId=[];var handleSessionStorage=function(){if(typeof sessionStorage!=='undefined'){var ss=sessionStorage;if(ss.notificationOptions){new Notification(JSON.parse(ss.notificationOptions)).show();delete ss.notificationOptions}}}
    function sendEventGA(category,action,label){if(!IS_PRODUCTION)return;ga('send',{hitType:'event',eventCategory:category,eventAction:action,eventLabel:label||'',nonInteraction:1})}
    function validateEmail(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)}
    function initSeoTextHide(){if(!$('.seo-text-block').length)return;var $seoTextHideButton=$('.seo-text-block .show-more'),$textContainer=$('.seo-text-block .text-container'),$text=$textContainer.find('.text'),currentHeight=$textContainer.innerHeight();if($text.innerHeight()<=currentHeight){$seoTextHideButton.hide();return};$seoTextHideButton.click(function(){if(!$textContainer.hasClass('open')){$textContainer.addClass('open').css({'max-height':$text.innerHeight()});$seoTextHideButton.html('Свернуть')}else{$textContainer.removeClass('open').css({'max-height':currentHeight});$seoTextHideButton.html('Читать дальше')}})}
    function initScroll(){var position;$('#content .nano-content').on('scroll',function(event){position=$(this).scrollTop();if(position>70){$('header').addClass('scroll');$('.header-cart-wrapper').addClass('scroll');$('#filters').css({'padding-top':110})}else{$('header').removeClass('scroll');$('.header-cart-wrapper').removeClass('scroll');$('#filters').css({'padding-top':''})};position>700?$('.to-top').addClass('fade-in'):$('.to-top').removeClass('fade-in')});$(document).on('scroll',function(){position=$(this).scrollTop()+$(window).height();var openFilterBtn=$('.open-filter-btt'),scrollTopBtn=$('.js-scroll-top-btn');if(position>$('.catalog').height()+250){openFilterBtn.addClass('scroll-top');scrollTopBtn.addClass('js-scroll-top-btn-active')}else{openFilterBtn.removeClass('scroll-top');scrollTopBtn.removeClass('js-scroll-top-btn-active')}});var $elem;$('.js-open-filter-btt').on('click','.js-scroll-top-btn-active',function(){$elem=$('#content .nano-content');if(isMobile.any()||$(window).width()<1025)$elem=$('body');$elem.animate({scrollTop:0},400)});$('#filters').bind("mousewheel",function(e){var e=window.event||e;$('#content .nano-content').scrollTop($('#content .nano-content').scrollTop()-e.wheelDelta/4)});var disableScroll=false;$('.header-desktop-cart').bind("mousewheel",function(e){disableScroll=true});$('header').bind("mousewheel",function(e){$('header .sub-menu-wrapper').addClass('hidden');var e=window.event||e;if(disableScroll){disableScroll=false;return};$('#content .nano-content').scrollTop($('#content .nano-content').scrollTop()-e.wheelDelta/4);$('#product_wrap .nano-content').scrollTop($('#product_wrap .nano-content').scrollTop()-e.wheelDelta/4)});$('header').bind('mouseleave',function(){$('header .sub-menu-wrapper').removeClass('hidden')});$('header .header-menu-item').bind('mouseenter',function(){$('header .sub-menu-wrapper').removeClass('hidden')})}
    function openContactPopup(e){var contactsPopup=$('#contacts_popup'),windowWidth=$(window).width();if(((windowWidth<=1025)&&(windowWidth>=640))||((windowWidth<=1350)&&(windowWidth>=1026))){e.preventDefault();contactsPopup.fadeToggle()}}
    function initCloseContactPopup(){var contactsPopup=$('#contacts_popup'),position,scrollBar=$('#content .nano-content'),windowWidth=$(window).width();contactsPopup.mouseleave(function(){contactsPopup.fadeOut()})
        function closeOnScroll(e){position=scrollBar.scrollTop();if(position<=120)contactsPopup.fadeOut('fast');if(($(this).scrollTop()>0)&&((windowWidth<=1025)&&(windowWidth>=640)))contactsPopup.fadeOut()};scrollBar.on('scroll',closeOnScroll);$(window).on('scroll',closeOnScroll)}
    function removeIOSRubberEffect(element){element.addEventListener("touchstart",function(){var top=element.scrollTop,totalScroll=element.scrollHeight,currentScroll=top+element.offsetHeight;if(top===0){element.scrollTop=1}else if(currentScroll===totalScroll)element.scrollTop=top-1})};$('.mobile-phone-icon').parent().click(function(e){openContactPopup(e)});$('#header-phone-icon').click(function(e){openContactPopup(e)});initCloseContactPopup()
    function eventTrackMenu(){var itemMenu=$('.header-menu-item > a'),itemSubMenu=$('.sub-menu-list > li > a');itemMenu.click(function(event){event.preventDefault();App.sendEventGA('main-menu','click',$(this).attr('data-ga-label'));window.location.href=$(this).attr('href')});itemSubMenu.click(function(event){event.preventDefault();App.sendEventGA('sub-menu',$(this).closest('li.header-menu-item').children('a').attr('data-ga-label'),$(this).attr('data-ga-label'));window.location.href=$(this).attr('href')})};eventTrackMenu()
    function initNanoscroller(){if(!isMobile.any()){$('.nano.with-pane').nanoScroller();$('.nano:not(.with-pane)').nanoScroller({paneClass:'invisible'})}};var initHeaderPhoneChange=function(){var $phones1=$('.header-phone-change-top'),$phones2=$('.header-phone-change-bottom'),initRotate=function($array){var current=$array.find('.show'),next=current.next().length?current.next():$array.find('a:first');next.addClass('show').siblings().removeClass('show')};window.setInterval(function(){initRotate($phones1);initRotate($phones2)},5e3)},initEventHandlers=function(){$('a[data-tooltip], button[data-tooltip]').hover(function(){var $this=$(this),tooltip=$this.data('tooltip'),offset=$this.offset();$('#tooltip').text(tooltip).css('top',offset.top).show()},function(){$('#tooltip').hide()});$('.whenclose').on('click',function(e){if($(e.target).closest('.collapsed-icons').length)return;var filters=Layout.getElement('filters');filters&&filters.hide()});$('#extra > .close').on('click',function(){$('.p-notice').removeClass('choice');$('#left').show();$('header').show();Layout.getElement('extra').hide();$(window).trigger("resize")});$('#extra').on('click',function(){$(window).trigger("resize")});$('.footer-column-title').on('click',function(){if($(window).width()<900){var $this=$(this),$thisBlock=$this.parent().find('.block');if($this.hasClass('minus')){$this.removeClass('minus');$thisBlock.removeClass('open-block').slideUp(500)}else{$('.footer-column-title').removeClass('minus');$this.addClass('minus');$('.footer-column .open-block').removeClass('open-block').slideUp(500);$thisBlock.addClass('open-block').slideDown(500)}}});$(window).resize(function(){if($(window).width()>900)$('.footer-column .block:not(.open-block)').css({display:''});$('.head-block-wrapper').css({'max-height':$(window).height()-parseInt($('.page-indent').css('padding-top'))})});$('.go-reading-btt').click(function(){if($(window).width()>1024){$('#content .nano-content').animate({scrollTop:$('#content .nano-content').scrollTop()+$('#post-body').position().top-50},800)}else $('body').animate({scrollTop:$(document).scrollTop()+$('#post-body').position().top-50},800)})},updateNotify=function(choice){var notificationId=$(event.target).closest('div').data('id');nq.get(notificationId).hide();$.post('/customer/customer/updateProfileFields',{fields:{notify_stock_updated:choice}},function(data){if(!+data)new Notification({message:'Возникла ошибка при редактировании профиля',header:'Добавить в закладки'}).show()})},initSearch=function(){var searchInput=$('#search-form .search-select');if(!searchInput.length)return;if(!searchInput[0].selectize)searchInput.selectize({create:true,dropdownParent:null,highlight:false,valueField:'title',labelField:'title',searchField:'title',openOnFocus:false,onInitialize:function(){$('#search-form .selectize-dropdown-content').css('display','none');var self=this;$.get("/"+CURRENT_GROUP+'/search',{keystroke:'',s:''},function(data){var data=JSON.parse(data);for(var i in data)self.addOption({title:data[i].keyword});self.refreshOptions(false)})},onChange:function(){$('#search-form').submit()},onDropdownOpen:function(){return false},onType:function(str){if(str.length>2){this.open();$('#search-form .selectize-dropdown-content').css('display','block')}else{$('#search-form .selectize-dropdown-content').css('display','none');this.close()}}});$('#search-form').animate({width:'toggle'},300,function(){$(this).find('.selectize-input').click();$('#search-form > div').removeClass('selectize-control')})};$(".mobile-search-icon, .search-icon").click(function(){$('#search-form .selectize-input input').focus()});$("#search_wrap").click(function(){setTimeout(function(){$('#search-form .selectize-input input').focus()},0)});$('body').delegate('.news-block-category .news-block-category-name','click',function(){var line=$(this).data('line'),$wrapper=$(this).parent().parent();if(!$wrapper.find('.news-block-content.active').hasClass(line)){$wrapper.find('.news-block-content').removeClass('active');$wrapper.find('.'+line).addClass('active')}});$('.open-block-name').click(function(){$(this).toggleClass('open').parent().find('.open-block-hidden').slideToggle()});var initHideNotification=function(){$('.notification-wrapper').on('click','.close-notification , .close-notification_ok',function(){var container=$(this).closest('.notification-block'),id=container.data('id'),notification=nq.get(id);if(typeof notification=="undefined"){container.remove()}else notification.hide()})};$('.header-menu .cart-count').bind("DOMSubtreeModified",function(){if($('.header-menu .cart-count').text()!=''){$('.header-menu .cart-icon.second-icon').addClass('count')}else $('.header-menu .cart-icon.second-icon').removeClass('count')});var initHeader=function(){$.ajax({url:"/site/getHeader"}).done(function(data){$(".header-login").html($(data).find(".header-login").html());$(".header-cart").html($(data).find(".header-cart").html());$('#shopingCart').html($(data).find('#shopingCart').html());$('.header-menu .cart-count').html($(data).find('.header-cart .cart-count').html());var search=Layout.getElement('search');$('.mobile-search-icon, .search-icon').on('click',function(event){search.show();$('#search-form .selectize-input input').focus()});$('#close-search').on('click',function(event){search.hide()});$('header').find('.header-cart > a, .gotocart > a').click(function(){App.sendEventGA('cart','menu-cart-go-to-cart')});$('header .cart-submit > a').click(function(){App.sendEventGA('cart','menu-cart-order')})});$('#shopingCart, .header-cart, .cart-icon').hover(function(){showAppearCart()},function(){closeAppearCart()})},disableHide=false,closeTimeout
    function showAppearCart(){clearTimeout(closeTimeout);var cartItems=$('#shopingCart').find('.position').length;if(cartItems===0)return;disableHide=true;if(cartItems>=2&&$(window).height()>700)$('#shopingCart').addClass('double');if(cartItems===1)$('#shopingCart').removeClass('double');$('#shopingCart').show();setTimeout("$('#shopingCart').css({opacity: 1})",10)}
    function closeAppearCart(){clearTimeout(closeTimeout);closeTimeout=setTimeout(function(){disableHide=false;hideAppearCart()},1500)}
    function hideAppearCart(){$('#shopingCart').css({opacity:''});setTimeout(function(){if(disableHide)return;$('#shopingCart').hide()},400)}
    function initMap(){var office={lat:50.426761,lng:30.503361},image=new google.maps.MarkerImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAABCCAYAAAABpNnUAAAJdElEQVR4Xu2da2wUVRTH78xuSzGk2IK6iC1poYKljcWEGAXkEXw12EYhPNTyiQgKJJYKJGAiHwDlbQJGSPwESktDSFoJUUKgCCUxJlJDW8DKNhTRhUBLCfIo2xnzH3LWYTv7nrudxTPJJuzuveee8zvnfx+zXVbJy8vTBV9M4BEh0N7ersQSisICiAUXt3U6ARaA0zPE/kklwAKQipeNO50AC8DpGWL/pBJgAUjFy8adToAF4PQMsX9SCbAApOJl404nwAJweobYP6kEWABS8bJxmQQyMzPFzZs3ExoiKQKAo01NTaKsrEw0NzeLoqIisWfPHrFhwwZRU1OTUAD92Xnu3Lli0aJFYsqUKQE3du/ebcS4cePG/nTtkR47JyfHqJ/c3FzR3d0tKioqDObxXEkXAJyE8zt37hS7du2Kx2fH9GEB9E8q1q1bZwyMCXTlypVi8ODBYsmSJXE5k1QBwMkVK1aI6urqsMVvx9IWF40YO7EAYgRmU3OsAJj5sf1BDubNmyfKy8vjsp5UAcDpQ4cOidWrVwecxXYIiqYAIJCOjo7A1ogChMqxatCWqa6uzlA+2mIlaWxsjAiAZg4aH9sV+AObCxcuNEDSBbFGWlbhG2Yg89gTJkwwBE5boNLSUiNJWK4xFmJA4hD3jh07jOEwzqpVqwL7Wbv7EF+MhxwgfnDGOLjwnGKAX9jWIQ68hmKj3IRiBFu4zNu+4Lw2NDQYW5VLly4ZsYcaw+wXeIXbSqItcgb/0TaeK6kCQLHiwlmADi8AjcSMGzfOEAICQjGgKOmsgGJEseP9yZMnG31Pnz5tLHtoD7vR7Llhr76+3hgfBWm2B5h4Dcsq2kSzryQBoA9dSCwlDrFhuwdb8BFxotiRMIob8Rw/fjwwnqw+Z86cMbjRVoFmUfiLuOl1cIWA8YC44Q9ygysUI3BEfsABBY7LHB+em8+AocaAT5Qf+EXiDFXYEDBECaFGk38rO0kVAAoPsDALzZ8//yFQCAJbHySDZnoEBxAkHAKCIgJEXLQyRAsARYhx0A+FSucQ8ywG29EKINwhGP4jSTSDmpdrKnSwwIUCBANZfWjiMa9qiBn+gzf4oQAhRogShWyenEgANNObGSGniBOx4IF4g+MDb+Qf74cbA6sy2uIBHubdAhUw/AwWGok01lUg6QJAMUPlFByBOnnypFEEmDEx+5hXAAKH2R7vmVcAAIW9kpIS43XYo9nOCgYlGX7QSgRB0OyMQjAnl8RCwM02I50BqIDMKwDNwubiQiFidcKkIKsPihzFjpgRCwoWEwCtisQPWxU6o1Fho7jCMaKtJfpRLoqLiwMrO5h5vd7AXcBQY6Ad/AIPCJW2a8F5xPYXvmM8xIQ+5jtxsYgg6QIw3wZFUvAchU1LMIIjASAQFCbNLubzA4oUswQuvI7+SBJmF0pyKBDoa74FC+AoPNhAcZgFEO6QFUkANGvScg5h0hgkfLRBooP9sbOPeYuJgocg169fb8RM5zLzmYW2NPAXKzIEEI4RbV0RC3Jn3uLRzGwWAPJpNQZteeEfncesVgCaJOgMaD7DhMq5rutCUR589wX/xoXnSRFAOEVGc8cHbXBF+tAD2wckzAoa+UAHuVhmjGh8jBRjNP6bbUQbcyJ9wsVl3mbEMqPG0jbRMaz8typ0KnYr3/pdALEAi9QWswpWFavtCvrSCpHIXYNIPvD7ySdAM3q4Qg/l1SMlgEjosfTiEe+HJpHs8/upR+B/JYDUSw97LJsAC0A2YbbvaAIsAEenh52TTYAFIJsw23c0ARaAo9PDzskmwAKQTZjtO5oAC8DR6WHnZBNgAcgmzPYdTYAF4Oj0sHOyCcQsANkOsX0mYDeB/Pz8Nbquf2ZllwVgN22250gCoUTAAnBkutgpGQSsRMACkEGabTqWQLAIWACOTRU7JouAWQQsAFmU2a6jCZAIWACOThM7J5MAROD1etfEMkZMPygWi2FuywRSgQALIBWyxD5KI8ACkIaWDacCARZAKmSJfZRGgAUgDS0blk3g7IHFQ7S76R6hKB6himGKrmToin5XaOJvoes+NaPH99w7X10P5wcLQHaW2L7tBJprK0cpmhgrhPpUZOPaFV0VLUWzt/1h1ZYFEJkgt3AIgbZvl2b2qO6XharmxuySpnWka/5TBe9vf+gnaFgAMZPkDv1BoPW75QW6yz9RCDUt7vEV3a/4XScK39vURjZYAHHT5I7JImDM/G73zISKP1Dxuj/9/v39tBKwAJKVRR4nbgKt+5aV6rryTNwGgjoqiv5n4Zytxi9wsADsosp2pBB4cOBVp4Uynl0wadTjI1+ckj4ou0BV0wZp2v1bPbc6225c+Lmhs+2E5cEXtnRVO4qDMQtAStrYqF0EWqqXlRm3OYMulztNzZ320ZyBWTn//aRnUJs7XZcaOo5+Xdvr7+nt6492ZezcbXUsALsyxXZsJ9BWu/SJHi39bSvDea9VVgzMGj4R7107d0x0tjUK/71bwj1gkMgumCCGjplqdLvTdflk++Fte6xsuDVxgAVge9rYoF0EztZWFmua+lKwvezRr4z0lJSt0LVe4T3ypbjX9VefIQdkPS3yp38sFNUlfE31GzvP/3QhuJEilFMsALuyxXZsJ9C6t+pVXRV5wYbz36xakJE5bPy188fE1aaDIcd9smSGGDp6qrjb7fvF+8Pmb/oIQNG8LADb08YG7SLQWl1VoStiYLC9MTM/36S60zJ/P7hW+P/pCjmc+7Es8exbnwqtt+fGuf2rVvZpqOi3WQB2ZYvt2E6gpabqAyujhXM278Lrrfuqwo/pShOFs77Aj4j5W2uXL+67BRIaC8D2tLFBuwhEXAG+Xyv8t3kFsIs323EYgZBngDc+WZAx2DMed3+u/hbmDPD8DONuEJ8BHJZYdic6AiHvAhVMGuV5oXw5rHgPbxV3uy73MZiRNVzkv7bMeN33a90mqw/F+C5QdHngVv1EIOznANOXzhs4ZITxIVjYzwGuX2xoP7K92ioE/hygnxLLw0ZPoKWmstzq7/5d7nRX7rQPZ/MnwdGz5JYpSID/FigFk8Yu20ugeV/V64ouRthlVVfExaI5W36EPb4NahdVtiONgPF9gLS0WUJX3AkPovD3ARJmyAaST8D4Rpi7d1JCIuBvhCU/cTyifQT4O8H2sWRLKUyA/1eIFE4eu24fgfN7q4b2qopHKL0eXSge+n+BFKH7hO7yuTTdN/rdLdfCjfgvlE9WOihBDrwAAAAASUVORK5CYII=',new google.maps.Size(192,66),new google.maps.Point(0,0),new google.maps.Point(192,66)),map=new google.maps.Map(document.getElementById('map'),{zoom:15,center:office}),marker=new google.maps.Marker({position:office,map:map,icon:image})}
    function openMap(){$('#after-delivery-desc-map').click(function(){console.log('click');if(!initMapbool)initMap();initMapbool=true;$('.map-popup-container').show()});$('.map-popup .close-notification').click(function(){$('.map-popup-container').hide()})};var getCitiesWithDeliveryByCityIds=function(){return $.ajax({url:"/order/GetCitiesWithDeliveryByCityId"}).done(function(data){App.citiesWithDeliveryByCityId=data})};return{init:function(){EJS.config({cache:false});$.ajaxSetup({cache:true});handleSessionStorage();initScroll();initNanoscroller();initEventHandlers();initHeader();initHideNotification();initSearch();initSeoTextHide();removeIOSRubberEffect(document.querySelector('.js-menu-content'));openMap()},getNotificationQueue:function(){return nq},isGuest:function(){return IS_GUEST},getMainCity:function(){return MAIN_CITY},getCurrentGroup:function(){return CURRENT_GROUP},initLeftMenuClick:function(){initLeftMenu()},initAppScroll:function(){initScroll()},showAppearCart:function(){showAppearCart()},closeAppearCart:function(){closeAppearCart()},initEventHandlers:function(){initEventHandlers()},initNanoscroller:function(){initNanoscroller()},getCitiesWithDeliveryByCityIds:function(){return getCitiesWithDeliveryByCityIds()},jivo_site_dialog_open:jivo_site_dialog_open,sendEventGA:sendEventGA,validateEmail:validateEmail}}(),hbuttonsClickHandler=function(target){if(!target)return;var right=Layout.getElement('right'),login=Layout.getElement('login');login.hide();if(this.hasClass('grey')){if(this.attr('id')==='hmenu'&&target.attr('id')!=='rmenu'){target.removeClass('hide');right.show()}else{target.addClass('hide');this.removeClass('grey');right.hide()}}else{$('.hbuttons').removeClass('grey');this.addClass('grey');target.removeClass('hide');if(target.attr('id')!=='rmenu'){right.show()}else right.hide()}},hbuttonsLoginHandler=function(target){if(!target)return;var right=Layout.getElement('right'),login=Layout.getElement('login');right.hide();if(this.hasClass('grey')){if(this.attr('id')==='hmenu'&&target.attr('id')!=='rmenu'){target.removeClass('hide');login.show();$('#recover').addClass('hide');$('#register').addClass('hide')}else{this.removeClass('grey');login.hide()}}else{$('.hbuttons').removeClass('grey');this.addClass('grey');target.removeClass('hide');if(target.attr('id')!=='rmenu'){login.show();$('#recover').addClass('hide');$('#register').addClass('hide')}else login.hide()}},ultraTabs={showBlock:function(linkElement){var linkElement=$(linkElement);linkElement.click(function(e){e.preventDefault();var idEl=$(this).attr('href');$(this).siblings().removeClass('active');$(this).addClass('active');$(idEl).siblings().hide();$(idEl).show()});linkElement.each(function(){var $this=$(this);if($this.hasClass('active')){var contentBlock=$this.attr('href');$(contentBlock).show()}})}},initTimer=(function(){var timerBlock=document.querySelector('.js-levis-timer')||0;if(timerBlock===0)return;var finalDate='May 20, 2018 00:00:00',countDownDate=new Date(finalDate).getTime(),timeInterval=setInterval(function(){var now=new Date().getTime(),distance=countDownDate-now,days=Math.floor(distance/(1e3*60*60*24)),hours=Math.floor((distance%(1e3*60*60*24))/(1e3*60*60)),minutes=Math.floor((distance%(1e3*60*60))/(1e3*60)),seconds=Math.floor((distance%(1e3*60))/1e3);timerBlock.innerHTML='<div class="levis-timer__items"><span class="levis-timer__date">'+days+'</span><span class="levis-timer__text">дней</span></div><div class="levis-timer__items"><span class="levis-timer__date">'+hours+'</span><span class="levis-timer__text">часов</span></div><div class="levis-timer__items"><span class="levis-timer__date">'+minutes+'</span><span class="levis-timer__text">минут</span></div><div class="levis-timer__items"><span class="levis-timer__date">'+seconds+'</span><span class="levis-timer__text">секунд</span></div>';timerBlock.classList.add('active');if(distance<0){clearInterval(timeInterval);timerBlock.style.display='none'}},1e3)})
;
var PopupClass=function(props){if(!(this instanceof PopupClass))return new PopupClass(props);var that=this;if(!props||!props.url)throw Error('The instance of PopupClass must include url string property');this.domElems=this.getDomElems();this.id=props.id||'popup_'+this.setRandomId();this.url=props.url;this.hidemobile=props.hidemobile||null;this.template='<div class="popup'+(this.hidemobile?' desktop':'')+'" id ="'+this.id+'">{{data}}</div>';var init=function(){if(that.hidemobile&&that.domElems.$windowElem.width()<1025)return false;return $.when(that.getDataAjaxRender()).then(function(){that.show('popup');return that})};return{init:init}};PopupClass.prototype.CurrentShown={};PopupClass.prototype.show=function(current){this.setCurrentElems();if(this.CurrentShown[current]){this.CurrentShown[current].remove();this.domElems.$currentElem.show()}else this.domElems.$currentElem.fadeIn(200);this.CurrentShown[current]=this.domElems.$currentElem;this.setCloseClickHandlers(current)};PopupClass.prototype.getDataAjaxRender=function(){var that=this;return $.ajax({method:'GET',url:this.url}).done(function(data){that.domElems.$bodyElem.append(that.renderTemplate({data:data}))})};PopupClass.prototype.setCurrentElems=function(){this.domElems.$currentElem=$('#'+this.id);this.domElems.$currentClose=this.domElems.$currentElem.find('.close')};PopupClass.prototype.setCloseClickHandlers=function(current){var that=this;this.domElems.$currentClose.click(function(){that.close(current);that.domElems.$currentElem.trigger('mask-close-click')});this.domElems.$currentElem.click(function(e){if($(e.target).hasClass('mask'))that.domElems.$currentClose.trigger('click')})};PopupClass.prototype.close=function(current){var that=this;this.domElems.$currentElem.fadeOut(200);window.setTimeout(function(){that.domElems.$currentElem.remove()},200);this.domElems.$currentElem.trigger('close');this.CurrentShown[current]=null};PopupClass.prototype.renderTemplate=function(data){return this.template.replace(/\{\{(.*?)\}\}/g,function(i,match){return data[match]})};PopupClass.prototype.setRandomId=function(){return Math.random().toString(36).slice(2)};PopupClass.prototype.getDomElems=function(){return{$windowElem:$(window),$bodyElem:$('body'),$currentElem:null}};var ProductSmallNotificationClass=function(props){if(!(this instanceof ProductSmallNotificationClass))return new ProductSmallNotificationClass(props);var that=this;if(!props||!props.topText||!props.bottomText)throw new Error('The instance of ProductSmallNotificationClass must include {top-text, bottom-text} string properties');this.domElems=this.getDomElems();this.id=props.id||'small_notification_'+this.setRandomId();this.topText=props.topText;this.bottomText=props.bottomText;this.template='<div class="notificationTooltip" id ="'+this.id+'"><div class="close"></div><div class="head-text">{{topText}}</div><div class="text">{{bottomText}}</div></div>';var init=function(){if(that.domElems.$windowElem.width()<=1024)return false;that.domElems.$bodyElem.append(that.renderTemplate({topText:that.topText,bottomText:that.bottomText}));that.show('smallProductNotification');return that};return{init:init}};ProductSmallNotificationClass.prototype=Object.create(PopupClass.prototype);var ProductAfterOneClickNotification=function(props){if(!(this instanceof PopupClass))return new PopupClass(props);var that=this;if(!props||!props.headTextTop||!props.bottomPart)throw new Error('The instance of ProductSmallNotificationClass must include {top-text, bottom-part} string properties');this.domElems=this.getDomElems();this.id='after_oneClickNotification'+this.setRandomId();this.addingClass=props.addingClass||'';this.headTextTop=props.headTextTop;this.headTextBottom=props.headTextBottom||'';this.bottomPart=props.bottomPart;this.template='<div class="afterOneClick '+this.addingClass+'" id ="'+this.id+'"><div class="mask"><div class="main-container"><div class="close"></div><div class="head-text"><div class="vertical-wrap"><div class="container"><span class="top">{{headTextTop}}</span><span class="bottom">{{headTextBottom}}</span></div></div></div><div class="bottom"><div class="vertical-wrap"><div class="container">{{bottomPart}}</div></div></div></div></div></div>';var init=function(){that.domElems.$bodyElem.append(that.renderTemplate({headTextTop:that.headTextTop,headTextBottom:that.headTextBottom,bottomPart:that.bottomPart}));that.show('afterOneClickNotification');return that};return{init:init}};ProductAfterOneClickNotification.prototype=Object.create(PopupClass.prototype);var ProductFirstBuyPopup=function(props){var that=this;if(!props||!props.html)throw new Error('The instance of ProductFirstBuyPopup must include {html} string properties');this.domElems=this.getDomElems();this.id='firstBuyPopup'+this.setRandomId();this.html=props.html;this.template='<div class="firstBuyPopup" id ="'+this.id+'"><div class="mask"><div class="container-popup"><div class="close"></div> <div class="ajax-container">{{html}}</div></div></div></div></div>';var init=function(){that.domElems.$bodyElem.append(that.renderTemplate({html:that.html}));that.show('firstBuyPopup');return that};return{init:init}};ProductFirstBuyPopup.prototype=Object.create(PopupClass.prototype);ProductFirstBuyPopup.prototype.setHeightWidth=function(){var that=this,setHeightWidth=function(){that.domElems.$currentContainer.height(that.domElems.$currentAjaxContainer.height());that.domElems.$currentContainer.width(that.domElems.$currentAjaxContainer.width())};setHeightWidth();this.domElems.$currentAjaxContainer.bind('DOMSubtreeModified',function(){setHeightWidth()});this.domElems.$windowElem.resize(function(){setHeightWidth()})};ProductFirstBuyPopup.prototype.show=function(current){this.setCurrentElems();this.setHeightWidth();if(this.CurrentShown[current]){this.CurrentShown[current].remove();this.domElems.$currentElem.show()}else this.domElems.$currentElem.fadeIn(200);this.CurrentShown[current]=this.domElems.$currentElem;this.setCloseClickHandlers(current)};ProductFirstBuyPopup.prototype.setCurrentElems=function(){this.domElems.$currentElem=$('#'+this.id);this.domElems.$currentClose=this.domElems.$currentElem.find('.close');this.domElems.$currentAjaxContainer=this.domElems.$currentElem.find('.ajax-container');this.domElems.$currentContainer=this.domElems.$currentElem.find('.container-popup')}
;
var PopupShow=function(){return{first:function(){return new PopupClass({url:'/subscribe/getPopup?popup=popup_1'}).init()},second_1:function(){return new PopupClass({url:'/subscribe/getPopup?popup=popup_2_1'}).init()},second_2:function(){return new PopupClass({url:'/subscribe/getPopup?popup=popup_2_2'}).init()},third:function(){return new PopupClass({url:'/subscribe/getPopup?popup=popup_3',hidemobile:true}).init()}}}(),Subscribe=function(){var ThreeMinutesTimer=false,Popup1Timer=null,Popup2Timer=null
    function getCookie(name){var matches=document.cookie.match(new RegExp("(?:^|; )"+name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,'\\$1')+"=([^;]*)"));return matches?decodeURIComponent(matches[1]):undefined}
    function setCookie(name,expiryDays){expiryDays=new Date(new Date().getTime()+3600*expiryDays*24*1e3);document.cookie=name+"=true; path=/; expires="+expiryDays.toUTCString()}
    function isEmail(email){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return regex.test(email)};var checkPopupHidden=function(){return $('#hide-popups').val()=='1'||checkDeniedPages()},checkDeniedPages=function(){return($('.cart-main-page').length||$('.signin-checkout').length||$('.checkout-page').length||$('.left-menu.sidebarShow').length||$('.right-filter.mobile.show-filter').length||$('#gender-popup').length||$('#register-standalone').length||$('#thank-you-esputnik').length||$('.vimeo-play-button-container.show').length||$('.afterOneClick').length||$('.oneClick-popup:visible').length||$('.firstBuyPopup').length||$('.levisday-video__container.active').length||$('.levis-video-banner__popup').length||$('.friday-page').length||App.jivo_site_dialog_open)},addFormHandler=function(popup){var $popup=popup.domElems.$currentElem,$form=$popup.find('form'),$subscribeContainer=$popup.find('.subscribe-popup');$form.submit(function(e){e.preventDefault();var email=$('.subscribe-popup-email').val(),source=$('.subscribe-popup-source').val(),$errorField=$popup.find(".error-field");if(email==""){$subscribeContainer.addClass('error');$errorField.html("Введите свой e-mail");window.setTimeout(function(){$subscribeContainer.removeClass('error')},2e3)}else if(isEmail(email)==false){$subscribeContainer.addClass('error');$errorField.html("Вы ввели некорректный e-mail");window.setTimeout(function(){$subscribeContainer.removeClass('error')},2e3)}else $.post('/popupSubscribe',{email:email,source:source},function(data){if(!data.error){$popup.trigger('successSubscribe',email);$popup.remove();new Notification({id:"subscribe-success",message:'На адрес '+email+' отправлено письмо со ссылкой для подтверждения вашей подписки.',header:"Спасибо!",type:Notification.SUCCESS}).show()}else{if(data.isEmailAlreadyTaken)setCookie('Subscribe',365);$subscribeContainer.addClass('error');$errorField.html(data.message);window.setTimeout(function(){$popup.removeClass('error')},2e3)}},'json')})},initPopup1=function(){if(!getCookie('S1')&&!getCookie('Subscribe')&&!checkPopupHidden())Popup1Timer=window.setTimeout(function(){if(!checkPopupHidden())$.when(PopupShow.first()).then(function(popup1){addFormHandler(popup1);popup1.domElems.$currentElem.on('successSubscribe',function(){setCookie('Subscribe',365)});popup1.domElems.$currentElem.on('close',function(){setCookie('S1',365);setCookie('T1',1)});popup1.domElems.$currentElem.on('successSubscribe',function(e,mail){App.sendEventGA('pop-up-subscribe','pop-up-subscribe-1-submit')});App.sendEventGA('pop-up-subscribe','pop-up-subscribe-1-shown');popup1.domElems.$currentElem.on('mask-close-click',function(){App.sendEventGA('pop-up-subscribe','pop-up-subscribe-1-closed')})})},1e5)},initPopup2=function(){if(!getCookie('T1')&&getCookie('S1')&&!getCookie('Subscribe')&&!getCookie('T2')&&!checkPopupHidden())Popup2Timer=window.setTimeout(function(){if(!checkPopupHidden())$.when(PopupShow.second_1()).then(function(popup2_1){setCookie('T2',3);popup2_1.domElems.$currentElem.find('.no-button').on('click',function(){popup2_1.close();App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.1-rejected')});App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.1-shown');popup2_1.domElems.$currentElem.on('mask-close-click',function(){App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.1-closed')});popup2_1.domElems.$currentElem.find('.yes-button').on('click',function(){setCookie('S2_2',365);App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.1-confirmed');$.when(PopupShow.second_2()).then(function(popup2_2){addFormHandler(popup2_2);popup2_2.domElems.$currentElem.on('successSubscribe',function(e,mail){setCookie('Subscribe',365);App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.2-submit')});App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.2-shown');popup2_2.domElems.$currentElem.on('mask-close-click',function(){App.sendEventGA('pop-up-subscribe','pop-up-subscribe-2.2-closed')})})})})},8e4)},initPopup3=function(){runThreeMinutesTimer();var shown=false;document.addEventListener("mouseout",function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(((!from||from.nodeName=="HTML")&&e.screenY<120&&!shown)&&((getCookie('S1')&&getCookie('T1')&&ThreeMinutesTimer&&!getCookie('S3'))||(getCookie('S2_2')&&!getCookie('Subscribe')&&getCookie('T2')&&!getCookie('S3'))))$.when(PopupShow.third()).then(function(popup3){if(!popup3)return;shown=true;addFormHandler(popup3);setCookie('S3',365);popup3.domElems.$currentElem.on('successSubscribe',function(e,mail){setCookie('Subscribe',365);App.sendEventGA('pop-up-subscribe','pop-up-subscribe-3-submit')});App.sendEventGA('pop-up-subscribe','pop-up-subscribe-3-shown');popup3.domElems.$currentElem.on('mask-close-click',function(){App.sendEventGA('pop-up-subscribe','pop-up-subscribe-3-closed')})})})},runThreeMinutesTimer=function(){window.setTimeout(function(){ThreeMinutesTimer=true},18e4)},initSubscribeForm=function(subscribe){var checkboxNumber=0;$('.subscribe-block-gender-choose').each(function(){checkboxNumber++;$(this).find('input').attr('id','cb_sub'+checkboxNumber);$(this).find('label').attr('for','cb_sub'+checkboxNumber)});$('.subscribe-block-gender-choose').find('input').click(function(){var menBtn=$('#cb_sub1:checked').length,womenBtn=$('#cb_sub2:checked').length;if(menBtn&&!womenBtn){$('.section-block-wrapper').addClass('men-bg')}else $('.section-block-wrapper').removeClass('men-bg')});$('.subscribe-block-form').submit(function(e){e.preventDefault();clearTimeout(Popup1Timer);clearTimeout(Popup2Timer);var action=$(this).attr('action'),email=$(this).find('.subscription_email').val(),landing=$(this).find('#LandingSubscription_landing').val(),gender=0;if($(this).find('.cb_sub2').attr("checked"))gender+=2;if($(this).find('.cb_sub1').attr("checked"))gender+=1;var utmSource=null,utmMedium=null,utmCampaign=null,uri=window.location.href.split('?')[1];if(uri){var params=uri.split('&');for(var i=0;i<params.length;i++){var paramParts=params[i].split('=');switch(paramParts[0]){case'utm_source':utmSource=paramParts[1];break;case'utm_medium':utmMedium=paramParts[1];break;case'utm_campaign':utmCampaign=paramParts[1];break}}};if(email=="")new Notification({id:"subscribe-error",message:'введите свой e-mail',header:"Пожалуйста,",type:Notification.ERROR}).show();if(isEmail(email)==false)new Notification({id:"subscribe-error",message:'Вы ввели некорректный e-mail',header:"Ошибка",type:Notification.ERROR}).show();if(gender==0)new Notification({id:"subscribe-error",message:'укажите Ваш пол',header:"Пожалуйста,",type:Notification.ERROR}).show();$.post(action,{'subscription[landing]':landing,'subscription[email]':email,'subscription[gender]':gender,'subscription[utm_source]':utmSource,'subscription[utm_medium]':utmMedium,'subscription[utm_campaign]':utmCampaign},function(data){if(data.error){if(data.isEmailAlreadyTaken)setCookie('Subscribe',365);new Notification({id:"subscribe-error",message:data.message,header:"Спасибо!",type:Notification.ERROR}).show()}else if(data.success){var message='';if(data.hasOwnProperty('successMessage')){message=data.successMessage}else message='На адрес '+email+' отправлено письмо со ссылкой для подтверждения вашей подписки.';new Notification({id:"subscribe-success",message:message,header:"Спасибо!",type:Notification.SUCCESS}).show();setCookie('Subscribe',365);if(IS_PRODUCTION)if(subscribe==='subscribe'){ga('send','event','Email-subscribe','subscribe')}else if(subscribe==='subscribe1')ga('send','event','Email-subscribe','subscribe');$('.subscription-banner[data-landing="'+data.landing+'"]').show();$('.subscribe_wrap[data-landing="'+data.landing+'"]').hide()}})})};return{init:function(subscribe){initSubscribeForm(subscribe)},initPopups:function(){initPopup1();initPopup2();initPopup3()}}}();Subscribe.initPopups()
;
var USGA=USGA||{};USGA.isProduction=IS_PRODUCTION;USGA.namespace=function(ns_string){var parts=ns_string.split('.'),parent=USGA,i;if(parts[0]==='USGA')parts=parts.slice(1);for(i=0;i<parts.length;i+=1){if(typeof parent[parts[i]]==='undefined')parent[parts[i]]={};parent=parent[parts[i]]};return parent};USGA.namespace('actions.isPage');USGA.actions.isPage=function(){var isProductCart=$('#product').length&&!$('.not-available').length&&USGA.isProduction,isCatalog=$('.catalog').length&&USGA.isProduction,isCart=$('.cart-main-table').length&&USGA.isProduction,isSignInCheckout=$('.signin-checkout').length&&USGA.isProduction,isCheckout=$('.checkout-page').length&&USGA.isProduction,isMenuCart=$('.cart__main').length&&USGA.isProduction;return{product:isProductCart,cart:isCart,signInCheckout:isSignInCheckout,checkout:isCheckout,catalog:isCatalog,menuCart:isMenuCart}};USGA.namespace('actions.triggerPageView');USGA.actions.triggerPageView=function(){if(window.dataLayer){var pageViewPathname=ga('send','pageview',window.location.pathname);return{send:pageViewPathname}}};USGA.namespace('actions.productClick');USGA.actions.productClick=function(){var productClick=function(url,index){var isCatalog=USGA.actions.isPage().catalog;if(!isCatalog)return;$.ajax({url:url,dataType:"html",async:true,success:function(data){var productInfo={id:($('.prod-code',data).html()||'').trim(),name:($('.prod-desc',data).html()||'').trim(),category:($('.prod-category',data).html()||'').trim(),brand:($('.productBrand a span',data).html()||'').trim(),price:($('.product-price span',data).html()||'').trim(),position:index};ga('ec:addProduct',productInfo);ga('ec:setAction','click',{list:'Catalog Results'});ga('send','event','Ecommerce','Product Click Сatalog',{nonInteraction:1})}})};return{send:function(url,index){productClick(url,index)}}};USGA.namespace('actions.productView');USGA.actions.productView=function(){var isProductCart=USGA.actions.isPage().product,product={id:($('.prod-code').html()||'').trim(),name:($('.prod-desc').html()||'').trim(),category:($('.prod-category').html()||'').trim(),brand:($('.productBrand a').find('span').html()||'').trim(),price:($('.product-price').find('span').html()||'').trim(),size:($('#chozeSize').find('option:selected').html()||'').trim()},productView=function(){if(!isProductCart)return;var productInfo={id:product.id,name:product.name,category:product.category,brand:product.brand,price:product.price,quantity:1};ga('ec:setAction','checkout',{step:1});ga('send','event','Ecommerce','Step 1 Product View',{nonInteraction:1});ga('ec:addProduct',productInfo);ga('ec:setAction','detail');ga('send','event','Ecommerce','Product View',{nonInteraction:1})};return{send:productView,getProductInfo:product}};USGA.namespace('actions.catalogView');USGA.actions.catalogView=function(){var isCart=USGA.actions.isPage().cart,isProduct=USGA.actions.isPage().product,isCatalog=USGA.actions.isPage().catalog,catalogView=function(){if(isProduct||isCart||!isCatalog)return;var catalogProducts=[];$("#catalog-items .item").each(function(i){catalogProducts[i]={id:($(this).find('.item-code').html()||'').trim(),name:($(this).find('.item-info').html()||'').trim(),category:($(this).find('.item-category').html()||'').trim(),brand:($(this).find('.designer-info').html()||'').trim(),price:($(this).find('.item-price span').html()||'').trim(),position:i+1,list:'Catalog Results'};ga('ec:addImpression',catalogProducts[i]);ga('ec:setAction','detail')});ga('send','event','Ecommerce','Catalog View',{nonInteraction:1})};return{send:catalogView}};USGA.namespace('actions.addToCart');USGA.actions.addToCart=function(){var isProductCart=USGA.actions.isPage().product,product=USGA.actions.productView().getProductInfo,addToCart=function(){if(!isProductCart)return;var productInfo={id:product.id,name:product.name,category:product.category,brand:product.brand,price:product.price,dimension1:product.size,quantity:1};ga('ec:addProduct',productInfo);ga('ec:setAction','add');ga('send','event','Ecommerce','Add To Cart',{nonInteraction:1})};return{send:addToCart}};USGA.namespace('actions.cartView');USGA.actions.cartView=function(){var isCart=USGA.actions.isPage().cart,cartView=function(){if(!isCart)return;var cartProducts=[];$(".cart-main-table .product_row").each(function(i){cartProducts[i]={id:($(this).find('.cart-prod-code').html()||'').trim(),name:($(this).find('.cart-prod-name').html()||'').trim(),category:($(this).find('.cart-prod-category').html()||'').trim(),brand:($(this).find('.cart-prod-designer').find('a').html()||'').trim(),list:'Cart Results',price:($(this).find('.cart-prod-price').html()||'').trim(),dimension1:($(this).find('.cart-prod-size').html()||'').trim(),quantity:1,position:i+1};ga("ec:addProduct",cartProducts[i]);ga('ec:setAction','detail')});ga('send','event','Ecommerce','Cart View',{nonInteraction:1})};return{send:cartView}};USGA.namespace('actions.removeFromCart');USGA.actions.removeFromCart=function(){var isCart=USGA.actions.isPage().cart,isMenuCart=USGA.actions.isPage().menuCart,removeFromCart=function(deleteProduct){if(!isMenuCart&&!isCart)return;var removeProduct,$productContainer;if(isCart){$productContainer=deleteProduct.closest('.product_row');removeProduct={id:($productContainer.find('.cart-prod-code').html()||'').trim(),name:($productContainer.find('.cart-prod-short-description').html()||'').trim(),category:($productContainer.find('.cart-prod-category').html()||'').trim(),brand:($productContainer.find('.cart-prod-designer').find('a').html()||'').trim(),price:($productContainer.find('.cart-prod-price').html()||'').trim(),dimension1:($productContainer.find('.cart-prod-size').html()||'').trim(),quantity:1}}else if(isMenuCart){$productContainer=deleteProduct.closest('.position');removeProduct={id:($productContainer.data('code')||'').trim(),name:($productContainer.find('.cart-prod-short-description').html()||'').trim(),category:($productContainer.data('category')||'').trim(),brand:($productContainer.find('.cart-prod-designer').find('a').html()||'').trim(),price:$productContainer.data('sum-price')||'',dimension1:($productContainer.find('.cart-prod-size span').html()||'').trim(),quantity:1}};ga('ec:addProduct',removeProduct);ga('ec:setAction','remove');ga('send','event','Ecommerce','Remove From Cart',{nonInteraction:1})};return{send:function(deleteProduct){removeFromCart(deleteProduct)}}};USGA.namespace('actions.steps');USGA.actions.steps=function(){var isCart=USGA.actions.isPage().cart,isSignInCheckout=USGA.actions.isPage().signInCheckout,isCheckout=USGA.actions.isPage().checkout,sendStep=function(){if(isCart){ga('ec:setAction','checkout',{step:2});ga('send','event','Ecommerce','Step 2 Cart View',{nonInteraction:1})};if(isSignInCheckout){ga('ec:setAction','checkout',{step:3});ga('send','event','Ecommerce','Step 3 SignIn Checkout View',{nonInteraction:1})};if(isCheckout){ga('ec:setAction','checkout',{step:4});ga('send','event','Ecommerce','Step 4 Checkout View',{nonInteraction:1})}};return{send:sendStep}}
;
(function(){function storageAvailable(type){try{var storage=window[type],x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true}catch(e){return false}};if(storageAvailable('localStorage')){var isGenderParam=window.location.search.match(/genderLink/gi),genderStorage=localStorage.getItem('genderlink'),urlMatchMen=window.location.pathname.match(/\/men/gi),urlMatchWomen=window.location.pathname.match(/\/women/gi),genderUrl=urlMatchWomen||urlMatchMen,pageUrl=window.location.href,redirectUrl;function setGenderStorage(){if(urlMatchMen){localStorage.setItem("genderlink","/men")}else if(urlMatchWomen)localStorage.setItem("genderlink","/women")};function testLink(link){var xhr=new XMLHttpRequest(),testParam='prodCount';xhr.open('GET',link+'&'+testParam,false);xhr.send();var response=JSON.parse(xhr.responseText);if(response.prodCount==true&&xhr.status!=404)window.location.href=link};function redirectLink(){redirectUrl=pageUrl.replace(genderUrl,genderStorage);testLink(redirectUrl)};if(isGenderParam&&genderUrl){if(genderStorage&&(genderStorage!=genderUrl)){redirectLink()}else if(genderStorage&&(genderStorage==genderUrl)){return}else setTimeout(function(){var dataPopup={title:"укажите свой пол",description:"и мы сделаем <br> ваш шоппинг комфортнее",leftButtonName:"мужчина",rightButtonName:"женщина"},genderPopupContent=new EJS({url:'/themes/ultrashop/templates/_gender_popup.ejs'}).render(dataPopup);$('.overlayWithSidebar').addClass('genderMask');$('body').append(genderPopupContent)
    function closeGenderPopup(){$('.overlayWithSidebar').removeClass('genderMask');$('.gender-popup-wrapper').remove();setGenderStorage()}
    function checkGenderParams(param){param='/'+param;if(param==urlMatchMen){closeGenderPopup()}else if(param==urlMatchWomen){closeGenderPopup()}else{closeGenderPopup();localStorage.setItem("genderlink",param);genderStorage=localStorage.getItem('genderlink');redirectLink()}};$('.gender-popup-link.women-link').click(function(e){e.preventDefault();var dataGender=$(this).data('gender');checkGenderParams(dataGender)});$('.gender-popup-link.men-link').click(function(e){e.preventDefault();var dataGender=$(this).data('gender');checkGenderParams(dataGender)});$('.gender-popup-close').click(function(){closeGenderPopup()});$('.overlayWithSidebar.genderMask').click(function(){closeGenderPopup()})},2e3)}else setGenderStorage()}})()
;
var jivo_onOpen=function(){App.jivo_site_dialog_open=true},jivo_onClose=function(){App.jivo_site_dialog_open=false;window.sessionStorage.setItem('jivoSiteClosed',true)},jivo_onLoadCallback=function(){window.setTimeout(function(){App.jivoSiteOpen()},45e3)};(function(){var widget_id='SNh241MTFo',d=document,w=window
    function l(){var s=document.createElement('script');s.type='text/javascript';s.async=true;s.src='//code.jivosite.com/script/widget/'+widget_id;var ss=document.getElementsByTagName('script')[0];ss.parentNode.insertBefore(s,ss)};if(d.readyState=='complete'){l()}else if(w.attachEvent){w.attachEvent('onload',l)}else w.addEventListener('load',l,false)})();App.jivoSiteOpen=function(){var checkDeniedPages=$('.cart-main-page').length||$('.checkout-page').length||$('#register-standalone').length||$('#login-standalone').length||$('.subscribe-popup').length||$('#recover-standalone').length||$('.oneClick-popup:visible').length||$('.vimeo-play-button-container.show').length||$('#gender-popup').length||$('.left-menu.sidebarShow').length||$('.right-filter.mobile.show-filter').length||$('.firstBuyPopup').length;if((jivo_api.chatMode()!=='online')||checkDeniedPages||window.sessionStorage.getItem('jivoSiteClosed'))return false}
;
var Feedback=function(){var initForm=function(){var feedbackForm=Form.create($('#feedback-form'),{isAjax:true,submitCallback:function(){new Notification({id:'feedback-success',type:Notification.NOTICE,message:'Ваш запрос принят на рассмотрение',header:'Спасибо'}).show();var feedbackForm=$('#feedback-form'),feedbackEmail=feedbackForm.find('#Feedback_email').val(),feedbackName=feedbackForm.find('#Feedback_fullname').val()}});if(!isMobile.any())selectizeInit()
    function selectizeInit(){feedbackForm.getElement().find('select.decorator').selectize({onInitialize:function(){this.getValue()&&this.$control_input.css('width',0);this.$control_input.attr('disabled',true)},onChange:function(value){this.$control_input.css('width',0)}})}},initFooterForm=function(){var feedbackFooterForm=Form.create($('#footer-feedback-form'),{isAjax:true,submitCallback:function(){new Notification({id:'feedback-success',type:Notification.NOTICE,message:'Ваш запрос принят на рассмотрение',header:'Спасибо'}).show();$('.contact_us_block2').hide()}});feedbackFooterForm.getElement().find('select.decorator').selectize({onInitialize:function(){this.getValue()&&this.$control_input.css('width',0);this.$control_input.attr('disabled',true)},onChange:function(value){this.$control_input.css('width',0)}})},initBackcall=function(){var $backcall=$('#backcall-form'),$backcallPhone=$('#backcall-phone'),$backcallName=$('#backcall-name');$backcallPhone.inputmask('+38(999)999 99 99',{showMaskOnHover:false});$backcall.submit(function(event){event.preventDefault();var $this=$(this);$.post($this.attr('action'),{name:$backcallName.val(),phone:$backcallPhone.val(),startTime:$('#backcall-start-time').val(),endTime:$('#backcall-end-time').val()},function(data){if(data.error){new Notification({id:'backcall-error',type:Notification.ERROR,message:data.message,header:'Заказ обратного звонка'}).show()}else if(data.success){new Notification({id:'buyOneClick-success',type:Notification.NOTICE,message:data.message,header:'Заказ обратного звонка'}).show();IS_PRODUCTION&&ga('send','event','callback','click')}})});$('.time-toggle').click(function(){$(this).addClass('disable-hover').parent().find('.hidden-time-rows').slideDown(500)});$('.time-toggle-hide').click(function(){$('.time-toggle').removeClass('disable-hover');$(this).parent().slideUp(500);setTimeout(function(){$('#backcall-start-time').val('');$('#backcall-end-time').val('')},500)});$('#backcall-start-time').change(function(){var $this=$(this),val=$this.val(),endVal=$('#backcall-end-time').val();if(endVal.length&&val>=endVal)$('#backcall-end-time').find('option[value="'+val+'"]').next().prop({selected:true})});$('#backcall-end-time').change(function(){var $this=$(this),val=$this.val(),startVal=$('#backcall-start-time').val();if(startVal.length&&val<=startVal)$('#backcall-start-time').find('option[value="'+val+'"]').prev().prop({selected:true})})};return{init:function(){initForm()},initFooter:function(){initFooterForm()},initBackcall:function(){initBackcall()}}}()
;
